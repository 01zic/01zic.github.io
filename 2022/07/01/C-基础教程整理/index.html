<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/orange.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/orange.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/orange.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"01zic.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"flat"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="C语言提高">
<meta property="og:type" content="article">
<meta property="og:title" content="C++基础教程整理">
<meta property="og:url" content="https://01zic.github.io/2022/07/01/C-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%E6%95%B4%E7%90%86/index.html">
<meta property="og:site_name" content="orangeWBlog">
<meta property="og:description" content="C语言提高">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wps39B3.tmp.jpg">
<meta property="og:image" content="http://qiniu.orangew.cn/img/20220702085501.png">
<meta property="og:image" content="http://qiniu.orangew.cn/img/20220702090155.png">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wpsE914.tmp.jpg">
<meta property="og:image" content="file:///C:/Users/10559/AppData/Local/Temp/ksohtml/wps9FF2.tmp.jpg">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wpsFE.tmp.jpg">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wps2BC3.tmp.png">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wpsCC98.tmp.png">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wps996F.tmp.png">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wps6422.tmp.png">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wpsBE4A.tmp.png">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wps2E6A.tmp.jpg">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wpsC94E.tmp.png">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wpsA271.tmp.jpg">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wps8B37.tmp.jpg">
<meta property="og:image" content="http://qiniu.orangew.cn/img/20220702201301.png">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wpsCBF1.tmp.jpg">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wps3AB2.tmp.jpg">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wps62C.tmp.jpg">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wpsC2C6.tmp.jpg">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wps15D8.tmp.jpg">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wps476.tmp.jpg">
<meta property="og:image" content="e:/Computer/myblog/hexo/source_posts/C-基础教程整理/wps2394.tmp.jpg">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wps23AF.tmp.jpg">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wps55EB.tmp.jpg">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wps3099.tmp.jpg">
<meta property="og:image" content="http://qiniu.orangew.cn/img/wpsB7C8.tmp.jpg">
<meta property="article:published_time" content="2022-07-01T14:59:11.000Z">
<meta property="article:modified_time" content="2022-07-03T01:05:31.981Z">
<meta property="article:author" content="OrangeW">
<meta property="article:tag" content="c++">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://qiniu.orangew.cn/img/wps39B3.tmp.jpg">

<link rel="canonical" href="https://01zic.github.io/2022/07/01/C-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%E6%95%B4%E7%90%86/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>C++基础教程整理 | orangeWBlog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">orangeWBlog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://01zic.github.io/2022/07/01/C-%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%E6%95%B4%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/orange.png">
      <meta itemprop="name" content="OrangeW">
      <meta itemprop="description" content="demo_study record">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="orangeWBlog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          C++基础教程整理
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-07-01 22:59:11" itemprop="dateCreated datePublished" datetime="2022-07-01T22:59:11+08:00">2022-07-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-07-03 09:05:31" itemprop="dateModified" datetime="2022-07-03T09:05:31+08:00">2022-07-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/c/" itemprop="url" rel="index"><span itemprop="name">c++</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>95k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2:53</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="C语言提高"><a href="#C语言提高" class="headerlink" title="C语言提高"></a>C语言提高</h2><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><ul>
<li>B站黑马教程资料总结</li>
<li> [Linux C 函数.chm](C-基础教程整理\07_Linux C 函数.chm) </li>
</ul>
<h3 id="内存四区"><a href="#内存四区" class="headerlink" title="内存四区"></a>内存四区</h3><h4 id="数据类型本质分析"><a href="#数据类型本质分析" class="headerlink" title="数据类型本质分析"></a>数据类型本质分析</h4><h5 id="数据类型概念"><a href="#数据类型概念" class="headerlink" title="数据类型概念"></a>数据类型概念</h5><ul>
<li> “类型”是对数据的抽象 </li>
<li> 类型相同的数据有相同的表示形式、存储格式以及相关的操作 </li>
<li> 程序中使用的所有数据都必定属于某一种数据类型 </li>
<li><img src="http://qiniu.orangew.cn/img/wps39B3.tmp.jpg" alt="img"></li>
</ul>
<h5 id="数据类型的本质"><a href="#数据类型的本质" class="headerlink" title="数据类型的本质"></a>数据类型的本质</h5><ul>
<li>数据类型可理解为创建变量的模具：是固定内存大小的别名。</li>
<li>数据类型的作用：编译器预算对象（变量）分配的内存空间大小</li>
<li>注意：数据类型只是模具，编译器并没有分配空间，只有根据类型（模具）创建变量（实物），编译器才会分配空间。</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//告诉编译器，分配4个字节的内存</span>
    <span class="token keyword">int</span> b<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//告诉编译器，分配4*10 = 40 个字节的内存</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"b:%p, b+1: %p, &amp;b:%p, &amp;b+1: %p\n"</span><span class="token punctuation">,</span> b<span class="token punctuation">,</span> b <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">,</span> <span class="token operator">&amp;</span>b <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//b+1 和 &amp;b+1的结果不一样 </span>
    <span class="token comment">//是因为 b 和 &amp;b 所代表的数据类型不一样</span>
    <span class="token comment">//b  代表数组首元素的地址</span>
    <span class="token comment">//&amp;b 代表整体数组的地址</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><img src="http://qiniu.orangew.cn/img/20220702085501.png" alt="20220702085501"></li>
</ul>
<h5 id="数据类型的大小"><a href="#数据类型的大小" class="headerlink" title="数据类型的大小"></a>数据类型的大小</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//告诉编译器，分配4个字节的内存</span>
    <span class="token keyword">int</span> b<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//告诉编译器，分配4*10 = 40 个字节的内存</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"sizeof(a):%d \n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"sizeof(int *):%d \n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"sizeof(b):%d \n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"sizeof(b[0]):%d \n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"sizeof(*b):%d \n"</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token operator">*</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><img src="http://qiniu.orangew.cn/img/20220702090155.png" alt="20220702090155"></li>
<li>sizeof是操作符，不是函数；sizeof测量的实体大小为编译期间就已确定。</li>
</ul>
<h5 id="数据类型的别名"><a href="#数据类型的别名" class="headerlink" title="数据类型的别名"></a>数据类型的别名</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">struct</span> <span class="token class-name">People</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">People</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token class-name">people_t</span><span class="token punctuation">;</span>
<span class="token comment">/* 给结构体类型起别名 */</span>

<span class="token keyword">typedef</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> u32<span class="token punctuation">;</span>   <span class="token comment">//给unsigned int类型取别名</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">struct</span> <span class="token class-name">People</span> p1<span class="token punctuation">;</span> 
    <span class="token class-name">people_t</span> p2<span class="token punctuation">;</span>
    u32 a<span class="token punctuation">;</span>      

    p1<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>    
    p2<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>        

    a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>                 

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>                   
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="数据类型的封装"><a href="#数据类型的封装" class="headerlink" title="数据类型的封装"></a>数据类型的封装</h5><ul>
<li> void的字面意思是“无类型”，void *则为“无类型指针”，void *可以指向任何类型的数据。</li>
</ul>
<ol>
<li>用法1：数据类型的封装</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">InitHardEnv</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span>handle<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>典型的如内存操作函数memcpy和memset的函数原型分别为</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token operator">*</span> <span class="token function">memcpy</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>dest<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>src<span class="token punctuation">,</span> <span class="token class-name">size_t</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token operator">*</span> <span class="token function">memset</span> <span class="token punctuation">(</span> <span class="token keyword">void</span> <span class="token operator">*</span> buffer<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">,</span> <span class="token class-name">size_t</span> num <span class="token punctuation">)</span><span class="token punctuation">;</span>      <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ol start="2">
<li>用法2：void修饰函数返回值和参数，仅表示无<ul>
<li>如果函数没有返回值，那么应该将其声明为void型</li>
<li>如果函数没有参数，应该声明其参数为void</li>
</ul>
</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">function</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">function2</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>   
    <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>void指针的意义<ul>
<li>C语言规定只有相同类型的指针才可以相互赋值</li>
<li>void * 指针作为左值用于“接收”任意类型的指针</li>
<li>void * 指针作为右值赋值给其它指针时需要强制类型转换</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> 
<span class="token keyword">char</span> <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token function">sizoeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>不存在void类型的变量</li>
<li>C语言没有定义void究竟是多大内存的别名</li>
</ul>
<h5 id="数类型的总结与拓展"><a href="#数类型的总结与拓展" class="headerlink" title="数类型的总结与拓展"></a>数类型的总结与拓展</h5><blockquote>
<p>​    1、数据类型本质是固定内存大小的别名，是个模具，c语言规定：通过数据类型定义变量。</p>
<p>​    2、数据类型大小计算（sizeof）</p>
<p>​    3、可以给已存在的数据类型起别名typedef</p>
<p>​    4、数据类型封装概念（void 万能类型）</p>
</blockquote>
<h4 id="变量的本质分析"><a href="#变量的本质分析" class="headerlink" title="变量的本质分析"></a>变量的本质分析</h4><h5 id="变量的概念"><a href="#变量的概念" class="headerlink" title="变量的概念"></a>变量的概念</h5><ul>
<li>概念：既能读又能写的内存对象，称为变量；若一旦初始化后不能修改的对象则称为常量。</li>
<li>变量定义形式：   类型 标识符, 标识符, … , 标识符 ; </li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span>   	x<span class="token punctuation">;</span>
<span class="token keyword">int</span>   	wordCut<span class="token punctuation">,</span>  Radius<span class="token punctuation">,</span>  Height<span class="token punctuation">;</span>       
<span class="token keyword">double</span>   FlightTime<span class="token punctuation">,</span>  Mileage<span class="token punctuation">,</span>  Speed<span class="token punctuation">;</span>    
<span class="token keyword">int</span> a<span class="token punctuation">;</span>
<span class="token keyword">double</span> b<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="变量的本质"><a href="#变量的本质" class="headerlink" title="变量的本质"></a>变量的本质</h5><ol>
<li>程序通过变量来申请和命名内存空间 int a = 0。</li>
<li>通过变量名访问内存空间。</li>
<li>变量：一段连续内存空间的别名.</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token comment">// 通过变量直接操作内存</span>
	i <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

	<span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>i<span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"&amp;i:%d\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"p:%d\n"</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 通过内存编号间接操作内存</span>
	<span class="token operator">*</span>p <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"i = %d, *p = %d\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>数据类型和变量的关系<ul>
<li>通过数据类型定义变量</li>
</ul>
</li>
<li>总结</li>
</ol>
<blockquote>
<p>1 对内存，可读可写；</p>
<p>2 通过变量往内存读写数据；</p>
<p>3 不是向变量读写数据，而是向变量所代表的内存空间中写数据。</p>
</blockquote>
<h4 id="程序的内存四区模型"><a href="#程序的内存四区模型" class="headerlink" title="程序的内存四区模型"></a>程序的内存四区模型</h4><p><img src="http://qiniu.orangew.cn/img/wpsE914.tmp.jpg" alt="img"></p>
<ul>
<li><p>流程说明</p>
<ul>
<li><p>操作系统把物理硬盘代码load到内存</p>
</li>
<li><p>操作系统把c代码分成四个区</p>
</li>
<li><p><img src="file:///C:\Users\10559\AppData\Local\Temp\ksohtml\wps9FF2.tmp.jpg" alt="img"></p>
</li>
<li><p>操作系统找到main函数入口执行</p>
</li>
<li><p>建立正确程序运行内存布局图是学好C的关键</p>
</li>
</ul>
</li>
</ul>
<h5 id="栈区和堆区"><a href="#栈区和堆区" class="headerlink" title="栈区和堆区"></a>栈区和堆区</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token comment">//堆</span>
<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">getMem</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    p1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token operator">*</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">if</span> <span class="token punctuation">(</span>p1 <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>                   
        <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>                
    <span class="token punctuation">&#125;</span>                                   
    <span class="token keyword">return</span> p1<span class="token punctuation">;</span>      
<span class="token punctuation">&#125;</span>

<span class="token comment">//栈</span>

<span class="token comment">//注意 return不是把内存块 64个字节,给return出来</span>
<span class="token comment">//而是把内存块的首地址(比如内存的编号0xaa11) ，返回给 tmp</span>
<span class="token comment">// 理解指针的关键是内存，没有内存哪里来的指针 </span>

<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">getMem2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//临时变量 栈区存放</span>
    <span class="token function">strcpy</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token string">"123456789"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//printf("buf:%s\n", buf);</span>
    <span class="token keyword">return</span> buf<span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>tmp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    tmp <span class="token operator">=</span> <span class="token function">getMem</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tmp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>                   
        <span class="token keyword">return</span> <span class="token punctuation">;</span>                    
    <span class="token punctuation">&#125;</span>                                   
    <span class="token function">strcpy</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> <span class="token string">"111222"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//向tmp做指向的内存空间中copy数据</span>

    tmp <span class="token operator">=</span> <span class="token function">getMem2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//tmp = 0xaa11;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="全局区"><a href="#全局区" class="headerlink" title="全局区"></a>全局区</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">char</span> <span class="token operator">*</span> <span class="token function">getStr1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token string">"abcdefg2"</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> p1<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">getStr2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token string">"abcdefg2"</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> p2<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    p1 <span class="token operator">=</span> <span class="token function">getStr1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    p2 <span class="token operator">=</span> <span class="token function">getStr2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//打印p1 p2 所指向内存空间的数据</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"p1:%s , p2:%s \n"</span><span class="token punctuation">,</span> p1<span class="token punctuation">,</span> p2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//打印p1 p2 的值</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"p1:%p , p2:%p \n"</span><span class="token punctuation">,</span> p1<span class="token punctuation">,</span> p2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="函数的调用模型"><a href="#函数的调用模型" class="headerlink" title="函数的调用模型"></a>函数的调用模型</h5><ul>
<li><img src="http://qiniu.orangew.cn/img/wpsFE.tmp.jpg" alt="img"></li>
</ul>
<h5 id="函数调用变量传递分析"><a href="#函数调用变量传递分析" class="headerlink" title="函数调用变量传递分析"></a>函数调用变量传递分析</h5><ol>
<li><p><img src="http://qiniu.orangew.cn/img/wps2BC3.tmp.png" alt="img"></p>
</li>
<li><p> <img src="http://qiniu.orangew.cn/img/wpsCC98.tmp.png" alt="img"></p>
</li>
<li><p><img src="http://qiniu.orangew.cn/img/wps996F.tmp.png" alt="img"></p>
</li>
<li><p><img src="http://qiniu.orangew.cn/img/wps6422.tmp.png" alt="img"></p>
</li>
<li><p><img src="http://qiniu.orangew.cn/img/wpsBE4A.tmp.png" alt="img"></p>
</li>
</ol>
<p><img src="http://qiniu.orangew.cn/img/wps2E6A.tmp.jpg" alt="img"> </p>
<ol>
<li>main函数中可以在栈/堆/全局分配内存，都可以被func1和func2使用</li>
<li>func2在栈上分配的内存，不能被func1和main函数使用</li>
<li>func2中malloc的内存(堆),可以被main和func1函数使用</li>
<li>func2中全局分配“abcdefg”(常量全局区)内存，可以被func1和main函数使用</li>
</ol>
<h5 id="栈的生长方向和内存存放方向"><a href="#栈的生长方向和内存存放方向" class="headerlink" title="栈的生长方向和内存存放方向"></a>栈的生长方向和内存存放方向</h5><p><img src="http://qiniu.orangew.cn/img/wpsC94E.tmp.png" alt="img"></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> a<span class="token punctuation">;</span>
    <span class="token keyword">int</span> b<span class="token punctuation">;</span>

    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"&amp;a: %p\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"&amp;b: %p\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"buf的地址 : %p\n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"buf+1地址: %p \n"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h3><h4 id="指针强化"><a href="#指针强化" class="headerlink" title="指针强化"></a>指针强化</h4><h5 id="指针是一种数据类型"><a href="#指针是一种数据类型" class="headerlink" title="指针是一种数据类型"></a>指针是一种数据类型</h5><ol>
<li><p>指针变量也是一种变量，占有内存空间，用来保存内存地址</p>
<p>测试指针变量占有内存空间大小。</p>
</li>
<li><p>*p操作内存</p>
</li>
</ol>
<blockquote>
<p>在指针声明时，* 号表示所声明的变量为指针</p>
<p>在指针使用时，* 号表示操作指针所指向的内存空间中的值</p>
</blockquote>
<ul>
<li>*p相当于通过地址(p变量的值)找到一块内存，然后操作内存</li>
<li>*p放在等号的左边赋值（给内存赋值，写内存）</li>
<li>*p放在等号的右边取值（从内存获取值，读内存）</li>
</ul>
<ol start="3">
<li>指针变量和它指向的内存块是两个不同的概念。</li>
</ol>
<blockquote>
<p>​        规则1： 给p赋值p=0x1111; 只会改变指针变量值，不会改变所指的内容；</p>
<p>​        p = p +1; //p++</p>
<p>​        规则2 ：给*p赋值 *p=’a’; 不会改变指针变量的值，只会改变所指的内存块的值 </p>
<p>​        规则3 ：= 左边 *p 表示 给内存赋值， = 右边 *p 表示取值，含义不同切记！</p>
<p>​        规则4 ：保证所指的内存块能修改</p>
</blockquote>
<ol start="4">
<li>指针是一种数据类型，是指它指向的内存空间的数据类型 。</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> a<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">;</span> 
p<span class="token operator">++</span>；<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li>指针步长（p++），根据所致内存空间的数据类型来确定。</li>
<li>p++ 等价于 (unsigned char )p+sizeof(a);    </li>
</ul>
<ol start="5">
<li>当我们不断的给指针变量赋值，就是不断的改变指针变量（和所指向内存空间没有任何关系）。指针指向谁，就把谁的地址赋值给指针。</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>


<span class="token comment">//不断给指针赋值就是不断改变指针的指向</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span>    buf<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span>     i<span class="token punctuation">;</span>

    <span class="token keyword">char</span>    <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span>    <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

    p1 <span class="token operator">=</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//不断的修改p1的值 相当于 不断改变指针的指向</span>
    p1 <span class="token operator">=</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    p1 <span class="token operator">=</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token comment">//不断改变p1本身变量</span>
        p1 <span class="token operator">=</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    p2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">strcpy</span><span class="token punctuation">(</span>p2<span class="token punctuation">,</span> <span class="token string">"abcdefg1212333333333311"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token comment">//不断的改变p1本身变量，跟p1指向的内存块无关</span>
        p1 <span class="token operator">=</span> p2<span class="token operator">+</span>i<span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c "</span><span class="token punctuation">,</span> <span class="token operator">*</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="6">
<li>不允许向NULL和未知非法地址拷贝内存。</li>
</ol>
<h5 id="简接赋值-p-是指针存在的最大意义"><a href="#简接赋值-p-是指针存在的最大意义" class="headerlink" title="简接赋值(* p)是指针存在的最大意义"></a>简接赋值(* p)是指针存在的最大意义</h5><blockquote>
<p>*p间接赋值成立条件： 三大条件 </p>
<p>条件一： 2个变量（通常一个实参，一个形参）</p>
<p>条件二：建立关系，实参取地址赋给形参指针 </p>
<p>条件三：*p形参去间接修改实参的值 </p>
</blockquote>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
<span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  <span class="token comment">// 条件一：两个变量</span>
            
p <span class="token operator">=</span> <span class="token operator">&amp;</span>num<span class="token punctuation">;</span>       <span class="token comment">// 条件二：建立关系</span>

Num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token operator">*</span>p <span class="token operator">=</span> <span class="token number">2</span> <span class="token punctuation">;</span>        <span class="token comment">// 条件三：通过* 操作符， 间接的给变量内存赋值</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>间接操作：从0级指针到1级指针</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token comment">//使用一级指针</span>
<span class="token keyword">void</span>  <span class="token function">getFileLen</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token number">41</span><span class="token punctuation">;</span>    <span class="token comment">//  p的值是file_len的地址 *p的地址间接修改file_len的值 </span>
                     <span class="token comment">//在被调用函数里面 通过形参 去 间接的修改 实参的值...</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span>  <span class="token function">getFileLen2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> len<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//不使用指针， 0级指针</span>
<span class="token keyword">void</span>  <span class="token function">getFileLen3</span><span class="token punctuation">(</span><span class="token keyword">int</span> file_len<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    file_len <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//1级指针的技术推演</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> file_len <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>      <span class="token comment">//条件1  定义了两个变量(实参 另外一个变量是形参p)</span>
    <span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

    p <span class="token operator">=</span> <span class="token operator">&amp;</span>file_len<span class="token punctuation">;</span>          <span class="token comment">//条件2 建立关联</span>

    file_len <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>         <span class="token comment">//直接修改</span>
    <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>               <span class="token comment">//条件3 p的值是file_len的地址 </span>
                           <span class="token comment">//      *就像一把钥匙 通过地址 </span>
                           <span class="token comment">//      找到一块内存空间 间接的修改了file_len的值</span>

    <span class="token punctuation">&#123;</span>
        <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span>  <span class="token comment">//  p的值是a的地址 *a的地址间接修改a的值  //条件3 *p</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"file_len: %d\n"</span><span class="token punctuation">,</span> file_len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">getFileLen</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>file_len<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//建立关联: 把实参取地址 传递给 形参</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"getFileLen后 file_len: %d \n"</span><span class="token punctuation">,</span> file_len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">getFileLen3</span><span class="token punctuation">(</span>file_len<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"getFileLen3后 file_len: %d \n"</span><span class="token punctuation">,</span> file_len<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>间接操作：从1级别指针到2级指针</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>


<span class="token keyword">void</span> <span class="token function">getMem</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>p2<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    p2 <span class="token operator">=</span> <span class="token number">0x80088008</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">getMem2</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>p2<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token number">0x40044004</span><span class="token punctuation">;</span> <span class="token comment">//间接赋值  p2是p1的地址</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

    <span class="token comment">//直接修改p1的值</span>
    p1 <span class="token operator">=</span> <span class="token number">0x11001100</span><span class="token punctuation">;</span>

    <span class="token comment">//间接修改p1的值</span>
    p2 <span class="token operator">=</span> <span class="token operator">&amp;</span>p1<span class="token punctuation">;</span>

    <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token number">0x10101010</span><span class="token punctuation">;</span>    <span class="token comment">//间接赋值  p2是p1的地址</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"p1:%p \n"</span><span class="token punctuation">,</span> p1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">&#123;</span>
        <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token number">0x20022002</span><span class="token punctuation">;</span> <span class="token comment">//间接赋值  p2是p1的地址</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"p1:%p \n"</span><span class="token punctuation">,</span> p1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">getMem</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">getMem2</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"p1:%p \n"</span><span class="token punctuation">,</span> p1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>函数调用时，形参传给实参，用实参取地址，传给形参，在被调用函数里面用*p，来改变实参，把运算结果传出来。</p>
</blockquote>
<ul>
<li>间接赋值的推论</li>
</ul>
<blockquote>
<p>用1级指针形参，去间接修改了0级指针(实参)的值。</p>
<p>用2级指针形参，去间接修改了1级指针(实参)的值。</p>
<p>用3级指针形参，去间接修改了2级指针(实参)的值。</p>
<p>用n级指针形参，去间接修改了n-1级指针(实参)的值。</p>
</blockquote>
<ul>
<li>间接操作：应用场景<ul>
<li>正常：    条件一，条件二，条件三都写在一个函数里。</li>
<li>间接赋值：条件一，条件二写在一个函数里， 条件三写在另一个函数里</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token comment">/* 间接赋值成立的三个条件
   条件1    定义1个变量（实参） 
   条件2    建立关联：把实参取地址传给形参
   条件3：  *形参去间接地的修改了实参的值。
 */</span>
<span class="token keyword">void</span> <span class="token function">copy_str</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>p1<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>p2<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>p1 <span class="token operator">!=</span> <span class="token char">'\0'</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token operator">*</span>p1<span class="token punctuation">;</span>
        p2<span class="token operator">++</span><span class="token punctuation">;</span>
        p1<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//间接赋值的应用场景</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//1写在一个函数中 2作为形参建立关联   3 单独写在另外一个函数里面 </span>
    <span class="token keyword">char</span> from<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> to<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token function">strcpy</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> <span class="token string">"1122233133332fafdsafas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">copy_str</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> to<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"to:%s \n"</span><span class="token punctuation">,</span> to<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="理解指针必须和内存四区概念结合"><a href="#理解指针必须和内存四区概念结合" class="headerlink" title="理解指针必须和内存四区概念结合"></a>理解指针必须和内存四区概念结合</h5><ol>
<li>主调函数 被调函数 <ul>
<li>主调函数可把堆区、栈区、全局数据内存地址传给被调用函数</li>
<li>被调用函数只能返回堆区、全局数据</li>
</ul>
</li>
<li>内存分配方式<ul>
<li>指针做函数参数，是有输入和输出特性的。</li>
</ul>
</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token keyword">int</span> <span class="token function">getMem</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>myp1<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>mylen1<span class="token punctuation">,</span>  <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>myp2<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>mylen2<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span>     ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span>    <span class="token operator">*</span>tmp1<span class="token punctuation">,</span> <span class="token operator">*</span>tmp2<span class="token punctuation">;</span>

    tmp1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">strcpy</span><span class="token punctuation">(</span>tmp1<span class="token punctuation">,</span> <span class="token string">"1132233"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//间接赋值 </span>
    <span class="token operator">*</span>mylen1 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>tmp1<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//1级指针</span>
    <span class="token operator">*</span>myp1 <span class="token operator">=</span> tmp1<span class="token punctuation">;</span>            <span class="token comment">//2级指针的间接赋值</span>

    tmp2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">strcpy</span><span class="token punctuation">(</span>tmp2<span class="token punctuation">,</span> <span class="token string">"aaaaavbdddddddd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token operator">*</span>mylen2 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>tmp2<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//1级指针</span>
    <span class="token operator">*</span>myp2 <span class="token operator">=</span> tmp2<span class="token punctuation">;</span>            <span class="token comment">//2级指针的间接赋值</span>

    <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span>  <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span>     ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span>    <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span>     len1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span>    <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span>     len2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    ret <span class="token operator">=</span> <span class="token function">getMem</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>len1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>p2<span class="token punctuation">,</span> <span class="token operator">&amp;</span>len2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"func getMem() err:%d \n"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"p1:%s \n"</span><span class="token punctuation">,</span> p1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"p2:%s \n"</span><span class="token punctuation">,</span> p2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>p1 <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">free</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        p1 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>p2 <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">free</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        p2 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>


    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="应用指针必须和函数调用相结合（指针做函数参数）"><a href="#应用指针必须和函数调用相结合（指针做函数参数）" class="headerlink" title="应用指针必须和函数调用相结合（指针做函数参数）"></a>应用指针必须和函数调用相结合（指针做函数参数）</h5><ul>
<li><p>指针作为函数参数是研究指针的重点。</p>
</li>
<li><p>一级指针典型用法:</p>
<ul>
<li><p>一级指针做输入</p>
</li>
<li><blockquote>
<p>int showbuf(char *p);</p>
<p>int showArray(int *array, int iNum);</p>
</blockquote>
</li>
<li><p>一级指针做输出</p>
</li>
<li><blockquote>
<p>int getLen(char *pFileName, int *pfileLen);</p>
</blockquote>
<blockquote>
<p>理解</p>
<p>​        输入：主调函数分配内存</p>
<p>​        输出：被调用函数分配内存</p>
<p>​        被调用函数是在heap上分配内存而非stack上</p>
</blockquote>
</li>
</ul>
</li>
<li><p>二级指针典型用法</p>
<ul>
<li><p>二级指针做输入</p>
</li>
<li><blockquote>
<p>int main(int arc ,char * arg[]);     //字符串数组</p>
<p>int shouMatrix(int [3] [4], int iLine);</p>
</blockquote>
</li>
<li><p>二级指针做输出</p>
</li>
<li><blockquote>
<p>int Demo64_GetTeacher(Teacher **ppTeacher);</p>
<p>int Demo65_GetTeacher_Free(Teacher **ppTeacher);</p>
<p>int getData(char **data, int *dataLen);</p>
<p>int getData_Free(void *data);</p>
<p>int getData_Free2(void **data);       //避免野指针</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h4 id="经典语录"><a href="#经典语录" class="headerlink" title="经典语录"></a>经典语录</h4><blockquote>
<p>1）指针也是一种数据类型，指针的数据类型是指它所指向内存空间的数据类型</p>
<p>2）间接赋值*p是指针存在的最大意义 </p>
<p>3）理解指针必须和内存四区概念相结合 </p>
<p>4）应用指针必须和函数调用相结合（指针做函数参数）</p>
<p>指针是子弹，函数是枪管；子弹只有沿着枪管发射才能显示它的威力；指针的学习重点不言而喻了吧。接口的封装和设计、模块的划分、解决实际应用问题；它是你的工具。</p>
<p>5）指针指向谁就把谁的地址赋给指针 </p>
<p>6）C/C++语言有它自己的学习特点；若java语言的学习特点是学习、应用、上项目；那么C/C++语言的学习特点是：学习、理解、应用、上项目。多了一个步骤。</p>
<p>7)理解指针关键在内存，没有内存哪来的内存首地址，没有内存首地址，哪来的指针。</p>
</blockquote>
<h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><h4 id="字符串的基本操作"><a href="#字符串的基本操作" class="headerlink" title="字符串的基本操作"></a>字符串的基本操作</h4><h5 id="字符串数组初始化方法"><a href="#字符串数组初始化方法" class="headerlink" title="字符串数组初始化方法"></a>字符串数组初始化方法</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token comment">//一级指针的典型用法</span>
<span class="token comment">//字符串 </span>
<span class="token comment">//1 C语言的字符串 以零'\0'结尾的字符串</span>
<span class="token comment">//2 在C语言中没有字符串类型  通过字符数组 来模拟字符串 </span>
<span class="token comment">//3 字符串的内存分配  堆上 栈上 全局区 </span>

<span class="token comment">//字符数组 初始化</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//1 不指定长度  C编译器会自动帮程序员 求元素的个数</span>
    <span class="token keyword">char</span> buf1<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token char">'a'</span><span class="token punctuation">,</span> <span class="token char">'b'</span><span class="token punctuation">,</span> <span class="token char">'c'</span><span class="token punctuation">,</span> <span class="token char">'d'</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token comment">//buf1是一个数组 不是一个以0结尾的字符串</span>

    <span class="token comment">//2 指定长度  </span>
    <span class="token keyword">char</span> buf2<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token char">'a'</span><span class="token punctuation">,</span> <span class="token char">'b'</span><span class="token punctuation">,</span> <span class="token char">'c'</span><span class="token punctuation">,</span> <span class="token char">'d'</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token comment">//后面的buf2[4]-buf2[99] 个字节均默认填充0</span>

    <span class="token comment">//char buf3[2] = &#123;'a', 'b', 'c', 'd'&#125;; </span>
    <span class="token comment">//如果初始化的个数大于内存的个数 编译错误</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"buf1: %s\n"</span><span class="token punctuation">,</span> buf1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"buf2: %s \n"</span><span class="token punctuation">,</span> buf2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"buf2[88]:%d \n"</span><span class="token punctuation">,</span> buf2<span class="token punctuation">[</span><span class="token number">88</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token comment">//3 用字符串初始化 字符数组</span>
    <span class="token keyword">char</span> buf3<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"abcd"</span><span class="token punctuation">;</span>       <span class="token comment">//buf3 作为字符数组 有5个字节</span>
                                <span class="token comment">//      作为字符串有 4个字节</span>

    <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>buf3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"buf3字符的长度:%d \n"</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//4</span>

    <span class="token comment">//buf3 作为数组 数组是一种数据类型 本质(固定小大内存块的别名)</span>
    <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"buf3数组所占内存空间大小:%d \n"</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//5</span>


    <span class="token keyword">char</span> buf4<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"abcd"</span><span class="token punctuation">;</span> <span class="token comment">// buf</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"buf4[100]:%d \n"</span><span class="token punctuation">,</span> buf4<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>sizeof 和 strlen的区别</p>
</li>
<li><blockquote>
<ol>
<li><p>sizeof为一个操作符，执行sizeof的结果，在编译期间就已经确定；</p>
<p>strlen是一个函数，是在程序执行的时候才确定结果。</p>
</li>
<li><p>sizeof和strlen对于求字符串来讲，sizeof() 字符串类型的大小，包括’\0’；strlen() 字符串的长度不包括‘\0’（数字 0 和字符‘\0’等价）。</p>
</li>
</ol>
</blockquote>
</li>
</ul>
<h5 id="数组法和指针法操作字符串"><a href="#数组法和指针法操作字符串" class="headerlink" title="数组法和指针法操作字符串"></a>数组法和指针法操作字符串</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span>     i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span>    <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> 
    <span class="token keyword">char</span>    buf<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"abcdefg"</span><span class="token punctuation">;</span>  

    <span class="token comment">//通过[]</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>                       
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c "</span><span class="token punctuation">,</span> buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          
    <span class="token punctuation">&#125;</span>                                       
                        
    p <span class="token operator">=</span> buf<span class="token punctuation">;</span> <span class="token comment">//buf 代表数组首元素的地址</span>
    <span class="token comment">//通过指针</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>                                                          
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c "</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">+</span>i<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">;</span>                            
    <span class="token punctuation">&#125;</span>                                                       

    <span class="token comment">//通过数组首元素地址 buf 来操作</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>                                   
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c "</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span>buf<span class="token operator">+</span>i<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>                                                   
    
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><code>[]</code> 的本质 和 <code>*p</code> 是一样。</li>
<li><code>buf</code> 是一个指针，只读的常量。之所以<code>buf</code>是一个常量指针是为了释放内存的时候,保证<code>buf</code>所指向的内存空间安全。</li>
</ul>
<h4 id="字符串做函数参数"><a href="#字符串做函数参数" class="headerlink" title="字符串做函数参数"></a>字符串做函数参数</h4><ul>
<li>数组偏移来拷贝</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"i am a student"</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> b<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span>  i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">+</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token operator">*</span><span class="token punctuation">(</span>b<span class="token operator">+</span>i<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span>a<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">//0没有copy到b的buf中.</span>

    b<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span> <span class="token comment">//重要</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a:%s \n"</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"b:%s \n"</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>用一个一级指针</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token comment">//字符串copy函数</span>

<span class="token comment">//form形参 形参to 的值 不停的在变化....</span>
<span class="token comment">//不断的修改了from和to的指向</span>
<span class="token keyword">void</span> <span class="token function">copy_str1</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>from<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>to<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> <span class="token operator">*</span>from<span class="token operator">!=</span><span class="token char">'\0'</span><span class="token punctuation">;</span> from<span class="token operator">++</span><span class="token punctuation">,</span> to<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token operator">*</span>to <span class="token operator">=</span> <span class="token operator">*</span>from<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token operator">*</span>to <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">void</span> <span class="token function">copy_str2</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>from<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>to<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> <span class="token operator">*</span>from<span class="token operator">!=</span><span class="token char">'\0'</span><span class="token punctuation">;</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token operator">*</span>to<span class="token operator">++</span> <span class="token operator">=</span> <span class="token operator">*</span>from<span class="token operator">++</span><span class="token punctuation">;</span>  <span class="token comment">//  先 *to = *from;  再from++, to++ </span>
    <span class="token punctuation">&#125;</span>
    <span class="token operator">*</span>to <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span> 

    <span class="token keyword">return</span> <span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">copy_str3</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>from<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>to<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token operator">*</span>to <span class="token operator">=</span> <span class="token operator">*</span>from<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token char">'\0'</span> <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        from <span class="token operator">++</span><span class="token punctuation">;</span>
        to <span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">copy_str4</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>from <span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>to<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token operator">*</span>to<span class="token operator">++</span> <span class="token operator">=</span> <span class="token operator">*</span>from<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token char">'\0'</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">copy_str5</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>from <span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>to<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//*(0) = 'a';</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token operator">*</span>to<span class="token operator">++</span> <span class="token operator">=</span> <span class="token operator">*</span>from<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">copy_str5_err</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>from <span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>to<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//*(0) = 'a';</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token operator">*</span>to<span class="token operator">++</span> <span class="token operator">=</span> <span class="token operator">*</span>from<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"from:%s \n"</span><span class="token punctuation">,</span> from<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span>

<span class="token comment">//不要轻易改变形参的值, 要引入一个辅助的指针变量. 把形参给接过来.....</span>
<span class="token keyword">int</span> <span class="token function">copy_str6</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>from <span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>to<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//*(0) = 'a';</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>tmpfrom <span class="token operator">=</span> from<span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>tmpto <span class="token operator">=</span> to<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> from <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> to <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>tmpto<span class="token operator">++</span> <span class="token operator">=</span> <span class="token operator">*</span>tmpfrom<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>  <span class="token comment">//空语句</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"from:%s \n"</span><span class="token punctuation">,</span> from<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>from <span class="token operator">=</span> <span class="token string">"abcd"</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">0</span></span></span>
    <span class="token function">copy_str1</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">copy_str2</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">copy_str3</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">copy_str4</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">copy_str5</span><span class="token punctuation">(</span>from <span class="token punctuation">,</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"buf:%s \n"</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">&#123;</span>
        <span class="token comment">//错误案例</span>
        <span class="token keyword">char</span> <span class="token operator">*</span>myto <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  <span class="token comment">//要分配内存</span>
        <span class="token comment">//copy_str25(from,myto);</span>
    <span class="token punctuation">&#125;</span>

    <span class="token punctuation">&#123;</span>
        <span class="token keyword">char</span> <span class="token operator">*</span>myto <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>  <span class="token comment">//要分配内存</span>

        ret <span class="token operator">=</span> <span class="token function">copy_str6</span><span class="token punctuation">(</span>from<span class="token punctuation">,</span> myto<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"func copy_str6() err:%d  "</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
	
   <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="项目开发常用字符串应用模型"><a href="#项目开发常用字符串应用模型" class="headerlink" title="项目开发常用字符串应用模型"></a>项目开发常用字符串应用模型</h4><h5 id="strstr中的while和do-while模型"><a href="#strstr中的while和do-while模型" class="headerlink" title="strstr中的while和do-while模型"></a>strstr中的while和do-while模型</h5><ul>
<li>利用strstr标准库函数找出一个字符串中substr出现的个数。</li>
<li>do-while模型</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//strstr(str, str2)</span>

    <span class="token keyword">int</span> ncount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">//初始化 让p指针达到查找的条件</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token string">"11abcd111122abcd3333322abcd3333322qqq"</span><span class="token punctuation">;</span>

    <span class="token keyword">do</span>
    <span class="token punctuation">&#123;</span>
        p <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token string">"abcd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            ncount<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">//</span>
            p <span class="token operator">=</span> p <span class="token operator">+</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token string">"abcd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//指针达到下次查找的条件</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>p <span class="token operator">!=</span> <span class="token char">'\0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ncount:%d \n"</span><span class="token punctuation">,</span> ncount<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>while模型</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> ncount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">//初始化 让p指针达到查找的条件</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token string">"2abcd3333322qqqabcd"</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token string">"abcd"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">NULL</span> <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        ncount <span class="token operator">++</span><span class="token punctuation">;</span>
        p <span class="token operator">=</span> p <span class="token operator">+</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token string">"abcd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//让p指针达到查找的条件</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>p <span class="token operator">==</span> <span class="token char">'\0'</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ncount:%d \n"</span><span class="token punctuation">,</span> ncount<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="两头堵模型"><a href="#两头堵模型" class="headerlink" title="两头堵模型"></a>两头堵模型</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ctype.h></span></span>

<span class="token keyword">int</span> <span class="token function">get_count_non_space</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span> count_p<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> ncount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> count_p <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"str == NULL, count_p == NULL\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">isspace</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> str<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token char">'\0'</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        i<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">isspace</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">></span> i<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        j<span class="token operator">--</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    ncount <span class="token operator">=</span> j<span class="token operator">-</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token operator">*</span>count_p <span class="token operator">=</span> ncount<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token string">"      abcdefg      "</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> ncount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    ret <span class="token operator">=</span> <span class="token function">get_count_non_space</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ncount<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">fprintf</span><span class="token punctuation">(</span><span class="token constant">stderr</span><span class="token punctuation">,</span> <span class="token string">"get_count_non_space err, ret = %d\n"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ncount = %d\n"</span><span class="token punctuation">,</span> ncount<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="字符串反转模型"><a href="#字符串反转模型" class="headerlink" title="字符串反转模型"></a>字符串反转模型</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span><span class="token operator">*</span> <span class="token function">inverse</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> length <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> tmp_ch<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    p1 <span class="token operator">=</span> str<span class="token punctuation">;</span>
    p2 <span class="token operator">=</span> str <span class="token operator">+</span> length <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">while</span> <span class="token punctuation">(</span>p1 <span class="token operator">&lt;</span> p2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        tmp_ch <span class="token operator">=</span> <span class="token operator">*</span>p1<span class="token punctuation">;</span>
        <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token operator">*</span>p2<span class="token punctuation">;</span>
        <span class="token operator">*</span>p2 <span class="token operator">=</span> tmp_ch<span class="token punctuation">;</span>
        <span class="token operator">++</span>p1<span class="token punctuation">;</span>
        <span class="token operator">--</span>p2<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> str<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="递归思想"><a href="#递归思想" class="headerlink" title="递归思想"></a>递归思想</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>

<span class="token keyword">char</span> g_buf<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">//3 递归和非全局变量</span>
<span class="token keyword">int</span> <span class="token function">inverse4</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>dst<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>str <span class="token operator">==</span> <span class="token char">'\0'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// 递归技术的条件</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">inverse4</span><span class="token punctuation">(</span>str<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> dst<span class="token punctuation">)</span>  <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">strncat</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> str<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//2 递归和全局变量(把逆序的结果放在全局变量里)</span>
<span class="token keyword">int</span> <span class="token function">inverse3</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>str <span class="token operator">==</span> <span class="token char">'\0'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// 递归技术的条件</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">inverse3</span><span class="token punctuation">(</span>str<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">strncat</span><span class="token punctuation">(</span>g_buf<span class="token punctuation">,</span> str<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//1 通过递归的方式逆序打印</span>
<span class="token keyword">int</span> <span class="token function">inverse2</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>str <span class="token operator">==</span> <span class="token char">'\0'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// 递归技术的条件</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">inverse2</span><span class="token punctuation">(</span>str<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%c"</span><span class="token punctuation">,</span> <span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"abcdefg"</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> dst_buf<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">// test inverse()</span>
    <span class="token comment">//printf("buf : %s\n", inverse(buf));</span>

    <span class="token comment">// test inverse2();</span>
    <span class="token comment">//inverse2(buf);</span>

    <span class="token comment">// test inverse3();</span>
    <span class="token comment">//inverse3(buf);</span>
    <span class="token comment">//printf("g_buf : %s\n", g_buf);</span>

    <span class="token comment">// test inverse4();</span>
    <span class="token function">inverse4</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> dst_buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"dst_buf : %s\n"</span><span class="token punctuation">,</span> dst_buf<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="一级指针-char-易错地方"><a href="#一级指针-char-易错地方" class="headerlink" title="一级指针(char*)易错地方"></a>一级指针(char*)易错地方</h4><h5 id="对空字符串和非法字符串的判断"><a href="#对空字符串和非法字符串的判断" class="headerlink" title="对空字符串和非法字符串的判断"></a>对空字符串和非法字符串的判断</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">void</span> <span class="token function">copy_str</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>from<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>to<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>from <span class="token operator">==</span> <span class="token char">'\0'</span> <span class="token operator">||</span> <span class="token operator">*</span>to <span class="token operator">==</span> <span class="token char">'\0'</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"func copy_str() err\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> <span class="token operator">*</span>from<span class="token operator">!=</span><span class="token char">'\0'</span><span class="token punctuation">;</span> from<span class="token operator">++</span><span class="token punctuation">,</span> to<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token operator">*</span>to <span class="token operator">=</span> <span class="token operator">*</span>from<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token operator">*</span>to <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span><span class="token string">"aabbccdd"</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> to<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">copy_str</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> to<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"to : %s\n"</span><span class="token punctuation">,</span> to<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="越界"><a href="#越界" class="headerlink" title="越界"></a>越界</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"abc"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h5 id="指针的叠加会不断改变指针的方向"><a href="#指针的叠加会不断改变指针的方向" class="headerlink" title="指针的叠加会不断改变指针的方向"></a>指针的叠加会不断改变指针的方向</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">getKeyByValue</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>keyvaluebuf<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>keybuf<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> <span class="token operator">*</span><span class="token operator">*</span>keyvaluebuf <span class="token operator">!=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token operator">*</span>a<span class="token operator">++</span> <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span>keyvaluebuf<span class="token punctuation">)</span><span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>           

    <span class="token function">free</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>   

<span class="token keyword">void</span> <span class="token function">copy_str_err</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>from<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>to<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> <span class="token operator">*</span>from<span class="token operator">!=</span><span class="token char">'\0'</span><span class="token punctuation">;</span> from<span class="token operator">++</span><span class="token punctuation">,</span> to<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>           
        <span class="token operator">*</span>to <span class="token operator">=</span> <span class="token operator">*</span>from<span class="token punctuation">;</span>        
    <span class="token punctuation">&#125;</span>                           
    <span class="token operator">*</span>to <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span> 
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"to:%s"</span><span class="token punctuation">,</span> to<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"from:%s"</span><span class="token punctuation">,</span> from<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="局部变量不要外传"><a href="#局部变量不要外传" class="headerlink" title="局部变量不要外传"></a>局部变量不要外传</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">my_stract</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>x<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> y<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token number">80</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>z<span class="token operator">=</span>str<span class="token punctuation">;</span>           <span class="token comment">/*指针z指向数组str*/</span>  

    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">*</span>z<span class="token operator">++</span><span class="token operator">=</span><span class="token operator">*</span>x<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    z<span class="token operator">--</span><span class="token punctuation">;</span>                    <span class="token comment">/*去掉串尾结束标志*/</span>

    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">*</span>z<span class="token operator">++</span><span class="token operator">=</span><span class="token operator">*</span>y<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    z<span class="token operator">=</span>str<span class="token punctuation">;</span>                 <span class="token comment">/*将str地址赋给指针变量z*/</span>

    <span class="token keyword">return</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="函数内使用辅助变量的重要性"><a href="#函数内使用辅助变量的重要性" class="headerlink" title="函数内使用辅助变量的重要性"></a>函数内使用辅助变量的重要性</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token comment">//char *p = "abcd11111abcd2222abcdqqqqq"; </span>
<span class="token comment">//字符串中"abcd"出现的次数。</span>
<span class="token keyword">int</span> <span class="token function">getSubCount</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>substr<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>mycount<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> str<span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>sub <span class="token operator">=</span> substr<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token operator">==</span><span class="token constant">NULL</span> <span class="token operator">||</span> substr<span class="token operator">==</span><span class="token constant">NULL</span> <span class="token operator">||</span> mycount <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        ret <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">do</span>
    <span class="token punctuation">&#123;</span>
        p <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token operator">*</span>mycount<span class="token operator">++</span><span class="token punctuation">;</span>
            p <span class="token operator">=</span> p <span class="token operator">+</span> <span class="token function">strlen</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>p <span class="token operator">!=</span> <span class="token char">'\0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token string">"abcd11111abcd2222abcdqqqqq"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getSubCount</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token string">"abcd"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>count<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"error\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"abcd's count :%d\n"</span><span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="const"><a href="#const" class="headerlink" title="const"></a>const</h4><h5 id="const知识点"><a href="#const知识点" class="headerlink" title="const知识点"></a>const知识点</h5><ol>
<li>const声明的变量只能被读</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">const</span> <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

i<span class="token operator">=</span>j<span class="token punctuation">;</span>   <span class="token comment">//非法，导致编译错误</span>
j<span class="token operator">=</span>i<span class="token punctuation">;</span>   <span class="token comment">//合法 </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>必须初始化</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">const</span> <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>    <span class="token comment">//合法</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> j<span class="token punctuation">;</span>      <span class="token comment">//非法，导致编译错误</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ol start="3">
<li>在另一.c源文件中引用const常量</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">extern</span> <span class="token keyword">const</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span>         <span class="token comment">//合法</span>
<span class="token keyword">extern</span> <span class="token keyword">const</span> <span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">;</span>      <span class="token comment">//非法，常量不可以被再次赋值</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ol start="4">
<li>避免不必要的内存分配</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STRING</span> <span class="token string">"abcdefghijklmn"</span></span>
<span class="token keyword">const</span> <span class="token keyword">char</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"ABCDEFGHIJK"</span><span class="token punctuation">;</span>

<span class="token function">printf</span><span class="token punctuation">(</span>STRING<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//为STRING分配了第一次内存</span>
<span class="token function">printf</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//为string一次分配了内存，以后不再分配</span>

<span class="token function">printf</span><span class="token punctuation">(</span>STRING<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//为STRING分配了第二次内存</span>
<span class="token function">printf</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>      
<span class="token comment">/*
由于const定义常量从汇编的角度来看，只是给出了对应的内存地址，
而不是象#define一样给出的是立即数，所以，const定义的常量在
程序运行过程中只有一份拷贝，而#define定义的常量在内存中有
若干个拷贝。
*/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="5">
<li>C语言中const是一个冒牌货<ul>
<li>通过强制类型转换，将地址赋给变量，再作修改即可以改变const常量值。</li>
</ul>
</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">nt <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">const</span> <span class="token keyword">int</span> a<span class="token punctuation">;</span>    <span class="token comment">//代表一个常整型数</span>
    <span class="token keyword">int</span> <span class="token keyword">const</span> b<span class="token punctuation">;</span>    <span class="token comment">//代表一个常整型数  </span>

    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>c<span class="token punctuation">;</span>  <span class="token comment">// 是一个指向常整型数的指针</span>
                    <span class="token comment">// (所指向的内存数据不能修改，</span>
                    <span class="token comment">//  但是本身可以修改)</span>
    
    <span class="token keyword">char</span> <span class="token operator">*</span> <span class="token keyword">const</span> d<span class="token punctuation">;</span> <span class="token comment">// 常指针(指针变量不能被修改，</span>
                    <span class="token comment">//        但是它所指向的内存空间可以被修改)</span>

    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> <span class="token keyword">const</span> e<span class="token punctuation">;</span><span class="token comment">// 一个指向常量整型的常指针</span>
                         <span class="token comment">// (指针和它所指向的内存空间，</span>
                         <span class="token comment">//  均不可以修改)</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>const好处</li>
</ul>
<blockquote>
<p>合理的利用const，</p>
<p>1 指针做函数参数，可以有效的提高代码可读性，减少bug；</p>
<p>2 清楚的分清参数的输入和输出特性</p>
</blockquote>
<h4 id="强化练习"><a href="#强化练习" class="headerlink" title="强化练习"></a>强化练习</h4><blockquote>
<p>有一个字符串开头或结尾含有n个空格 （”   abcdefgdddd    “），欲去掉前后空格，返回一个新字符串。<br>    要求1：请自己定义一个接口（函数），并实现功能；<br>    要求2：编写测试用例。<br>    int trimSpace(char *inbuf, char *outbuf);</p>
</blockquote>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token comment">/*
2. 有一个字符串开头或结尾含有n个空格 （"   abcdefgdddd    "），欲去掉前后空格，返回一个新字符串。
	要求1：请自己定义一个接口（函数），并实现功能；
	要求2：编写测试用例。
	int trimSpace(char *inbuf, char *outbuf);
*/</span>


<span class="token comment">/* 
功能：获取非空字符串
参数：
	inbuf： 原始字符串buf首地址
	outbuf：非空字符串buf首地址
返回值：
	成功：0
	失败：非0
*/</span>
<span class="token keyword">int</span> <span class="token function">trimSpace</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>inbuf<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>outbuf<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>inbuf <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> outbuf <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">int</span> begin <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//字符串第一个元素位置</span>
	<span class="token keyword">int</span> end <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>inbuf<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//字符串最后一个元素位置</span>
	<span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>end <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">//出错处理</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//从左往右，如果当前字符为空，而且没有结束</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>inbuf<span class="token punctuation">[</span>begin<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">' '</span> <span class="token operator">&amp;&amp;</span> inbuf<span class="token punctuation">[</span>begin<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		begin<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">//往右移动</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//从右往左，如果当前字符为空</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>inbuf<span class="token punctuation">[</span>end<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">' '</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		end<span class="token operator">--</span><span class="token punctuation">;</span> <span class="token comment">//往左移动</span>
	<span class="token punctuation">&#125;</span>

	n <span class="token operator">=</span> end <span class="token operator">-</span> begin <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//非空元素个数</span>

	<span class="token function">strncpy</span><span class="token punctuation">(</span>outbuf<span class="token punctuation">,</span> inbuf <span class="token operator">+</span> begin<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	outbuf<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//因为strncpy()不会自动添加'\0'，所以需要人为添加</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token string">"   abcdefgdddd    "</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	ret <span class="token operator">=</span> <span class="token function">trimSpace</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"trimSpace err: %d\n"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"buf:%s\n"</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<blockquote>
<p>要求写一个函数实现如下功能：</p>
<p>功能1：把偶数位字符挑选出来，组成一个字符串1。</p>
<p>功能2：把奇数位字符挑选出来，组成一个字符串2。</p>
<p>功能3：把字符串1和字符串2，通过函数参数，传送给main，并打印。</p>
<p>功能4：主函数能测试通过。</p>
</blockquote>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">getStr1Str2</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>source<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>buf1<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>buf2<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token keyword">int</span> <span class="token function">getstr1str2</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span> source<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>buf1<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>buf2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token keyword">int</span> cnt<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>source<span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> <span class="token operator">*</span> p<span class="token operator">=</span>source<span class="token punctuation">;</span>
<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token operator">!=</span><span class="token char">'\0'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
cnt<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>cnt<span class="token operator">%</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token operator">*</span>buf1<span class="token operator">++</span><span class="token operator">=</span><span class="token operator">*</span>p<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
<span class="token operator">*</span>buf2<span class="token operator">++</span><span class="token operator">=</span><span class="token operator">*</span>p<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token operator">*</span>buf1<span class="token operator">=</span><span class="token char">'\0'</span><span class="token punctuation">;</span>
<span class="token operator">*</span>buf2<span class="token operator">=</span><span class="token char">'\0'</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token keyword">char</span> nullc<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> testc<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"fsadfweeuwru"</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> <span class="token operator">*</span>buf1<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> <span class="token operator">*</span>buf2<span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"char is null  value is %d\n"</span><span class="token punctuation">,</span><span class="token function">getstr1str2</span><span class="token punctuation">(</span>nullc<span class="token punctuation">,</span>buf1<span class="token punctuation">,</span>buf2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">getstr1str2</span><span class="token punctuation">(</span>testc<span class="token punctuation">,</span>buf1<span class="token punctuation">,</span>buf2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"buf1 is %s  buf2 is %s"</span><span class="token punctuation">,</span>buf1<span class="token punctuation">,</span>buf2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">free</span><span class="token punctuation">(</span>buf1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">free</span><span class="token punctuation">(</span>buf2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>要求1：请自己定义一个接口，实现根据key获取.</p>
<p>要求2：编写测试用例。</p>
<p>要求3：键值对中间可能有n多空格，请去除空格</p>
<p>格式如下：</p>
<p>“key1 = value1”</p>
<p>“key2 =    value2”</p>
<p>“key3 = value3”</p>
<p>“key4    = value4”</p>
<p>“key5  =  “</p>
<p>“key6  =”</p>
<p>int getKeyByValue(char *keyvaluebuf, char *keybuf, char *valuebuf, int * valuebuflen);</p>
<p>int main(void)</p>
<p>{</p>
<p>//…</p>
<p>getKeyByValude(“key1 = valude1”, “key1”, buf, &amp;len);</p>
<p>//…</p>
<p>return 0;</p>
<p>}</p>
</blockquote>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/*
功能：获取非空字符串
参数：
	inbuf： 原始字符串buf首地址
	outbuf：非空字符串buf首地址
返回值：
	成功：0
	失败：非0
*/</span>
<span class="token keyword">int</span> <span class="token function">trimSpace</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>inbuf<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>outbuf<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>inbuf <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> outbuf <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">int</span> begin <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//字符串第一个元素位置</span>
	<span class="token keyword">int</span> end <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>inbuf<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//字符串最后一个元素位置</span>
	<span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>end <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">//出错处理</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//从左往右，如果当前字符为空，而且没有结束</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>inbuf<span class="token punctuation">[</span>begin<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">' '</span> <span class="token operator">&amp;&amp;</span> inbuf<span class="token punctuation">[</span>begin<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		begin<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">//往右移动</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//从右往左，如果当前字符为空</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>inbuf<span class="token punctuation">[</span>end<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token char">' '</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		end<span class="token operator">--</span><span class="token punctuation">;</span> <span class="token comment">//往左移动</span>
	<span class="token punctuation">&#125;</span>

	n <span class="token operator">=</span> end <span class="token operator">-</span> begin <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//非空元素个数</span>

	<span class="token function">strncpy</span><span class="token punctuation">(</span>outbuf<span class="token punctuation">,</span> inbuf <span class="token operator">+</span> begin<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	outbuf<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//因为strncpy()不会自动添加'\0'，所以需要人为添加</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">/*
功能：
	键值对（“key = value”）字符串根据键key查找对应的值value
参数：
	keyval：键值对（“key = value”）字符串
	pkey：键
	buf：匹配键所对应的内容
	len：匹配键所对应内容的长度
返回值：
	成功：0
	失败：非0
*/</span>
<span class="token keyword">int</span> <span class="token function">getKeyByValue</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>keyval<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>pkey<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>len<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>keyval <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> pkey <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> buf <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> len <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//辅助变量把形参接过来</span>
	<span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> keyval<span class="token punctuation">;</span> <span class="token comment">//"key1 =    valude1"</span>

	<span class="token comment">//查看key是否在母串</span>
	<span class="token comment">//查找 key1 是否在 "key1 =    valude1"</span>
	p <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> pkey<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> p<span class="token punctuation">)</span> <span class="token comment">//没有匹配键</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//重新设置起点位置，字符串跳过key值</span>
	<span class="token comment">//"key1 =    valude1" -> " =    valude1"</span>
	p <span class="token operator">=</span> p <span class="token operator">+</span> <span class="token function">strlen</span><span class="token punctuation">(</span>pkey<span class="token punctuation">)</span><span class="token punctuation">;</span> 

	<span class="token comment">//查找是否包含=号</span>
	p <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token string">"="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> p<span class="token punctuation">)</span><span class="token comment">//没有</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//字符串跳过"="</span>
	<span class="token comment">//" =    valude1" -> "    valude1"</span>
	p <span class="token operator">=</span> p <span class="token operator">+</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//获取非空字符串</span>
	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token function">trimSpace</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//通过*操作符操作内存</span>
	<span class="token comment">//间接赋值</span>
	<span class="token operator">*</span>len <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">char</span> keyval<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"key1 =    valude1"</span><span class="token punctuation">;</span> <span class="token comment">//键值对字符串</span>
	<span class="token keyword">char</span> <span class="token operator">*</span>pkey <span class="token operator">=</span> <span class="token string">"key1"</span><span class="token punctuation">;</span> <span class="token comment">//键值</span>
	<span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token function">getKeyByValue</span><span class="token punctuation">(</span>keyval<span class="token punctuation">,</span> pkey<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token operator">&amp;</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"getKeyByValue: %d\n"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"value: %s\nlen = %d\n"</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="二级指针"><a href="#二级指针" class="headerlink" title="二级指针"></a>二级指针</h3><h4 id="二级指针基本概念"><a href="#二级指针基本概念" class="headerlink" title="二级指针基本概念"></a>二级指针基本概念</h4><ul>
<li>如果一个指针变量存放的又是另一个指针变量的地址,则称这个指针变量为指向指针的指针 变量。也称为“二级指针”。</li>
<li>通过指针访问变量称为间接访问。由于指针变量直接指向变量,所以称为“一级指针”。而如果通过指向指针的指针变量来访问变量则构成“二级指针”。 </li>
<li><img src="http://qiniu.orangew.cn/img/wpsA271.tmp.jpg" alt="img"></li>
</ul>
<h5 id="二级指针输出特性"><a href="#二级指针输出特性" class="headerlink" title="二级指针输出特性"></a>二级指针输出特性</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">getMem</span><span class="token punctuation">(</span><span class="token comment">/*out*/</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>myp1<span class="token punctuation">,</span> <span class="token comment">/*out*/</span><span class="token keyword">int</span> <span class="token operator">*</span>mylen1<span class="token punctuation">,</span> 
		 <span class="token comment">/*out*/</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>myp2<span class="token punctuation">,</span> <span class="token comment">/*out*/</span><span class="token keyword">int</span> <span class="token operator">*</span>mylen2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">getMem_Free</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>myp1<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="二级指针输入特性"><a href="#二级指针输入特性" class="headerlink" title="二级指针输入特性"></a>二级指针输入特性</h5><ul>
<li>第一种输入模型：指针数组</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span>myArray<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"aaaaaa"</span><span class="token punctuation">,</span> <span class="token string">"ccccc"</span><span class="token punctuation">,</span> <span class="token string">"bbbbbb"</span><span class="token punctuation">,</span> <span class="token string">"111111"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">printMyArray</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>myArray<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">sortMyArray</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>myArray<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>第二种输入模型：二维数组</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> myArray<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"aaaaaa"</span><span class="token punctuation">,</span> <span class="token string">"ccccc"</span><span class="token punctuation">,</span> <span class="token string">"bbbbbbb"</span><span class="token punctuation">,</span> <span class="token string">"1111111111111"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">printMyArray</span><span class="token punctuation">(</span><span class="token keyword">char</span> myArray<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">sortMyArray</span><span class="token punctuation">(</span><span class="token keyword">char</span> myArray<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>第三种输入模型：手工二维内存</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>myArray <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

<span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token function">getMem</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">printMyArray</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>myArray<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">sortMyArray</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>myArray<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">arrayFree</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>myArray<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">//指针数组</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>p1<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"123"</span><span class="token punctuation">,</span> <span class="token string">"456"</span><span class="token punctuation">,</span> <span class="token string">"789"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">//二维数组</span>
    <span class="token keyword">char</span> p2<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"123"</span><span class="token punctuation">,</span> <span class="token string">"456"</span><span class="token punctuation">,</span> <span class="token string">"789"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    <span class="token comment">//手工二维内存</span>
    <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>p3 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//char *array[3];</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        p3<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//char buf[10]</span>

        <span class="token function">sprintf</span><span class="token punctuation">(</span>p3<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"%d%d%d"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> i<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="多级指针"><a href="#多级指针" class="headerlink" title="多级指针"></a>多级指针</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token comment">//在函数里面分配内存并赋值</span>
<span class="token comment">//char ***p是二维字符串数组的地址</span>
<span class="token comment">//num是字符串数组中字符串的个数</span>
<span class="token keyword">int</span> <span class="token function">getMem</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>p <span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>tmp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token comment">//二维字符串数组地址不存在</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
	<span class="token comment">//给临时二维字符串数组分配内存</span>
    tmp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">*</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//内存分配失败</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tmp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
	<span class="token comment">//给每一个字符串分配内存</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>  <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//sprintf函数将格式化输入到字符串中</span>
        <span class="token function">sprintf</span><span class="token punctuation">(</span>tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"%d%d%d"</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">//将指针p指向临时字符串</span>
    <span class="token operator">*</span>p <span class="token operator">=</span> tmp<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//释放内存</span>
<span class="token keyword">void</span> <span class="token function">memFree</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>p <span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>tmp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token comment">//判断二维字符串的地址是否为空</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    tmp <span class="token operator">=</span> <span class="token operator">*</span>p<span class="token punctuation">;</span>
	<span class="token comment">//释放每一个字符串</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">free</span><span class="token punctuation">(</span>tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">free</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//将指针指向空</span>
    <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token comment">//把实参赋值成null</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>array <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>

    <span class="token function">getMem</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>array<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s \n"</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">memFree</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>array<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="作业"><a href="#作业" class="headerlink" title="作业"></a>作业</h5><blockquote>
<p>有字符串有以下特征（“abcd11111abcd2222abcdqqqqq”）,求写一个函数接口，输出以下结果。</p>
<p>把字符串替换成（dcba11111dcba2222dcbaqqqqq），并把结果传出。</p>
<p>要求：</p>
<p>​    1. 正确实现接口和功能</p>
<p>​    2. 编写测试用例</p>
<p>/*</p>
<p>src:  原字符串</p>
<p>dst:  生成的或需要填充的字符串</p>
<p>sub:  需要查找的子字符串</p>
<p>new_sub:提换的新子字符串</p>
<p>return : 0 成功</p>
<p>​    -1 失败</p>
<p> */</p>
<p>int replaceSubstr(/* in <em>/char <em>src, /</em> out <em>/char</em></em> dst, </p>
<p>​         /* in */char <em>sub, /</em> in */char *new_sub);</p>
<p>有一个字符串符合以下特征（“abcdef,acccd,eeee,aaaa,e3eeee,ssss,”）</p>
<p>写两个函数(API)，输出以下结果</p>
<p>第一个API(第二种内存模型)</p>
<p>1)以逗号分隔字符串，形成二维数组，并把结果传出</p>
<p>2)把二维数组行数运算结果也传出</p>
<p>int spitString(const char *str, char c, char buf[10] [30], int *count);</p>
<p>第二个API(第三种内存模型)</p>
<p>1)以逗号分隔字符串，形成一个二级指针。</p>
<p>2)把一共拆分多少行字符串个数传出</p>
<p>int spitString2(const char *str, char c, char ** myp / * in */, int *count);</p>
<p>要求：</p>
<p>1, 能正确表达功能的要求，定义出接口。</p>
<p>2, 正确实现接口和功能.</p>
<p>3, 编写正确的测试用例.</p>
</blockquote>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//第一个作业</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token comment">/*
src:    原字符串
dst:    生成的或需要填充的字符串
sub:    需要查找的子字符串
new_sub:提换的新子字符串

return : 0 成功
-1 失败
*/</span>
<span class="token keyword">int</span> <span class="token function">replaceSubstr</span><span class="token punctuation">(</span><span class="token comment">/* in */</span><span class="token keyword">char</span> <span class="token operator">*</span>src<span class="token punctuation">,</span> <span class="token comment">/* out */</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">*</span> dst<span class="token punctuation">,</span>
	<span class="token comment">/* in */</span><span class="token keyword">char</span> <span class="token operator">*</span>sub<span class="token punctuation">,</span>  <span class="token comment">/* in */</span><span class="token keyword">char</span> <span class="token operator">*</span>new_sub<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token comment">// src = "22abcd11111abcd2222abcdqqqqq"</span>
	<span class="token comment">// dst = "22dcba11111dcba2222dcbaqqqqq"</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>src <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> dst <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> sub <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> new_sub <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">char</span> tmp<span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">//临时变量, 字符数组</span>

	<span class="token keyword">char</span> <span class="token operator">*</span>start <span class="token operator">=</span> src<span class="token punctuation">;</span> <span class="token comment">//记录查找的起点</span>
	<span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>	<span class="token comment">//匹配字符串的首地址</span>

	<span class="token keyword">do</span> 
	<span class="token punctuation">&#123;</span>
		<span class="token comment">// src = "22abcd11111abcd2222abcdqqqqq"</span>
		p <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">int</span> len <span class="token operator">=</span> p <span class="token operator">-</span> start<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
			<span class="token punctuation">&#123;</span>
				<span class="token comment">//把匹配字符串前面的内容连接过去</span>
				<span class="token function">strncat</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> start<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>

			<span class="token function">strncat</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> new_sub<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>new_sub<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//追加替换的新串</span>

			<span class="token comment">//更改查找的起点位置</span>
			start <span class="token operator">=</span> p <span class="token operator">+</span> <span class="token function">strlen</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">&#123;</span>
			<span class="token function">strcat</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> start<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

	<span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>start <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">char</span> <span class="token operator">*</span>buf <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">strcpy</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>dst <span class="token operator">=</span> buf<span class="token punctuation">;</span>
	
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token string">"abcd11111abcd2222abcdqqqqq"</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> <span class="token operator">*</span>buf <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	ret <span class="token operator">=</span> <span class="token function">replaceSubstr</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> <span class="token string">"abcd"</span><span class="token punctuation">,</span> <span class="token string">"12345"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"replaceSubstr err:　%d\n"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"buf = %s\n"</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>


	<span class="token keyword">if</span> <span class="token punctuation">(</span>buf <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">free</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
		buf <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token keyword">int</span> <span class="token function">spitString</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">char</span> c<span class="token punctuation">,</span> <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>count<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> count <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">char</span> <span class="token operator">*</span>start <span class="token operator">=</span> str<span class="token punctuation">;</span>
	<span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//第几行</span>

	<span class="token keyword">do</span> 
	<span class="token punctuation">&#123;</span>
		<span class="token comment">//"abcdef,acccd,eeee,aaaa,e3eeee,ssss,"</span>
		p <span class="token operator">=</span> <span class="token function">strchr</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">int</span> len <span class="token operator">=</span> p <span class="token operator">-</span> start<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
			<span class="token punctuation">&#123;</span>
				<span class="token function">strncpy</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> start<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token comment">//添加结束符</span>
				buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>len<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>

				i<span class="token operator">++</span><span class="token punctuation">;</span> 
			<span class="token punctuation">&#125;</span>
			start <span class="token operator">=</span> p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>


	<span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>start <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token operator">*</span>count <span class="token operator">=</span> i<span class="token punctuation">;</span> <span class="token comment">//有多少行字符串</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span> <span class="token function">getMem</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>p <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span>n <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//char *p[]</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//每个元素的空间</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		p<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">30</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//char a[30]</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">return</span> p<span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">getMemFree</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>buf<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>buf <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>tmp <span class="token operator">=</span> <span class="token operator">*</span>buf<span class="token punctuation">;</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token function">free</span><span class="token punctuation">(</span>tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token function">free</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>buf <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">spitString2</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">,</span> <span class="token keyword">char</span> c<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>buf<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>count<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> count <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">char</span> <span class="token operator">*</span>start <span class="token operator">=</span> str<span class="token punctuation">;</span>
	<span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//第几行</span>

	<span class="token keyword">do</span>
	<span class="token punctuation">&#123;</span>
		<span class="token comment">//"abcdef,acccd,eeee,aaaa,e3eeee,ssss,"</span>
		p <span class="token operator">=</span> <span class="token function">strchr</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">int</span> len <span class="token operator">=</span> p <span class="token operator">-</span> start<span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>len <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
			<span class="token punctuation">&#123;</span>
				<span class="token function">strncpy</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> start<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token comment">//添加结束符</span>
				buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>len<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token char">'\0'</span><span class="token punctuation">;</span>

				i<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
			start <span class="token operator">=</span> p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>


	<span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">*</span>start <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token operator">*</span>count <span class="token operator">=</span> i<span class="token punctuation">;</span> <span class="token comment">//有多少行字符串</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token number">0</span></span></span>
	<span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token string">"abcdef,acccd,eeee,aaaa,e3eeee,ssss,"</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	ret <span class="token operator">=</span> <span class="token function">spitString</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token char">','</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

	<span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token string">"abcdef,acccd,eeee,aaaa,e3eeee,ssss,"</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>buf <span class="token operator">=</span> <span class="token function">getMem</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//动态打造二维数组</span>
	<span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	ret <span class="token operator">=</span> <span class="token function">spitString2</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token char">','</span><span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token operator">&amp;</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token function">getMemFree</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>buf<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="多维数组"><a href="#多维数组" class="headerlink" title="多维数组"></a>多维数组</h3><h4 id="数组的基本概念"><a href="#数组的基本概念" class="headerlink" title="数组的基本概念"></a>数组的基本概念</h4><h5 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h5><ul>
<li>元素类型角度：数组是相同类型的变量的有序集合</li>
<li>内存角度：连续的一大片内存空间</li>
</ul>
<h5 id="二维数组"><a href="#二维数组" class="headerlink" title="二维数组"></a>二维数组</h5><ul>
<li>所谓多维数组就是二维和大于二维的数组,在C语言中并不直接支持多维数组,包括二维数 组。多维数组的声明是使用一维数组的嵌套声明实现的。一个一维数组的每个元素又被声明为一 维数组,从而构成二维数组,可以说二维数组是特殊的一维数组。</li>
<li>二维数组定义的一般形式是:</li>
<li>类型说明符 数组名[常量表达式1] [常量表达式2] </li>
</ul>
<h5 id="数组名"><a href="#数组名" class="headerlink" title="数组名"></a>数组名</h5><ul>
<li>数组首元素的地址和数组地址是两个不同的概念</li>
<li>数组名代表数组首元素的地址，它是个常量。 </li>
<li>变量本质是内存空间的别名，一定义数组，就分配内存，内存就固定了。所以数组名起名以后就不能被修改了。</li>
<li>数组首元素的地址和数组的地址值相等。</li>
</ul>
<h4 id="数组类型"><a href="#数组类型" class="headerlink" title="数组类型"></a>数组类型</h4><ul>
<li>数组的类型由元素类型和数组大小共同决定</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token comment">/*
   typedef int(MYINT5)[5];   
   typedef float(MYFLOAT10)[10];

   数组定义：

   MYINT5       iArray;  等价于 int iArray[5];
   MYFLOAT10    fArray;  等价于 float fArray[10];
 */</span>

<span class="token comment">/*定义 数组类型，并用数组类型定义变量*/</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">typedef</span> <span class="token keyword">int</span><span class="token punctuation">(</span>MYINT5<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    MYINT5 array<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> 
    <span class="token punctuation">&#123;</span>                       
        array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>                   
    <span class="token punctuation">&#125;</span>                                       
                     
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> 
    <span class="token punctuation">&#123;</span>                           
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            
    <span class="token punctuation">&#125;</span>                                           
                         
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>                   
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="数组指针和指针数组"><a href="#数组指针和指针数组" class="headerlink" title="数组指针和指针数组"></a>数组指针和指针数组</h4><h5 id="指针数组"><a href="#指针数组" class="headerlink" title="指针数组"></a>指针数组</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span>point_array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>point_array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>指针数组，是一个数组, 里面的每一个元素都是一个指针。（多个指针）</li>
<li>每个指针可以指向不同的数据块</li>
</ul>
<h5 id="数组指针"><a href="#数组指针" class="headerlink" title="数组指针"></a>数组指针</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>array_point<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>是一个指针，指向一个数组。（一个指针）</li>
<li>指针本是一种类型，但又说什么类型的指针，只不过是说指针所指向的数据是什么类型而已。那么指向数组类型的指针，就只好叫数组指针。</li>
</ul>
<h5 id="定义数组指针"><a href="#定义数组指针" class="headerlink" title="定义数组指针"></a>定义数组指针</h5><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//a的类型是一个指向int类型的指针。</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>数组名a是数组首元素的起始地址，但并不是数组的起始地址。</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token operator">&amp;</span>a<span class="token punctuation">;</span>         <span class="token comment">//&amp;a的类型是一个指向数组int[10]类型的指针。</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>通过将取地址符&amp;作用于数组名可以得到整个数组的起始地址。</li>
<li>通过数组类型定义数组指针: </li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">int</span><span class="token punctuation">(</span>ArrayType<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//定义类型ArrayType 为int[5]类型</span>

ArrayType<span class="token operator">*</span> pointer<span class="token punctuation">;</span>         <span class="token comment">//那么指向ArrayType的指针就是指向int[5]类型的指针</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li>通过数组指针定义数组指针</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>MyPointer<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//定义类型MyPointer 为指向int[5]类型的指针</span>

MyPointer myPoint<span class="token punctuation">;</span>          <span class="token comment">//那么用这种类型的指针定义的便都是指向int[5]类型的</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li>直接定义</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>pointer<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="多维数组名的本质"><a href="#多维数组名的本质" class="headerlink" title="多维数组名的本质"></a>多维数组名的本质</h4><p><img src="http://qiniu.orangew.cn/img/wps8B37.tmp.jpg" alt="img"></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">// a 多维数组名 代表？</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"a %d , a+1:%d "</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">//a+1的步长 是20个字节 5*4</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"&amp;a %d , &amp;a+1:%d "</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//&amp;+1的步长 是5*4*3 = 60</span>

    <span class="token comment">//多维数组名的本质就是一个指向第一个维度的数组的指针</span>
    <span class="token comment">//步长为第一个维度的数据类型大小</span>

    <span class="token comment">//定义一个指向数组的指针变量 </span>
<span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>pArray<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>      <span class="token comment">//告诉编译器  分配 4个字节的内存 32bit平台下</span>
pArray <span class="token operator">=</span> a<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> pArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
                                                     
    <span class="token comment">// (a+i)                代表是整个第i行的地址  二级指针</span>
    <span class="token comment">// *(a+i)               代表 1级指针  第i行首元素的地址</span>
    <span class="token comment">// *(a+i) + j  ===> &amp;  (a[i][j])</span>
    <span class="token comment">//*( *(a+i) + j) ===>   a[i][j]元素的值</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="多维数组的参数退化"><a href="#多维数组的参数退化" class="headerlink" title="多维数组的参数退化"></a>多维数组的参数退化</h3><h4 id="多维数组的线性存储特性"><a href="#多维数组的线性存储特性" class="headerlink" title="多维数组的线性存储特性"></a>多维数组的线性存储特性</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">void</span> <span class="token function">printfArray</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>array<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span>  i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> tmp <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token comment">//把二维数组 当成  1维数组 来打印 证明线性存储</span>
    <span class="token function">printfArray</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span>a<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="http://qiniu.orangew.cn/img/20220702201301.png" alt="20220702201301"></p>
<h4 id="多维数组的3种形式参数"><a href="#多维数组的3种形式参数" class="headerlink" title="多维数组的3种形式参数"></a>多维数组的3种形式参数</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">void</span> <span class="token function">printArray01</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">printArray02</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">printArray03</span><span class="token punctuation">(</span> <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>b<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d "</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> tmp <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span><span class="token number">5</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">printArray03</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="形参退化成指针的原因"><a href="#形参退化成指针的原因" class="headerlink" title="形参退化成指针的原因"></a>形参退化成指针的原因</h4><ul>
<li>原因1：高效</li>
<li>原因2：C语言处理a[n]的时候，它没有办法知道n是几，它只知道&amp;n[0]是多少，它的值作为参数传递进去了，虽然c语言可以做到直接int fun(char a[20])，然后函数能得到20这个数字，但是，C没有这么做。 </li>
</ul>
<h3 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h3><h4 id="结构体的类型和定义"><a href="#结构体的类型和定义" class="headerlink" title="结构体的类型和定义"></a>结构体的类型和定义</h4><ul>
<li>结构体是一种构造数据类型。</li>
<li>用途：把不同类型的数据组合成一个整体——-自定义数据类型</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token comment">//声明一个结构体类型</span>
<span class="token keyword">struct</span> <span class="token class-name">_Teacher</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span>    name<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span>    tile<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span>     age<span class="token punctuation">;</span>
    <span class="token keyword">char</span>    addr<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//定义结构体变量的方法</span>
<span class="token comment">/*
   1)定义类型 用类型定义变量
   2)定义类型的同时，定义变量；
   3）直接定义结构体变量；
 */</span>

<span class="token keyword">struct</span> <span class="token class-name">_Student</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span>    name<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span>    tile<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span>     age<span class="token punctuation">;</span>
    <span class="token keyword">char</span>    addr<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">;</span>  <span class="token comment">//定义类型的同时，定义变量；</span>

<span class="token keyword">struct</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span>    name<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span>    tile<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span>     age<span class="token punctuation">;</span>
    <span class="token keyword">char</span>    addr<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>s3<span class="token punctuation">,</span>s4<span class="token punctuation">;</span> <span class="token comment">//直接定义结构体变量</span>

<span class="token comment">//初始化结构体变量的几种方法</span>
<span class="token comment">//1)</span>
<span class="token keyword">struct</span> <span class="token class-name">_Teacher</span> t4 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"name2"</span><span class="token punctuation">,</span> <span class="token string">"tile2"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"addr2"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token comment">//2)</span>
<span class="token keyword">struct</span> <span class="token class-name">Dog1</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span>    name<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span>    tile<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span>     age<span class="token punctuation">;</span>
    <span class="token keyword">char</span>    addr<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>d5 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"dog"</span><span class="token punctuation">,</span> <span class="token string">"gongzhu"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"ddd"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//3)</span>
<span class="token keyword">struct</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span>    name<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span>    tile<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span>     age<span class="token punctuation">;</span>
    <span class="token keyword">char</span>    addr<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>d6 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"dog"</span><span class="token punctuation">,</span> <span class="token string">"gongzhu"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"ddd"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token comment">//结构体变量的引用</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token comment">//struct _Teacher t1, t2;</span>
    <span class="token comment">//定义同时初始化</span>
    <span class="token keyword">struct</span> <span class="token class-name">_Teacher</span> t3 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"name2"</span><span class="token punctuation">,</span> <span class="token string">"tile2"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"addr2"</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> t3<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> t3<span class="token punctuation">.</span>tile<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//用指针法和变量法分别操作结构体</span>
    <span class="token keyword">struct</span> <span class="token class-name">_Teacher</span> t4<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">_Teacher</span> <span class="token operator">*</span>pTeacher <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    pTeacher <span class="token operator">=</span> <span class="token operator">&amp;</span>t4<span class="token punctuation">;</span>

    <span class="token function">strcpy</span><span class="token punctuation">(</span>t4<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">"zhangsan"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">strcpy</span><span class="token punctuation">(</span>pTeacher<span class="token operator">-></span>addr<span class="token punctuation">,</span> <span class="token string">"ddddd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"t4.name:%s\n"</span><span class="token punctuation">,</span> t4<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="结构体的赋值"><a href="#结构体的赋值" class="headerlink" title="结构体的赋值"></a>结构体的赋值</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token comment">//声明一个结构体类型</span>
<span class="token keyword">struct</span> <span class="token class-name">_Mytercher</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span>    name<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span>    title<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span>     age<span class="token punctuation">;</span>
    <span class="token keyword">char</span>    addr<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_Mytercher</span> <span class="token class-name">teacher_t</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">show_teacher</span><span class="token punctuation">(</span><span class="token class-name">teacher_t</span> t<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"name : %s\n"</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"title : %s\n"</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"age : %d\n"</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"addr : %s\n"</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span>  <span class="token function">copyTeacher</span><span class="token punctuation">(</span><span class="token class-name">teacher_t</span> to<span class="token punctuation">,</span> <span class="token class-name">teacher_t</span> from <span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    to <span class="token operator">=</span> from<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span>  <span class="token function">copyTeacher2</span><span class="token punctuation">(</span><span class="token class-name">teacher_t</span> <span class="token operator">*</span>to<span class="token punctuation">,</span> <span class="token class-name">teacher_t</span> <span class="token operator">*</span>from <span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token operator">*</span>to <span class="token operator">=</span> <span class="token operator">*</span>from<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//结构体赋值和实参形参赋值行为研究</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token class-name">teacher_t</span> t1<span class="token punctuation">,</span> t2<span class="token punctuation">,</span> t3<span class="token punctuation">;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>t1<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">strcpy</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">strcpy</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>addr<span class="token punctuation">,</span> <span class="token string">"addr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">strcpy</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>title<span class="token punctuation">,</span> <span class="token string">"title"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t1<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token function">show_teacher</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//结构体直接赋值</span>
    t2 <span class="token operator">=</span> t1<span class="token punctuation">;</span>
    <span class="token function">show_teacher</span><span class="token punctuation">(</span>t2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">copyTeacher</span><span class="token punctuation">(</span>t3<span class="token punctuation">,</span> t2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">show_teacher</span><span class="token punctuation">(</span>t3<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">copyTeacher2</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>t3<span class="token punctuation">,</span> <span class="token operator">&amp;</span>t2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">show_teacher</span><span class="token punctuation">(</span>t3<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="结构体数组"><a href="#结构体数组" class="headerlink" title="结构体数组"></a>结构体数组</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token comment">//声明一个结构体类型</span>
<span class="token keyword">struct</span> <span class="token class-name">_Mytercher</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span>    name<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span>    title<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span>     age<span class="token punctuation">;</span>
    <span class="token keyword">char</span>    addr<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">_Mytercher</span> <span class="token class-name">teacher_t</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">show_teacher</span><span class="token punctuation">(</span><span class="token class-name">teacher_t</span> t<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"name : %s\n"</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"title : %s\n"</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"age : %d\n"</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"addr : %s\n"</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//定义结构体数组</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">_Mytercher</span> teaArray<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">strcpy</span><span class="token punctuation">(</span>teaArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        teaArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>age <span class="token operator">=</span> i<span class="token operator">+</span><span class="token number">20</span><span class="token punctuation">;</span>
        <span class="token function">strcpy</span><span class="token punctuation">(</span>teaArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span> <span class="token string">"title"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">strcpy</span><span class="token punctuation">(</span>teaArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>addr<span class="token punctuation">,</span> <span class="token string">"addr"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">show_teacher</span><span class="token punctuation">(</span>teaArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="结构体作为函数参数"><a href="#结构体作为函数参数" class="headerlink" title="结构体作为函数参数"></a>结构体作为函数参数</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Teacher</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>alisname<span class="token punctuation">;</span>
    <span class="token keyword">int</span> age <span class="token punctuation">;</span>
    <span class="token keyword">int</span> id<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Teacher<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">printTeacher</span><span class="token punctuation">(</span>Teacher <span class="token operator">*</span>array<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n================\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"name : %s\n"</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"alisname : %s\n"</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>alisname<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"age:%d \n"</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">sortTeacer</span><span class="token punctuation">(</span>Teacher <span class="token operator">*</span>array<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span>     i<span class="token punctuation">,</span>j<span class="token punctuation">;</span>
    Teacher tmp<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>num<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>age <span class="token operator">></span> array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                tmp <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//=号操作  赋值操作</span>
                array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                array<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

Teacher <span class="token operator">*</span> <span class="token function">createTeacher01</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    Teacher <span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    tmp <span class="token operator">=</span> <span class="token punctuation">(</span>Teacher <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Teacher<span class="token punctuation">)</span> <span class="token operator">*</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  Teacher     Array[3]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tmp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> tmp<span class="token punctuation">;</span> <span class="token comment">//</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">createTeacher02</span><span class="token punctuation">(</span>Teacher <span class="token operator">*</span><span class="token operator">*</span>pT<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    Teacher <span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    tmp <span class="token operator">=</span> <span class="token punctuation">(</span>Teacher <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Teacher<span class="token punctuation">)</span> <span class="token operator">*</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  Teacher     Array[3]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tmp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Teacher<span class="token punctuation">)</span> <span class="token operator">*</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>alisname <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token operator">*</span>pT <span class="token operator">=</span> tmp<span class="token punctuation">;</span>  <span class="token comment">//二级指针 形参 去间接的修改 实参 的值 </span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">FreeTeacher</span><span class="token punctuation">(</span>Teacher <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>alisname <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token function">free</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>alisname<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">free</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span>         ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span>         i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span>         num <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

    Teacher <span class="token operator">*</span>pArray <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

    ret <span class="token operator">=</span> <span class="token function">createTeacher02</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pArray<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"func createTeacher02() er:%d \n "</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nplease enter age:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>pArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nplease enter name:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span>  pArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//向指针所指的内存空间copy数据</span>

        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nplease enter alias:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span>  pArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>alisname <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//向指针所指的内存空间copy数据</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">printTeacher</span><span class="token punctuation">(</span>pArray<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">sortTeacer</span><span class="token punctuation">(</span>pArray<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"排序之后\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printTeacher</span><span class="token punctuation">(</span>pArray<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">FreeTeacher</span><span class="token punctuation">(</span>pArray<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="结构体嵌套指针"><a href="#结构体嵌套指针" class="headerlink" title="结构体嵌套指针"></a>结构体嵌套指针</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Teacher</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>name<span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>student_name<span class="token punctuation">;</span>
    <span class="token keyword">int</span> stu_num<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Teacher<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">printTeacher</span><span class="token punctuation">(</span>Teacher <span class="token operator">*</span>array<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n-------------------\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"teacher'name:%s\n"</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"id:%d \n"</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"student's count:%d\n"</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stu_num<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stu_num<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\tstudent[%d]:%s\n"</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>student_name<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">sortTeacer</span><span class="token punctuation">(</span>Teacher <span class="token operator">*</span>array<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span>     i<span class="token punctuation">,</span>j<span class="token punctuation">;</span>
    Teacher tmp<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>num<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id <span class="token operator">></span> array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                tmp <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//=号操作  赋值操作</span>
                array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                array<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">createStudents</span><span class="token punctuation">(</span>Teacher <span class="token operator">*</span>t<span class="token punctuation">,</span> <span class="token keyword">int</span> stunum<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">//二级指针的第三种内存模型</span>
    p <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>stunum <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//打造二维内存</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>stunum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        p<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    t<span class="token operator">-></span>student_name <span class="token operator">=</span> p<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">createTeacher02</span><span class="token punctuation">(</span>Teacher <span class="token operator">*</span><span class="token operator">*</span>pT<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    Teacher <span class="token operator">*</span> tmp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

    tmp <span class="token operator">=</span> <span class="token punctuation">(</span>Teacher <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Teacher<span class="token punctuation">)</span> <span class="token operator">*</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tmp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">memset</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Teacher<span class="token punctuation">)</span> <span class="token operator">*</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>

        <span class="token comment">//malloc一级指针</span>
        tmp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">&#125;</span>

    <span class="token operator">*</span>pT <span class="token operator">=</span> tmp<span class="token punctuation">;</span>  <span class="token comment">//二级指针 形参 去间接的修改 实参 的值 </span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">FreeTeacher</span><span class="token punctuation">(</span>Teacher <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token comment">//释放一级指针</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token function">free</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">//释放二级指针</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>student_name <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>myp <span class="token operator">=</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>student_name <span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stu_num<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>myp<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
                <span class="token punctuation">&#123;</span>
                    <span class="token function">free</span><span class="token punctuation">(</span>myp<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token function">free</span><span class="token punctuation">(</span>myp<span class="token punctuation">)</span><span class="token punctuation">;</span>
            p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>student_name <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">free</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span>         ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span>         i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span>         num <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    Teacher <span class="token operator">*</span>pArray <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

    ret <span class="token operator">=</span> <span class="token function">createTeacher02</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pArray<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"func createTeacher02() er:%d \n "</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nplease enter id:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>pArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nplease enter name:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span>  pArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\nplease enter student number:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span>  <span class="token operator">&amp;</span><span class="token punctuation">(</span>pArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stu_num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//之所以在这开辟学生名称的内存 是因为在这里才知道这个老师</span>
        <span class="token comment">//对应的学生数目</span>
        <span class="token function">createStudents</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> pArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stu_num<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>pArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stu_num<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"please enter student name:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span>pArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>student_name<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">printTeacher</span><span class="token punctuation">(</span>pArray<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">sortTeacer</span><span class="token punctuation">(</span>pArray<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"排序之后\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printTeacher</span><span class="token punctuation">(</span>pArray<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">FreeTeacher</span><span class="token punctuation">(</span>pArray<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="有关浅拷贝深拷贝问题"><a href="#有关浅拷贝深拷贝问题" class="headerlink" title="有关浅拷贝深拷贝问题"></a>有关浅拷贝深拷贝问题</h4><p><img src="http://qiniu.orangew.cn/img/wpsCBF1.tmp.jpg" alt="img"> </p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Teacher</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> age <span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>pname2<span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span>Teacher_t<span class="token punctuation">;</span>
<span class="token comment">//结构体中套一个 1级指针 或 二级指针 </span>

<span class="token comment">//编译器的=号操作,只会把指针变量的值,从from  copy 到 to,但 </span>
<span class="token comment">//不会 把指针变量 所指 的 内存空间 给copy过去..//浅copy</span>

<span class="token comment">//如果 想执行深copy,再显示的分配内存</span>
<span class="token keyword">void</span> <span class="token function">deepCopyTeacher</span><span class="token punctuation">(</span>Teacher_t <span class="token operator">*</span>to<span class="token punctuation">,</span> Teacher_t <span class="token operator">*</span>from<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token operator">*</span>to <span class="token operator">=</span> <span class="token operator">*</span>from<span class="token punctuation">;</span>

    to<span class="token operator">-></span>pname2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">strcpy</span><span class="token punctuation">(</span>to<span class="token operator">-></span>pname2<span class="token punctuation">,</span> from<span class="token operator">-></span>pname2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//memcpy(to, from , sizeof(Teacher_t));</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//浅拷贝</span>
<span class="token keyword">void</span> <span class="token function">copyTeacher</span><span class="token punctuation">(</span>Teacher_t <span class="token operator">*</span>to<span class="token punctuation">,</span> Teacher_t <span class="token operator">*</span>from<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">memcpy</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> from <span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Teacher_t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// or</span>
    <span class="token comment">//*to = *from;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    Teacher_t t1<span class="token punctuation">;</span>
    Teacher_t t2<span class="token punctuation">;</span>
    <span class="token function">strcpy</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token string">"name1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    t1<span class="token punctuation">.</span>pname2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">strcpy</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>pname2<span class="token punctuation">,</span> <span class="token string">"ssss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//t1 copy t2</span>
    <span class="token function">deepCopyTeacher</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>t2<span class="token punctuation">,</span> <span class="token operator">&amp;</span>t1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>t1<span class="token punctuation">.</span>pname2 <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">free</span><span class="token punctuation">(</span>t1<span class="token punctuation">.</span>pname2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        t1<span class="token punctuation">.</span>pname2 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>t2<span class="token punctuation">.</span>pname2 <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">free</span><span class="token punctuation">(</span>t2<span class="token punctuation">.</span>pname2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        t2<span class="token punctuation">.</span>pname2 <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="结构体成员偏移量"><a href="#结构体成员偏移量" class="headerlink" title="结构体成员偏移量"></a>结构体成员偏移量</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token comment">//一旦结构体定义下来,则结构体中的成员..内存布局 就定下了</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Teacher</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//64</span>
    <span class="token keyword">int</span> age <span class="token punctuation">;</span>       <span class="token comment">//4</span>
    <span class="token keyword">int</span> p<span class="token punctuation">;</span>          <span class="token comment">//4</span>

<span class="token punctuation">&#125;</span> Teacher_t<span class="token punctuation">;</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    Teacher_t  t1<span class="token punctuation">;</span>
    Teacher_t <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    p <span class="token operator">=</span> <span class="token operator">&amp;</span>t1<span class="token punctuation">;</span>

    <span class="token keyword">int</span> offsize1 <span class="token operator">=</span>   <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>p<span class="token operator">-></span>age<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>p<span class="token punctuation">;</span> <span class="token comment">//age 相对于结构体 Teacher的偏移量</span>
    <span class="token keyword">int</span> offsize2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Teacher_t <span class="token operator">*</span><span class="token punctuation">)</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">-></span>age <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//绝对0地址 age的偏移量</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"offsize1:%d \n"</span><span class="token punctuation">,</span> offsize1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"offsize2:%d \n"</span><span class="token punctuation">,</span> offsize2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span> <span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="结构体字节对齐"><a href="#结构体字节对齐" class="headerlink" title="结构体字节对齐"></a>结构体字节对齐</h4><ul>
<li>在用sizeof运算符求算某结构体所占空间时，并不是简单地将结构体中所有元素各自占的空间相加，这里涉及到内存字节对齐的问题。</li>
<li>从理论上讲，对于任何变量的访问都可以从任何地址开始访问，但是事实上不是如此，实际上访问特定类型的变量只能在特定的地址访问，这就需要各个变量在空间上按一定的规则排列， 而不是简单地顺序排列，这就是内存对齐。</li>
</ul>
<h5 id="内存对齐的原因"><a href="#内存对齐的原因" class="headerlink" title="内存对齐的原因"></a>内存对齐的原因</h5><ul>
<li><p>某些平台只能在特定的地址处访问特定类型的数据。</p>
</li>
<li><p>提高存取数据的速度。比如有的平台每次都是从偶地址处读取数据，对于一个int型的变量，若从偶地址单元处存放，则只需一个读取周期即可读取该变量；但是若从奇地址单元处存放，则需要2个读取周期读取该变量。</p>
</li>
</ul>
<h5 id="内存对齐的原则"><a href="#内存对齐的原则" class="headerlink" title="内存对齐的原则"></a>内存对齐的原则</h5><ul>
<li><p>默认情况下，数据成员的对齐规则(以最大的类型字节为单位)。</p>
</li>
<li><p>当然，字节对齐可以通过程序控制，采用指令：</p>
</li>
<li><blockquote>
<p>#pragma pack(xx)  </p>
<p>#pragma pack(1)   //1字节对齐</p>
<p>#pragma pack(2)   //2字节对齐</p>
<p>#pragma pack(4)   //4字节对齐</p>
<p>#pragma pack(8)   //8字节对齐</p>
<p>#pragma pack(16)  //16字节对齐</p>
</blockquote>
</li>
</ul>
<h4 id="作业-1"><a href="#作业-1" class="headerlink" title="作业"></a>作业</h4><blockquote>
<ol>
<li>列出定义结构体变量的几种方法。</li>
</ol>
<ol start="2">
<li><p>同类型结构体变量是否可以相互赋值？会存在什么风险？</p>
</li>
<li><p>练习结构体数组排序　　<br> 从键盘输入3个学生的信息（姓名、学号、成绩），存入一个结构体数组中，计算平均分，并按成绩<br> 高低排序并输出<br> typedef struct Stu<br> {</p>
<pre><code> char name[50];
 int id;
 double score;
</code></pre>
<p> }Stu;</p>
<p> int main(void)<br> {</p>
<pre><code> Stu s[3];
 int n = 3;
</code></pre>
 <pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//从键盘输入学生信息</span>
<span class="token function">initStu</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span> 
														
<span class="token comment">//aveStu(s, 3)：平均分</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n平均分为： %lf\n"</span><span class="token punctuation">,</span>  <span class="token function">aveStu</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
														
<span class="token comment">//分数排序，降序</span>
<span class="token function">sortStu</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
														
<span class="token comment">//打印学生信息</span>
<span class="token function">showStu</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
														
<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p> }</p>
</li>
</ol>
<ol start="4">
<li><p>重写结构体嵌套一级指针老师和二级指针学生的代码</p>
<p> //结构体类型，每个导师有三个学生<br> typedef struct Teacher<br> {</p>
<pre><code> char *tName; //导师
 char  * * stu;  //三个学生
 int age;
</code></pre>
<p> }Teacher;</p>
<p> //在createTeacher中分配空间<br> int createTeacher( Teacher  * * p / * out * / , int n1, int n2);</p>
<p> //给成员赋值<br> void initTeacher(Teacher *p, int n1, int n2);</p>
<p> //打印结构体成员信息<br> void printTeacher(Teacher *p, int n1, int n2);</p>
</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//根据导师名字排序, 降序</span>
<span class="token keyword">void</span> <span class="token function">sortTeacher</span><span class="token punctuation">(</span>Teacher <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>


<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//释放空间，在函数内部把p赋值为NULL</span>
<span class="token keyword">void</span> <span class="token function">freeTeacher</span><span class="token punctuation">(</span>Teacher <span class="token operator">*</span> <span class="token operator">*</span> p <span class="token punctuation">,</span> <span class="token keyword">int</span> n1<span class="token punctuation">,</span> <span class="token keyword">int</span> n2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> n1 <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//导师个数</span>
	<span class="token keyword">int</span> n2 <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//学生</span>
	Teacher <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre class="line-numbers language-c" data-language="c"><code class="language-c">ret <span class="token operator">=</span> <span class="token function">createTeacher</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token punctuation">,</span> n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"createTeacher err:%d\n"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">initTeacher</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给成员赋值</span>

<span class="token comment">//打印成员，排序前</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"排序前：\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printTeacher</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-c" data-language="c"><code class="language-c">	<span class="token comment">//根据导师名字排序, 降序</span>
	<span class="token function">sortTeacher</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> n1<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//打印成员，排序后</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n排序后：\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printTeacher</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//释放空间，在函数内部把p赋值为NULL</span>
	<span class="token function">freeTeacher</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token punctuation">,</span> n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<ol start="5">
<li><p>画一下第4题createTeacher()的内存四区图</p>
</li>
<li><p>分析以下结构体所占空间大小<br> typedef struct Stu<br> {</p>
<pre><code> char a[4];
 int b;
 double c;
 short d;
</code></pre>
<p> }Stu;</p>
<p> #pragma pack(1)     //1字节对齐<br> #pragma pack(2)     //2字节对齐<br> #pragma pack(4)     //4字节对齐<br> #pragma pack(8)     //8字节对齐<br> #pragma pack(16)    //16字节对齐</p>
</li>
</ol>
</blockquote>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Stu</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> id<span class="token punctuation">;</span>
	<span class="token keyword">double</span> score<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Stu<span class="token punctuation">;</span>

<span class="token comment">//从键盘输入学生信息</span>
<span class="token keyword">void</span> <span class="token function">initStu</span><span class="token punctuation">(</span>Stu <span class="token operator">*</span>s<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请输入第%d个学生信息：\n"</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请输入姓名："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请输入学号："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请输入分数："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%lf"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//求平均分</span>
<span class="token keyword">double</span> <span class="token function">aveStu</span><span class="token punctuation">(</span>Stu <span class="token operator">*</span>s<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> allScore <span class="token operator">=</span> <span class="token number">0.0</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		allScore <span class="token operator">+=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>score<span class="token punctuation">;</span> <span class="token comment">//分数累加</span>
	<span class="token punctuation">&#125;</span>
	
	<span class="token keyword">return</span> allScore <span class="token operator">/</span> <span class="token punctuation">(</span>n<span class="token operator">*</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//分数排序，降序</span>
<span class="token keyword">void</span> <span class="token function">sortStu</span><span class="token punctuation">(</span>Stu <span class="token operator">*</span>s<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
	<span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	Stu tmp<span class="token punctuation">;</span>
	
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>score <span class="token operator">&lt;</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>score<span class="token punctuation">)</span> <span class="token comment">//降序</span>
			<span class="token punctuation">&#123;</span>
				tmp <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
				s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
				s<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//打印学生信息</span>
<span class="token keyword">void</span> <span class="token function">showStu</span><span class="token punctuation">(</span>Stu <span class="token operator">*</span>s<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n学生信息如下：\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"姓名\t学号\t分数\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\t%d\t%lf\n"</span><span class="token punctuation">,</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	Stu s<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

	<span class="token comment">//从键盘输入学生信息</span>
	<span class="token function">initStu</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span> 

	<span class="token comment">//aveStu(s, 3)：平均分</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n平均分为： %lf\n"</span><span class="token punctuation">,</span>  <span class="token function">aveStu</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//分数排序，降序</span>
	<span class="token function">sortStu</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//打印学生信息</span>
	<span class="token function">showStu</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token comment">//结构体类型，每个导师有三个学生</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Teacher</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">char</span> <span class="token operator">*</span>tName<span class="token punctuation">;</span> <span class="token comment">//导师</span>
	<span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>stu<span class="token punctuation">;</span>  <span class="token comment">//三个学生</span>
	<span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Teacher<span class="token punctuation">;</span>

<span class="token comment">//在createTeacher中分配空间</span>
<span class="token keyword">int</span> <span class="token function">createTeacher</span><span class="token punctuation">(</span>Teacher <span class="token operator">*</span><span class="token operator">*</span>p<span class="token comment">/*out*/</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n1<span class="token punctuation">,</span> <span class="token keyword">int</span> n2<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//三个结构体，Teacher t[3]</span>
	Teacher <span class="token operator">*</span>t <span class="token operator">=</span> <span class="token punctuation">(</span>Teacher <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>Teacher<span class="token punctuation">)</span><span class="token operator">*</span> n1<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>t <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n1<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token comment">//每个老师的导师，n2个学生分配空间</span>
	<span class="token punctuation">&#123;</span>
		<span class="token comment">//导师名字</span>
		t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>tName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">50</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//每个导师有n2个学生</span>
		<span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>tmp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>n2 <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//char *tmp[i]</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n2<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			tmp<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stu <span class="token operator">=</span> tmp<span class="token punctuation">;</span> <span class="token comment">//重要</span>

	<span class="token punctuation">&#125;</span>

	<span class="token comment">//间接赋值是指针存在最大意义</span>
	<span class="token operator">*</span>p <span class="token operator">=</span> t<span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//给成员赋值</span>
<span class="token keyword">void</span> <span class="token function">initTeacher</span><span class="token punctuation">(</span>Teacher <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> n1<span class="token punctuation">,</span> <span class="token keyword">int</span> n2<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n1<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token comment">//导师名字</span>
		<span class="token function">sprintf</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token string">"teacher%d%d%d"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> i<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">strcpy</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>tName<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
		<span class="token comment">//每个导师有n2个学生</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n2<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token function">sprintf</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token string">"stu%d%d%d%d"</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">strcpy</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stu<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">//年龄</span>
		p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">20</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token operator">*</span>i<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>

<span class="token comment">//打印结构体成员信息</span>
<span class="token keyword">void</span> <span class="token function">printTeacher</span><span class="token punctuation">(</span>Teacher <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> n1<span class="token punctuation">,</span> <span class="token keyword">int</span> n2<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//先打印导师，再打印学生</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n1<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s[%d]\n"</span><span class="token punctuation">,</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>tName<span class="token punctuation">,</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//每个导师有n2个学生</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n2<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\t%s"</span><span class="token punctuation">,</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stu<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>

<span class="token comment">//根据导师名字排序, 降序</span>
<span class="token keyword">void</span> <span class="token function">sortTeacher</span><span class="token punctuation">(</span>Teacher <span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	Teacher tmp<span class="token punctuation">;</span>

	<span class="token comment">//选择法排序</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>tName<span class="token punctuation">,</span> p<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>tName<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">//降序</span>
			<span class="token punctuation">&#123;</span>
				<span class="token comment">//交换成员变量的值</span>
				tmp <span class="token operator">=</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
				p<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> p<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
				p<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>

<span class="token comment">//释放空间，在函数内部把p赋值为NULL</span>
<span class="token keyword">void</span> <span class="token function">freeTeacher</span><span class="token punctuation">(</span>Teacher <span class="token operator">*</span><span class="token operator">*</span>p<span class="token punctuation">,</span> <span class="token keyword">int</span> n1<span class="token punctuation">,</span> <span class="token keyword">int</span> n2<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	Teacher <span class="token operator">*</span>t <span class="token operator">=</span> <span class="token operator">*</span>p<span class="token punctuation">;</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n1<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token comment">//先释放导师</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>tName <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token function">free</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>tName<span class="token punctuation">)</span><span class="token punctuation">;</span>
			t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>tName <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">//再释放导师名下的学生</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n2<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stu<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
			<span class="token punctuation">&#123;</span>
				<span class="token function">free</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stu<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stu<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stu <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token function">free</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stu<span class="token punctuation">)</span><span class="token punctuation">;</span>
			t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>stu <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>t <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">free</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token operator">*</span>p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> n1 <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//导师个数</span>
	<span class="token keyword">int</span> n2 <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">//学生</span>
	Teacher <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	ret <span class="token operator">=</span> <span class="token function">createTeacher</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token punctuation">,</span> n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"createTeacher err:%d\n"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token function">initTeacher</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//给成员赋值</span>

	<span class="token comment">//打印成员，排序前</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"排序前：\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printTeacher</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">;</span>


	<span class="token comment">//根据导师名字排序, 降序</span>
	<span class="token function">sortTeacher</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> n1<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//打印成员，排序后</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n排序后：\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printTeacher</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//释放空间，在函数内部把p赋值为NULL</span>
	<span class="token function">freeTeacher</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token punctuation">,</span> n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h3><h4 id="文件操作的步骤"><a href="#文件操作的步骤" class="headerlink" title="文件操作的步骤"></a>文件操作的步骤</h4><ol>
<li>引入头文件(stdio.h ) </li>
<li>定义文件指针 </li>
<li>打开文件 </li>
<li>文件读写 </li>
<li>关闭文件 </li>
</ol>
<h4 id="有关文件的概念"><a href="#有关文件的概念" class="headerlink" title="有关文件的概念"></a>有关文件的概念</h4><ul>
<li><p>按文件的逻辑结构：</p>
</li>
<li><blockquote>
<p>记录文件：由具有一定结构的记录组成（定长和不定长）</p>
<p>流式文件：由一个个字符（字节）数据顺序组成</p>
</blockquote>
</li>
<li><p>按存储介质：</p>
</li>
<li><blockquote>
<p>普通文件：存储介质文件（磁盘、磁带等）</p>
<p>设备文件：非存储介质（键盘、显示器、打印机等）</p>
</blockquote>
</li>
<li><p> 按数据的组织形式：</p>
</li>
</ul>
<blockquote>
<p>文本文件： ASCII文件，每个字节存放一个字符的ASCII码</p>
<p>二进制文件：数据按其在内存中的存储形式原样存放</p>
<p><img src="http://qiniu.orangew.cn/img/wps3AB2.tmp.jpg" alt="img"></p>
</blockquote>
<ul>
<li>流概念<ul>
<li>是一个动态的概念，可以将一个字节形象地比喻成一滴水，字节在设备、文件和程序之间的传输就是流，类似于水在管道中的传输，可以看出，流是对输入输出源的一种抽象，也是对传输信息的一种抽象。通过对输入输出源的抽象，屏蔽了设备之间的差异，使程序员能以一种通用的方式进行存储操作，通过对传输信息的抽象，使得所有信息都转化为字节流的形式传输，信息解读的过程与传输过程分离。</li>
<li>C语言中，I/O操作可以简单地看作是从程序移进或移出字节，这种搬运的过程便称为流(stream)。程序只需要关心是否正确地输出了字节数据，以及是否正确地输入了要读取字节数据，特定I/O设备的细节对程序员是隐藏的。</li>
</ul>
</li>
<li>文件处理方法<ol>
<li>文件缓冲区<ul>
<li>ANSIC标准采用“缓冲文件系统”处理数据文件 所谓缓冲文件系统是指系统自动地在内存区为程序中每一个正在使用的文件开辟一个文件缓冲区。从内存向磁盘输出数据必须先送到内存中的缓冲区,装满缓冲区后才一起送到磁盘去 如果从磁盘向计算机读入数据,则一次从磁盘文件将一批数据输入到内存缓冲区(充满缓冲 区),然后再从缓冲区逐个地将数据送到程序数据区(给程序变量) </li>
</ul>
</li>
<li>输入输出流<ul>
<li>输入输出是数据传送的过程,数据如流水一样从一处流向另一处,因此常将输入输出形象地称为 流(stream),即数据流。流表示了信息从源到目的端的流动。 </li>
<li><img src="http://qiniu.orangew.cn/img/wps62C.tmp.jpg" alt="img"></li>
<li>输入操作时,数据从文件流向计算机内存 — 文件的读取 </li>
<li><img src="http://qiniu.orangew.cn/img/wpsC2C6.tmp.jpg" alt="img"></li>
<li>输出操作时,数据从计算机流向文件 — 文件的写入 </li>
<li><img src="http://qiniu.orangew.cn/img/wps15D8.tmp.jpg" alt="img"></li>
<li>无论是用Word打开或保存文件,还是C程序中的输入输出都是通过操作系统进行的 “流”是一个传输通道,数据可以从运行环境流入程序中,或从程序流至运行环境 。</li>
</ul>
</li>
</ol>
</li>
<li>文件句柄</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">short</span>           level<span class="token punctuation">;</span>      <span class="token comment">/* 缓冲区"满"或者"空"的程度 */</span>
    <span class="token keyword">unsigned</span>        flags<span class="token punctuation">;</span>      <span class="token comment">/* 文件状态标志 */</span>
    <span class="token keyword">char</span>            fd<span class="token punctuation">;</span>         <span class="token comment">/* 文件描述符 */</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span>   hold<span class="token punctuation">;</span>       <span class="token comment">/* 如无缓冲区不读取字符 */</span>
    <span class="token keyword">short</span>           bsize<span class="token punctuation">;</span>      <span class="token comment">/* 缓冲区的大小 */</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span>   <span class="token operator">*</span>buffer<span class="token punctuation">;</span>    <span class="token comment">/* 数据缓冲区的位置 */</span>
    <span class="token keyword">unsigned</span>        ar<span class="token punctuation">;</span>         <span class="token comment">/* 指针，当前的指向 */</span>
    <span class="token keyword">unsigned</span>        istemp<span class="token punctuation">;</span>     <span class="token comment">/* 临时文件，指示器 */</span>
    <span class="token keyword">short</span>           token<span class="token punctuation">;</span>      <span class="token comment">/* 用于有效性的检查 */</span>
<span class="token punctuation">&#125;</span>FILE<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="C语言文件指针"><a href="#C语言文件指针" class="headerlink" title="C语言文件指针"></a>C语言文件指针</h4><ul>
<li><p>在C语言中用一个指针变量指向一个文件,这个指针称为文件指针。 </p>
</li>
<li><p>声明FILE结构体类型的信息包含在头文件“stdio.h”中</p>
</li>
<li><p>一般设置一个指向FILE类型变量的指针变量,然后通过它来引用这些FILE类型变量 通过文件指针就可对它所指的文件进行各种操作。 </p>
<p>定义说明文件指针的一般形式为:</p>
</li>
<li><p>FILE * 指针变量标识符; </p>
</li>
<li><p>其中FILE应为大写,它实际上是由系统定义的一个结构,该结构中含有文件名、文件状态和文件 当前位置等信息。在编写源程序时不必关心FILE结构的细节。 </p>
</li>
<li><p>FILE *fp; </p>
</li>
<li><p>表示<code>fp</code>是指向FILE结构的指针变量,通过fp即可找存放某个文件信息的结构变量,然后按结构变 量�供的信息找到该文件,实施对文件的操作。习惯上也笼统地把<code>fp</code>称为指向一个文件的指针。 </p>
</li>
<li><p><img src="http://qiniu.orangew.cn/img/wps476.tmp.jpg" alt="img"></p>
</li>
</ul>
<h4 id="文件操作API"><a href="#文件操作API" class="headerlink" title="文件操作API"></a>文件操作API</h4><blockquote>
<p><code>fgetc fputc</code> 按照字符读写文件</p>
<p>​        </p>
<p><code>fputs fgets</code>     按照行读写文件 （读写配置文件）</p>
<p>​        </p>
<p><code>fread fwirte</code> 按照块读写文件 （大数据块迁移）</p>
<p>​        </p>
<p><code>fprintf    fscanf</code>    按照格式化进行读写文件</p>
</blockquote>
<h4 id="标准的文件读写"><a href="#标准的文件读写" class="headerlink" title="标准的文件读写"></a>标准的文件读写</h4><ol>
<li><p>文件的打开fopen()</p>
<ul>
<li><p>文件的打开操作表示将给用户指定的文件在内存分配一个FILE结构区，并将该结构的指针返回给用户程序，以后用户程序就可用此FILE指针来实现对指定文件的存取操作了。当使用打开函数时，必须给出文件名、文件操作方式(读、写或读写),如果该文件名不存在，就意味着建立(只对写文件而言，对读文件则出错)，并将文件指针指向文件开头。若已有一个同名文件存在，则删除该文件，若无同名文件，则建立该文件，并将文件指针指向文件开头。</p>
</li>
<li><p><code>fopen(char *filename,char *type);</code></p>
</li>
<li><p>其中* filename是要打开文件的文件名指针，一般用双引号括起来的文件名表示，也可使用双反斜杠隔开的路径名。而*type参数表示了对打开文件的操作方式。其可采用的操作方式如下：</p>
</li>
<li></li>
<li><table>
<thead>
<tr>
<th>方式</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>“r”</td>
<td>打开，只读，文件必须已经存在。</td>
</tr>
<tr>
<td>“w”</td>
<td>只写,如果文件不存在则创建,如果文件已存在则把文件长度截断(Truncate)为0字节。再重新写,也就是替换掉原来的文件内容文件指针指到头。</td>
</tr>
<tr>
<td>“a”</td>
<td>只能在文件末尾追加数据,如果文件不存在则创建</td>
</tr>
<tr>
<td>“rb”</td>
<td>打开一个二进制文件，只读</td>
</tr>
<tr>
<td>“wb”</td>
<td>打开一个二进制文件，只写</td>
</tr>
<tr>
<td>“ab”</td>
<td>打开一个二进制文件，追加</td>
</tr>
<tr>
<td>“r+”</td>
<td>允许读和写,文件必须已存在</td>
</tr>
<tr>
<td>“w+”</td>
<td>允许读和写,如果文件不存在则创建,如果文件已存在则把文件长度截断为0字节再重新写 。</td>
</tr>
<tr>
<td>“a+”</td>
<td>允许读和追加数据,如果文件不存在则创建</td>
</tr>
<tr>
<td>“rb+”</td>
<td>以读/写方式打开一个二进制文件</td>
</tr>
<tr>
<td>“wb+”</td>
<td>以读/写方式建立一个新的二进制文件</td>
</tr>
<tr>
<td>“ab+”</td>
<td>以读/写方式打开一个二进制文件进行追加</td>
</tr>
</tbody></table>
</li>
<li><p>当用fopen()成功的打开一个文件时，该函数将返回一个FILE指针，如果文件打开失败，将返回一个NULL指针。如想打开test文件，进行写：</p>
</li>
<li><blockquote>
<p>FILE *fp;</p>
<p>if((fp=fopen(“test”,”w”))==NULL)</p>
<p>{</p>
<p>  printf(“File cannot be  opened\n”);</p>
<p>  exit();</p>
<p>}</p>
<p>else</p>
<p>{</p>
<p>  printf(“File opened for writing\n”);</p>
<p>}</p>
<p>fclose(fp);</p>
</blockquote>
</li>
<li><p>c语言中有三个特殊的文件指针无需定义、打开可直接使用:</p>
<ol>
<li>stdin： 标准输入 默认为当前终端（键盘）<ul>
<li>我们使用的scanf、getchar函数默认从此终端获得数据</li>
</ul>
</li>
<li>stdout：标准输出 默认为当前终端（屏幕）<ul>
<li>我们使用的printf、puts函数默认输出信息到此终端</li>
</ul>
</li>
<li>stderr：标准出错 默认为当前终端（屏幕）<ul>
<li>当我们程序出错或者使用:perror函数时信息打印在此终端</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
<li><p>关闭文件函数fclose()</p>
<ul>
<li><p>文件操作完成后，必须要用fclose()函数进行关闭，这是因为对打开的文件进行写入时，若文件缓冲区的空间未被写入的内容填满，这些内容不会写到打开的文件中去而丢失。只有对打开的文件进行关闭操作时，停留在文件缓冲区的内容才能写到该文件中去，从而使文件完整。再者一旦关闭了文件，该文件对应的FILE结构将被释放，从而使关闭的文件得到保护，因为这时对该文件的存取操作将不会进行。文件的关闭也意味着释放了该文件的缓冲区。</p>
</li>
<li><p><code>int fclose(FILE *stream);</code></p>
</li>
<li><p>它表示该函数将关闭FILE指针对应的文件，并返回一个整数值。若成功地关闭了文件，则返回一个0值，否则返回一个非0值。常用以下方法进行测试</p>
</li>
<li><blockquote>
<p>if(fclose(fp)!=0)</p>
<p>{</p>
<p>  printf(“File cannot be closed\n”);</p>
<p>  exit(1);</p>
<p>}</p>
<p>else</p>
<p>{</p>
<p>  printf(“File is now closed\n”);</p>
<p>}</p>
</blockquote>
</li>
</ul>
</li>
<li><p>文件的读写</p>
</li>
</ol>
<ul>
<li><p>读写文件中字符的函数(一次只读写文件中的一个字符)：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">fgetc</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">fputc</span><span class="token punctuation">(</span><span class="token keyword">int</span> ch<span class="token punctuation">,</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">getc</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">putc</span><span class="token punctuation">(</span><span class="token keyword">int</span> ch<span class="token punctuation">,</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>其中fgetc()函数将把由流指针指向的文件中的一个字符读出，例如：</p>
</li>
<li><p><code>ch=fgetc(fp);</code></p>
</li>
<li><p>将把流指针fp指向的文件中的一个字符读出，并赋给ch，当执行fgetc()函数时，若当时文件指针指到文件尾，即遇到文件结束标志EOF(其对应值为-1)，该函数返回一个-1给ch，在程序中常用检查该函数返回值是否为-1来判断是否已读到文件尾，从而决定是否继续。</p>
</li>
<li><blockquote>
<p>#include &lt;stdio.h&gt;</p>
<p>int main(void)</p>
<p>{</p>
<p>  FILE *fp;</p>
<p>  char ch;</p>
<p>  if((fp=fopen(“myfile.txt”,”r”))==NULL)</p>
<p>  {</p>
<p>​    printf(“file cannot be opened\n”);</p>
<p>​    exit(1);</p>
<p>  }</p>
<p>  while((ch=fgetc(fp))!=EOF) {</p>
<p>​    fputc(ch,stdout);</p>
<p>  }</p>
<p>  fclose(fp);</p>
<p>  return 0;</p>
<p>}</p>
</blockquote>
</li>
<li><p>该程序以只读方式打开myfile.txt文件，在执行while循环时，文件指针每循环一次后移一个字符位置。用fgetc()函数将文件指针指定的字符读到ch变量中，然后用fputc()函数在屏幕上显示，当读到文件结束标志EOF时，变关闭该文件。</p>
</li>
<li><p>上面的程序用到了fputc()函数，该函数将字符变量ch的值写到流指针指定的文件中去，由于流指针用的是标准输出(显示器)的FILE指针stdout，故读出的字符将在显示器上显示。</p>
</li>
</ul>
</li>
</ul>
<ul>
<li>读写文件中字符串的函数</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">fgets</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>string<span class="token punctuation">,</span><span class="token keyword">int</span> n<span class="token punctuation">,</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">fprintf</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>format<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">fputs</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>string<span class="token punctuation">,</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>其中fgets()函数将把由流指针指定的文件中n-1个字符，读到由指针stream指向的字符数组中去，例如：</p>
</li>
<li><p><code>fgets(buffer, 9, fp);</code></p>
</li>
<li><p>将把fp指向的文件中的8个字符读到buffer内存区，buffer可以是定义的字符数组，也可以是动态分配的内存区。</p>
</li>
<li><p>注意，fgets()函数读到’\n’就停止，而不管是否达到数目要求。同时在读取字符串的最后加上’\0’。</p>
</li>
<li><p>fgets()函数执行完以后，返回一个指向该串的指针。如果读到文件尾或出错，则均返回一个空指针NULL，所以长用feof()函数来测定是否到了文件尾或者是ferror()函数来测试是否出错，例如下面的程序用fgets()函数读test.txt文件中的第一行并显示出来：</p>
</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    FILE <span class="token operator">*</span>fp<span class="token punctuation">;</span>
    <span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>fp<span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"test.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token constant">NULL</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"cannot open file\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">fgets</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">,</span>fp<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>fputs()函数想指定文件写入一个由string指向的字符串，’\0’不写入文件。     </li>
<li>fprintf()同printf()函数类似，不同之处就是printf()函数是想显示器输出，fprintf()则是向流指针指向的文件输出。</li>
<li>下面程序是向文件test.dat里输入一些字符：</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>s<span class="token operator">=</span><span class="token string">"That's good news"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">617</span><span class="token punctuation">;</span>
    FILE <span class="token operator">*</span>fp<span class="token punctuation">;</span>

    fp<span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"test.dat"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">fputs</span><span class="token punctuation">(</span><span class="token string">"Your score of TOEFLis"</span><span class="token punctuation">,</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">fputc</span><span class="token punctuation">(</span><span class="token char">':'</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> <span class="token string">"%d\n"</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> <span class="token string">"%s"</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>文件二进制块读写函数</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token class-name">size_t</span> <span class="token function">fread</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">,</span> <span class="token class-name">size_t</span> size<span class="token punctuation">,</span> <span class="token class-name">size_t</span> nmemb<span class="token punctuation">,</span> FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token class-name">size_t</span> <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">,</span> <span class="token class-name">size_t</span> size<span class="token punctuation">,</span> <span class="token class-name">size_t</span> nmemb<span class="token punctuation">,</span> FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//返回值:读或写的记录数,成功时返回的记录数等于nmemb,</span>
<span class="token comment">//出错或读到文件末尾时返回 的记录数小于nmemb,也可能返回0          </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><code>fread</code>和<code>fwrite</code>用于读写记录,这里的记录是指一串固定长度的字节,比如一个int、一个结构 体或者一个定长数组。参数<code>size</code>指出一条记录的长度,而<code>nmemb</code>指出要读或写多少条记录,这些 记录在<code>ptr</code>所指的内存空间中连续存放,共占<code>size * nmemb</code>个字节,<code>fread</code>从文件<code>stream</code>中读 出<code>size * nmemb</code>个字节保存到<code>ptr</code>中,而<code>fwrite</code>把<code>ptr</code>中的<code>size * nmemb</code>个字节写到文件<code>stream</code>中。</li>
<li> <code>nmemb</code>是请求读或写的记录数,<code>fread</code>和<code>fwrite</code>返回的记录数有可能小于<code>nmemb</code>指定的记录数。例 如当前读写位置距文件末尾只有一条记录的长度,调用<code>fread</code>时指定<code>nmemb</code>为2,则返回值为1。 如果当前读写位置已经在文件末尾了,或者读文件时出错了,则<code>fread</code>返回0。如果写文件时出 错了,则<code>fwrite</code>的返回值小于<code>nmemb</code>指定的值。下面的例子由两个程序组成,一个程序把结构体 保存到文件中,另一个程序和从文件中读出结构体。</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>

<span class="token keyword">struct</span> <span class="token class-name">record</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">struct</span> <span class="token class-name">record</span> array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">"Ken"</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"Knuth"</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

    FILE <span class="token operator">*</span>fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"recfile"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>fp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Open file recfile"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>   
    
    <span class="token function">fwrite</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">record</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>

<span class="token keyword">struct</span> <span class="token class-name">record</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">struct</span> <span class="token class-name">record</span> array<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    FILE <span class="token operator">*</span>fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"recfile"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

    <span class="token keyword">if</span> <span class="token punctuation">(</span>fp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Open file recfile"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">fread</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">record</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Name1: %s\tAge1: %d\n"</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">rintf</span><span class="token punctuation">(</span><span class="token string">"Name2: %s\tAge2: %d\n"</span><span class="token punctuation">,</span> array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>4.清除和设置文件缓冲区</p>
<ul>
<li><code>int fflush(FILE *stream);</code></li>
<li><code>fflush()</code>函数将清除由<code>stream</code>指向的文件缓冲区里的内容，常用于写完一些数据后，立即用该函数清除缓冲区，以免误操作时，破坏原来的数据。</li>
</ul>
<ol start="5">
<li>  文件的随机读写函数</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">fseek</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">,</span> <span class="token keyword">long</span> offset<span class="token punctuation">,</span> <span class="token keyword">int</span> whence<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回值:成功返回0,出错返回-1并设置errno </span>

<span class="token keyword">long</span> <span class="token function">ftell</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回值:成功返回当前读写位置,出错返回-1并设置errno </span>

<span class="token keyword">void</span> <span class="token function">rewind</span><span class="token punctuation">(</span>FILE <span class="token operator">*</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>fseek的whence和offset参数共同决定了读写位置移动到何处,whence参数的含义如下: </p>
</li>
<li><blockquote>
<p>SEEK_SET </p>
<p>​    从文件开头移动offset个字节</p>
<p>SEEK_CUR </p>
<p>​    从当前位置移动offset个字节 </p>
<p>SEEK_END <img src="E:\Computer\myblog\hexo\source_posts\C-基础教程整理\wps2394.tmp.jpg" alt="img"> </p>
<p>​    从文件末尾移动offset个字节 </p>
</blockquote>
</li>
<li><p>offset可正可负,负值表示向前(向文件开头的方向)移动,正值表示向后(向文件末尾的方 向)移动,如果向前移动的字节数超过了文件开头则出错返回,如果向后移动的字节数超过了 文件末尾,再次写入时将增大文件尺寸,从原来的文件末尾到fseek移动之后的读写位置之间的 字节都是0。 </p>
</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    FILE<span class="token operator">*</span> fp<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span>fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"textfile"</span><span class="token punctuation">,</span><span class="token string">"r+"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span>"Open file textfile\n”<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">fseek</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token constant">SEEK_SET</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Seek file textfile\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">fputc</span><span class="token punctuation">(</span><span class="token char">'K'</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="文件操作案例"><a href="#文件操作案例" class="headerlink" title="文件操作案例"></a>文件操作案例</h4><ol>
<li><p>配置文件读写（自定义接口）</p>
<blockquote>
<p>配置文件读写案例实现分析</p>
<p>​    1、    功能划分</p>
<p>​        a)    界面测试（功能集成）</p>
<p>​            自己动手规划接口模型。</p>
<p>​        b)    配置文件读写    </p>
<p>​            i.    配置文件读（根据key，读取valude）</p>
<p>​            ii.    配置文件写（输入key、valude）</p>
<p>​            iii.    配置文件修改（输入key、valude）</p>
<p>​            iv.    优化 ===》接口要求紧 模块要求松</p>
<p>​    2、    实现及代码讲解</p>
<p>​    3、    测试。</p>
<p>（2）加密文件读写 （使用别人写好的接口）</p>
</blockquote>
</li>
</ol>
<ul>
<li>cfg.h</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//防止头文件重复包含</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">once</span></span>

<span class="token comment">//为了兼容C++编译器</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span>
<span class="token keyword">extern</span> <span class="token string">"C"</span><span class="token punctuation">&#123;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// __cplusplus</span></span>

<span class="token comment">//函数的声明</span>

<span class="token comment">//读配置文件</span>
<span class="token keyword">int</span> <span class="token function">ReadCfgFile</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>fileName<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>pKey<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>pVal<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>pLen<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//写、修改配置文件</span>
<span class="token keyword">int</span> <span class="token function">WriteCfgFile</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>fileName<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>pKey<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>pVal<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span>
<span class="token punctuation">&#125;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// __cplusplus</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>ctg.c</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ctype.h></span></span>

<span class="token comment">//文件最大大小</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXSIZE</span> <span class="token expression"><span class="token number">8</span><span class="token operator">*</span><span class="token number">1024</span> </span><span class="token comment">//8K</span></span>

<span class="token comment">/*
功能：获取非空字符串
参数：
	inbuf： 原始字符串buf首地址
	outbuf：非空字符串buf首地址
返回值：
	成功：0
	失败：非0
*/</span>
<span class="token keyword">int</span> <span class="token function">trimSpace</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>inbuf<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>outbuf<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>inbuf <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> outbuf <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> inbuf<span class="token punctuation">;</span>
	<span class="token keyword">int</span> begin <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> end <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>end <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//从左往右移动，如果当前字符为空，而且没有结束</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">isspace</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span>begin<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> p<span class="token punctuation">[</span>begin<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		begin<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment">//位置从右移动一位</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//从右往左移动，如果当前字符为空</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token function">isspace</span><span class="token punctuation">(</span>p<span class="token punctuation">[</span>end<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> end <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		end<span class="token operator">--</span><span class="token punctuation">;</span> <span class="token comment">//往左移动</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>end <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	n <span class="token operator">=</span> end <span class="token operator">-</span> begin <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//非空元素个数</span>

	<span class="token function">strncpy</span><span class="token punctuation">(</span>outbuf<span class="token punctuation">,</span> p <span class="token operator">+</span> begin<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
	outbuf<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//读配置文件</span>
<span class="token keyword">int</span> <span class="token function">ReadCfgFile</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>fileName<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>pKey<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>pVal<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>pLen<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>fileName <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> pKey <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> pVal <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> pLen <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	FILE <span class="token operator">*</span>fp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> <span class="token operator">*</span>tmp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//如果没有key所对应的value，flag则为0</span>

	<span class="token comment">//读方式打开文件</span>
	fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>fp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"ReadCfgFile[fopen]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//如果文件没有结束</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">memset</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		tmp <span class="token operator">=</span> <span class="token function">fgets</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>buf<span class="token punctuation">)</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>tmp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">//判断每行中是否包含key</span>
		tmp <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> pKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> tmp<span class="token punctuation">)</span><span class="token comment">//如果没有包含key</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">//跳出本次循环</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">//重新设置搜索字符串的位置（跳过key）</span>
		<span class="token comment">// "k1 = 1111" -> " = 1111"</span>
		tmp <span class="token operator">=</span> tmp <span class="token operator">+</span> <span class="token function">strlen</span><span class="token punctuation">(</span>pKey<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//判断是否包含=</span>
		tmp <span class="token operator">=</span> <span class="token function">strchr</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> <span class="token char">'='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> tmp<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token comment">//跳出本次循环</span>
		<span class="token punctuation">&#125;</span>
		<span class="token comment">//重新设置搜索字符串的位置(跳过=)</span>
		<span class="token comment">//"= 1111" -> "   1111  "</span>
		tmp <span class="token operator">=</span> tmp <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>

		<span class="token comment">//获取非空字符，两头堵模型</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> <span class="token function">trimSpace</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span> pVal<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token comment">//到这，已经找到你所要求的value</span>
			<span class="token operator">*</span>pLen <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>pVal<span class="token punctuation">)</span><span class="token punctuation">;</span> 
			flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		
		<span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token comment">//很重要</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> flag<span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"没有%s所对应的值\n"</span><span class="token punctuation">,</span> pKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//关闭文件</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>fp <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//写、修改配置文件</span>
<span class="token comment">//实现流程</span>
<span class="token comment">//循环读每一行</span>
<span class="token comment">//此行包含key，则把key的value修改</span>
<span class="token comment">//如果所有行都不包含key，则在文件结尾追加： "key = value"</span>
<span class="token comment">//难点：如何修改</span>
<span class="token keyword">int</span> <span class="token function">WriteCfgFile</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>fileName<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>pKey<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>pVal<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>fileName <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> pKey <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> pVal <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	FILE <span class="token operator">*</span>fp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> tmpBuf<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> lineBuf<span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//0: 不包括key</span>

	<span class="token comment">//打开文件，读写方式打开，文件不存在，打开失败</span>
	fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> <span class="token string">"r+"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>fp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token comment">//文件不存在时，新建文件</span>
	<span class="token punctuation">&#123;</span>
		<span class="token comment">//perror("WriteCfgFile ")</span>
		<span class="token comment">//return -2;</span>

		<span class="token comment">//写读方式打开文件，文件不存在则创建</span>
		fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> <span class="token string">"w+"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>fp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"WriteCfgFile fopen"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//假如文件存在</span>
	<span class="token comment">//获取文件内容大小，看是否超出范围</span>

	<span class="token comment">//把文件光标移动到结尾处</span>
	<span class="token function">fseek</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">SEEK_END</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//获取文件内容大小</span>
	<span class="token keyword">long</span> size <span class="token operator">=</span> <span class="token function">ftell</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//如果文件大小超过8k，中断程序</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>size <span class="token operator">>=</span> MAXSIZE<span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"文件大小超过8k，不支持\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//把文件光标移动到最开始位置</span>
	<span class="token comment">//fseek(fp, 0, SEEK_SET);</span>
	<span class="token function">rewind</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//循环读每一行</span>
	<span class="token comment">//此行包含key，则把key的value修改</span>
	<span class="token comment">//如果所有行都不包含key，则在文件结尾追加： "key = value"</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> <span class="token function">fgets</span><span class="token punctuation">(</span>lineBuf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>lineBuf<span class="token punctuation">)</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">//此行是否包含key</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strstr</span><span class="token punctuation">(</span>lineBuf<span class="token punctuation">,</span> pKey<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token comment">//包含</span>
		<span class="token punctuation">&#123;</span>
			<span class="token comment">//重写给lineBuf格式化</span>
			<span class="token function">sprintf</span><span class="token punctuation">(</span>lineBuf<span class="token punctuation">,</span> <span class="token string">"%s = %s\n"</span><span class="token punctuation">,</span> pKey<span class="token punctuation">,</span> pVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">strcat</span><span class="token punctuation">(</span>tmpBuf<span class="token punctuation">,</span> lineBuf<span class="token punctuation">)</span><span class="token punctuation">;</span>
			flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">else</span>
		<span class="token punctuation">&#123;</span>
			<span class="token function">strcat</span><span class="token punctuation">(</span>tmpBuf<span class="token punctuation">,</span> lineBuf<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>

	
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> flag<span class="token punctuation">)</span> <span class="token comment">//文件中没有key值</span>
	<span class="token punctuation">&#123;</span><span class="token comment">//如果所有行都不包含key，则在文件结尾追加： "key = value"</span>
		<span class="token comment">//sprintf(lineBuf, "%s = %s", pKey, pVal);	</span>

		<span class="token comment">//到这一步，文件光标已经移动到结尾处</span>
		<span class="token comment">//如果此时往文件中写内容，肯定是追加到结尾处</span>
		<span class="token comment">//格式化方式写文件</span>
		<span class="token function">fprintf</span><span class="token punctuation">(</span>fp<span class="token punctuation">,</span> <span class="token string">"%s = %s\n"</span><span class="token punctuation">,</span> pKey<span class="token punctuation">,</span> pVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">&#123;</span>	<span class="token comment">//关闭文件</span>
		<span class="token comment">//重写以写方式打开文件，重写给文件写内容</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>fp <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
			fp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">//写读方式打开文件，文件不存在则创建</span>
		fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> <span class="token string">"w+"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>fp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"WriteCfgFile fopen"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">//往文件写内容</span>
		<span class="token function">fputs</span><span class="token punctuation">(</span>tmpBuf<span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>


	<span class="token keyword">if</span> <span class="token punctuation">(</span>fp <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		fp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">return</span>  <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>main.c</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token comment">//&lt;>: 从系统目录找</span>
<span class="token comment">//"": 从当前目录找，没有找到再从系统目录中寻找</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"cfg.h"</span> </span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">CFGNAME</span> <span class="token string">"./mycfg.ini"</span></span>

<span class="token keyword">void</span> <span class="token function">MyMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"================================\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"1 写配置文件\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"2 读配置文件\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"3 清屏\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"4 退出\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"================================\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">MyWrite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> value<span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n请输入key: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n请输入value: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>

	ret <span class="token operator">=</span> <span class="token function">WriteCfgFile</span><span class="token punctuation">(</span>CFGNAME<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">//失败</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"WriteCfgFile err: %d\n"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n写入的内容：%s = %s\n\n"</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">MyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> key<span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> value<span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n请输入key: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>

	ret <span class="token operator">=</span> <span class="token function">ReadCfgFile</span><span class="token punctuation">(</span>CFGNAME<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token operator">&amp;</span>len<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">//失败</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"ReadCfgFile err: %d\n"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n %s对应的value为：%s, 长度为：%d\n\n"</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> cmd<span class="token punctuation">;</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">MyMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"cmd:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">switch</span> <span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
		<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
			<span class="token function">MyWrite</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
			<span class="token function">MyRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
			<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">default</span><span class="token operator">:</span>
			<span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

	<span class="token punctuation">&#125;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>拷贝文件</p>
</blockquote>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">SIZE</span> <span class="token expression"><span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">2</span> </span><span class="token comment">//每次读写2k数据</span></span>

<span class="token keyword">void</span> <span class="token function">menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"================================\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"1 拷贝文件\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"2 清屏\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"3 退出\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"================================\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">myCopy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">char</span> rPath<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//源文件</span>
	<span class="token keyword">char</span> wPath<span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//目的文件</span>
	FILE <span class="token operator">*</span>rFp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	FILE <span class="token operator">*</span>wFp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> buf<span class="token punctuation">[</span>SIZE<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> 
	<span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请输入源文件："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> rPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请输入目的文件："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> wPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span>rPath<span class="token punctuation">,</span> wPath<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"源文件和目的文件不能相同\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//只读方式打开源文件</span>
	rFp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>rPath<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>rFp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"fopen rPath"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//只写方式打开目的文件</span>
	wFp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>wPath<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>wFp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">fclose</span><span class="token punctuation">(</span>rFp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"fopen wFp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">do</span> 
	<span class="token punctuation">&#123;</span>
		n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
		<span class="token comment">//读多少，写多少</span>
		n <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">,</span> SIZE<span class="token punctuation">,</span> rFp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"拷贝：%d\n"</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">fwrite</span><span class="token punctuation">(</span>buf<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> wFp<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token punctuation">&#125;</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>n <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"拷贝完成\n\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">fclose</span><span class="token punctuation">(</span>rFp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">fclose</span><span class="token punctuation">(</span>wFp<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	

	<span class="token keyword">int</span> cmd<span class="token punctuation">;</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"cmd: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">switch</span> <span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
		<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
			<span class="token function">myCopy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
			<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">default</span><span class="token operator">:</span>
			<span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>加密 解密文件</p>
</blockquote>
<ul>
<li>des.h</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/*********************************************************
 *  des.h
 *  用户使用des算法头文件
 *	
 *********************************************************/</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">_OPENDESS_H_</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_OPENDESS_H_</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span>
<span class="token keyword">extern</span> <span class="token string">"C"</span> <span class="token punctuation">&#123;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>


<span class="token comment">//加密小于4k的数据（encrypt：加密）</span>
<span class="token comment">//pInData：明文数据</span>
<span class="token comment">//nInDataLen：明文数据长度</span>
<span class="token comment">//pOutData：加密后的数据</span>
<span class="token comment">//pOutDataLen：加密数据的长度</span>
<span class="token keyword">int</span> <span class="token function">DesEnc</span><span class="token punctuation">(</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pInData<span class="token punctuation">,</span>
		<span class="token keyword">int</span>            nInDataLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pOutData<span class="token punctuation">,</span>
		<span class="token keyword">int</span>           <span class="token operator">*</span>pOutDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//加密等于4k的数据</span>
<span class="token keyword">int</span> <span class="token function">DesEnc_raw</span><span class="token punctuation">(</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pInData<span class="token punctuation">,</span>
	<span class="token keyword">int</span>            nInDataLen<span class="token punctuation">,</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pOutData<span class="token punctuation">,</span>
	<span class="token keyword">int</span>           <span class="token operator">*</span>pOutDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//解密小于4k的数据(decrypt：解密)</span>
<span class="token comment">//pInData：密文数据</span>
<span class="token comment">//nInDataLen：密文数据长度</span>
<span class="token comment">//pOutData：解密后的数据</span>
<span class="token comment">//pOutDataLen：解密数据的长度</span>
<span class="token keyword">int</span> <span class="token function">DesDec</span><span class="token punctuation">(</span>
	   <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pInData<span class="token punctuation">,</span>
	   <span class="token keyword">int</span>            nInDataLen<span class="token punctuation">,</span>
	   <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pOutData<span class="token punctuation">,</span>
	   <span class="token keyword">int</span>           <span class="token operator">*</span>pOutDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//解密等于4k的数据</span>
<span class="token keyword">int</span> <span class="token function">DesDec_raw</span><span class="token punctuation">(</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pInData<span class="token punctuation">,</span>
	<span class="token keyword">int</span>            nInDataLen<span class="token punctuation">,</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pOutData<span class="token punctuation">,</span>
	<span class="token keyword">int</span>           <span class="token operator">*</span>pOutDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>



<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span>
<span class="token punctuation">&#125;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>des.c</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/******************************************************
 *
 *  des.c
 *  common des......
 *
 ******************************************************/</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"des.h"</span></span>

<span class="token comment">/*********************************************************
  data type definition for Des;
**********************************************************/</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">EN0</span>	<span class="token expression"><span class="token number">0</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DE1</span>	<span class="token expression"><span class="token number">1</span></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DES_KEYBYTES</span>	<span class="token expression"><span class="token number">128</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DES_KEYLONGS</span>	<span class="token expression"><span class="token number">32</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DES_BLOCKLEN</span>	<span class="token expression"><span class="token number">8</span></span></span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> ek<span class="token punctuation">[</span>DES_KEYBYTES<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span>	ekLen<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> dk<span class="token punctuation">[</span>DES_KEYBYTES<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span>	dkLen<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> CbcCtx<span class="token punctuation">[</span>DES_BLOCKLEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> DES_CTX<span class="token punctuation">;</span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> ek1<span class="token punctuation">[</span>DES_KEYBYTES<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span>	ek1Len<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> dk1<span class="token punctuation">[</span>DES_KEYBYTES<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span>	dk1Len<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> ek2<span class="token punctuation">[</span>DES_KEYBYTES<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span>	ek2Len<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> dk2<span class="token punctuation">[</span>DES_KEYBYTES<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span>	dk2Len<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> CbcCtx<span class="token punctuation">[</span>DES_BLOCKLEN<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token comment">//int	IsFirstBlock;</span>
<span class="token punctuation">&#125;</span> DES3_CTX<span class="token punctuation">;</span>


<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> pc1<span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
	<span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span>  <span class="token number">8</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span>
	 <span class="token number">9</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span>
	<span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span>
	<span class="token number">13</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">3</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> pc2<span class="token punctuation">[</span><span class="token number">48</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
	<span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">,</span>		 <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>  <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span>  <span class="token number">9</span><span class="token punctuation">,</span>
	<span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>  <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span>  <span class="token number">7</span><span class="token punctuation">,</span> 	<span class="token number">15</span><span class="token punctuation">,</span>  <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span>		<span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span>
	<span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> 	<span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">31</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">short</span> bytebit<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0200</span><span class="token punctuation">,</span><span class="token number">0100</span><span class="token punctuation">,</span><span class="token number">040</span><span class="token punctuation">,</span><span class="token number">020</span><span class="token punctuation">,</span><span class="token number">010</span><span class="token punctuation">,</span><span class="token number">04</span><span class="token punctuation">,</span><span class="token number">02</span><span class="token punctuation">,</span><span class="token number">01</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> totrot<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">,</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">,</span><span class="token number">28</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> bigbyte<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
	<span class="token number">0x800000L</span><span class="token punctuation">,</span>	<span class="token number">0x400000L</span><span class="token punctuation">,</span>	<span class="token number">0x200000L</span><span class="token punctuation">,</span>	<span class="token number">0x100000L</span><span class="token punctuation">,</span>
	<span class="token number">0x80000L</span><span class="token punctuation">,</span>	<span class="token number">0x40000L</span><span class="token punctuation">,</span>	<span class="token number">0x20000L</span><span class="token punctuation">,</span>	<span class="token number">0x10000L</span><span class="token punctuation">,</span>
	<span class="token number">0x8000L</span><span class="token punctuation">,</span>	<span class="token number">0x4000L</span><span class="token punctuation">,</span>	<span class="token number">0x2000L</span><span class="token punctuation">,</span>	<span class="token number">0x1000L</span><span class="token punctuation">,</span>
	<span class="token number">0x800L</span><span class="token punctuation">,</span>		<span class="token number">0x400L</span><span class="token punctuation">,</span>		<span class="token number">0x200L</span><span class="token punctuation">,</span>		<span class="token number">0x100L</span><span class="token punctuation">,</span>
	<span class="token number">0x80L</span><span class="token punctuation">,</span>		<span class="token number">0x40L</span><span class="token punctuation">,</span>		<span class="token number">0x20L</span><span class="token punctuation">,</span>		<span class="token number">0x10L</span><span class="token punctuation">,</span>
	<span class="token number">0x8L</span><span class="token punctuation">,</span>		<span class="token number">0x4L</span><span class="token punctuation">,</span>		<span class="token number">0x2L</span><span class="token punctuation">,</span>		<span class="token number">0x1L</span>	<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//insert digits</span>
<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> SP1<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token punctuation">&#123;</span>
       <span class="token number">0x01010400l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x00010000l</span><span class="token punctuation">,</span><span class="token number">0x01010404l</span><span class="token punctuation">,</span>
       <span class="token number">0x01010004l</span><span class="token punctuation">,</span><span class="token number">0x00010404l</span><span class="token punctuation">,</span><span class="token number">0x00000004l</span><span class="token punctuation">,</span><span class="token number">0x00010000l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000400l</span><span class="token punctuation">,</span><span class="token number">0x01010400l</span><span class="token punctuation">,</span><span class="token number">0x01010404l</span><span class="token punctuation">,</span><span class="token number">0x00000400l</span><span class="token punctuation">,</span>
       <span class="token number">0x01000404l</span><span class="token punctuation">,</span><span class="token number">0x01010004l</span><span class="token punctuation">,</span><span class="token number">0x01000000l</span><span class="token punctuation">,</span><span class="token number">0x00000004l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000404l</span><span class="token punctuation">,</span><span class="token number">0x01000400l</span><span class="token punctuation">,</span><span class="token number">0x01000400l</span><span class="token punctuation">,</span><span class="token number">0x00010400l</span><span class="token punctuation">,</span>
       <span class="token number">0x00010400l</span><span class="token punctuation">,</span><span class="token number">0x01010000l</span><span class="token punctuation">,</span><span class="token number">0x01010000l</span><span class="token punctuation">,</span><span class="token number">0x01000404l</span><span class="token punctuation">,</span>
       <span class="token number">0x00010004l</span><span class="token punctuation">,</span><span class="token number">0x01000004l</span><span class="token punctuation">,</span><span class="token number">0x01000004l</span><span class="token punctuation">,</span><span class="token number">0x00010004l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x00000404l</span><span class="token punctuation">,</span><span class="token number">0x00010404l</span><span class="token punctuation">,</span><span class="token number">0x01000000l</span><span class="token punctuation">,</span>
       <span class="token number">0x00010000l</span><span class="token punctuation">,</span><span class="token number">0x01010404l</span><span class="token punctuation">,</span><span class="token number">0x00000004l</span><span class="token punctuation">,</span><span class="token number">0x01010000l</span><span class="token punctuation">,</span>
       <span class="token number">0x01010400l</span><span class="token punctuation">,</span><span class="token number">0x01000000l</span><span class="token punctuation">,</span><span class="token number">0x01000000l</span><span class="token punctuation">,</span><span class="token number">0x00000400l</span><span class="token punctuation">,</span>
       <span class="token number">0x01010004l</span><span class="token punctuation">,</span><span class="token number">0x00010000l</span><span class="token punctuation">,</span><span class="token number">0x00010400l</span><span class="token punctuation">,</span><span class="token number">0x01000004l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000400l</span><span class="token punctuation">,</span><span class="token number">0x00000004l</span><span class="token punctuation">,</span><span class="token number">0x01000404l</span><span class="token punctuation">,</span><span class="token number">0x00010404l</span><span class="token punctuation">,</span>
       <span class="token number">0x01010404l</span><span class="token punctuation">,</span><span class="token number">0x00010004l</span><span class="token punctuation">,</span><span class="token number">0x01010000l</span><span class="token punctuation">,</span><span class="token number">0x01000404l</span><span class="token punctuation">,</span>
       <span class="token number">0x01000004l</span><span class="token punctuation">,</span><span class="token number">0x00000404l</span><span class="token punctuation">,</span><span class="token number">0x00010404l</span><span class="token punctuation">,</span><span class="token number">0x01010400l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000404l</span><span class="token punctuation">,</span><span class="token number">0x01000400l</span><span class="token punctuation">,</span><span class="token number">0x01000400l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span>
       <span class="token number">0x00010004l</span><span class="token punctuation">,</span><span class="token number">0x00010400l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x01010004l</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
       
       
<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> SP2<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>
       <span class="token number">0x80108020l</span><span class="token punctuation">,</span><span class="token number">0x80008000l</span><span class="token punctuation">,</span><span class="token number">0x00008000l</span><span class="token punctuation">,</span><span class="token number">0x00108020l</span><span class="token punctuation">,</span>
       <span class="token number">0x00100000l</span><span class="token punctuation">,</span><span class="token number">0x00000020l</span><span class="token punctuation">,</span><span class="token number">0x80100020l</span><span class="token punctuation">,</span><span class="token number">0x80008020l</span><span class="token punctuation">,</span>
       <span class="token number">0x80000020l</span><span class="token punctuation">,</span><span class="token number">0x80108020l</span><span class="token punctuation">,</span><span class="token number">0x80108000l</span><span class="token punctuation">,</span><span class="token number">0x80000000l</span><span class="token punctuation">,</span>
       <span class="token number">0x80008000l</span><span class="token punctuation">,</span><span class="token number">0x00100000l</span><span class="token punctuation">,</span><span class="token number">0x00000020l</span><span class="token punctuation">,</span><span class="token number">0x80100020l</span><span class="token punctuation">,</span>
       <span class="token number">0x00108000l</span><span class="token punctuation">,</span><span class="token number">0x00100020l</span><span class="token punctuation">,</span><span class="token number">0x80008020l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span>
       <span class="token number">0x80000000l</span><span class="token punctuation">,</span><span class="token number">0x00008000l</span><span class="token punctuation">,</span><span class="token number">0x00108020l</span><span class="token punctuation">,</span><span class="token number">0x80100000l</span><span class="token punctuation">,</span>
       <span class="token number">0x00100020l</span><span class="token punctuation">,</span><span class="token number">0x80000020l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x00108000l</span><span class="token punctuation">,</span>
       <span class="token number">0x00008020l</span><span class="token punctuation">,</span><span class="token number">0x80108000l</span><span class="token punctuation">,</span><span class="token number">0x80100000l</span><span class="token punctuation">,</span><span class="token number">0x00008020l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x00108020l</span><span class="token punctuation">,</span><span class="token number">0x80100020l</span><span class="token punctuation">,</span><span class="token number">0x00100000l</span><span class="token punctuation">,</span>
       <span class="token number">0x80008020l</span><span class="token punctuation">,</span><span class="token number">0x80100000l</span><span class="token punctuation">,</span><span class="token number">0x80108000l</span><span class="token punctuation">,</span><span class="token number">0x00008000l</span><span class="token punctuation">,</span>
       <span class="token number">0x80100000l</span><span class="token punctuation">,</span><span class="token number">0x80008000l</span><span class="token punctuation">,</span><span class="token number">0x00000020l</span><span class="token punctuation">,</span><span class="token number">0x80108020l</span><span class="token punctuation">,</span>
       <span class="token number">0x00108020l</span><span class="token punctuation">,</span><span class="token number">0x00000020l</span><span class="token punctuation">,</span><span class="token number">0x00008000l</span><span class="token punctuation">,</span><span class="token number">0x80000000l</span><span class="token punctuation">,</span>
       <span class="token number">0x00008020l</span><span class="token punctuation">,</span><span class="token number">0x80108000l</span><span class="token punctuation">,</span><span class="token number">0x00100000l</span><span class="token punctuation">,</span><span class="token number">0x80000020l</span><span class="token punctuation">,</span>
       <span class="token number">0x00100020l</span><span class="token punctuation">,</span><span class="token number">0x80008020l</span><span class="token punctuation">,</span><span class="token number">0x80000020l</span><span class="token punctuation">,</span><span class="token number">0x00100020l</span><span class="token punctuation">,</span>
       <span class="token number">0x00108000l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x80008000l</span><span class="token punctuation">,</span><span class="token number">0x00008020l</span><span class="token punctuation">,</span>
       <span class="token number">0x80000000l</span><span class="token punctuation">,</span><span class="token number">0x80100020l</span><span class="token punctuation">,</span><span class="token number">0x80108020l</span><span class="token punctuation">,</span><span class="token number">0x00108000l</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
       
       
<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> SP3<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span> 
       <span class="token number">0x00000208l</span><span class="token punctuation">,</span><span class="token number">0x08020200l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x08020008l</span><span class="token punctuation">,</span>
       <span class="token number">0x08000200l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x00020208l</span><span class="token punctuation">,</span><span class="token number">0x08000200l</span><span class="token punctuation">,</span>
       <span class="token number">0x00020008l</span><span class="token punctuation">,</span><span class="token number">0x08000008l</span><span class="token punctuation">,</span><span class="token number">0x08000008l</span><span class="token punctuation">,</span><span class="token number">0x00020000l</span><span class="token punctuation">,</span>
       <span class="token number">0x08020208l</span><span class="token punctuation">,</span><span class="token number">0x00020008l</span><span class="token punctuation">,</span><span class="token number">0x08020000l</span><span class="token punctuation">,</span><span class="token number">0x00000208l</span><span class="token punctuation">,</span>
       <span class="token number">0x08000000l</span><span class="token punctuation">,</span><span class="token number">0x00000008l</span><span class="token punctuation">,</span><span class="token number">0x08020200l</span><span class="token punctuation">,</span><span class="token number">0x00000200l</span><span class="token punctuation">,</span>
       <span class="token number">0x00020200l</span><span class="token punctuation">,</span><span class="token number">0x08020000l</span><span class="token punctuation">,</span><span class="token number">0x08020008l</span><span class="token punctuation">,</span><span class="token number">0x00020208l</span><span class="token punctuation">,</span>
       <span class="token number">0x08000208l</span><span class="token punctuation">,</span><span class="token number">0x00020200l</span><span class="token punctuation">,</span><span class="token number">0x00020000l</span><span class="token punctuation">,</span><span class="token number">0x08000208l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000008l</span><span class="token punctuation">,</span><span class="token number">0x08020208l</span><span class="token punctuation">,</span><span class="token number">0x00000200l</span><span class="token punctuation">,</span><span class="token number">0x08000000l</span><span class="token punctuation">,</span>
       <span class="token number">0x08020200l</span><span class="token punctuation">,</span><span class="token number">0x08000000l</span><span class="token punctuation">,</span><span class="token number">0x00020008l</span><span class="token punctuation">,</span><span class="token number">0x00000208l</span><span class="token punctuation">,</span>
       <span class="token number">0x00020000l</span><span class="token punctuation">,</span><span class="token number">0x08020200l</span><span class="token punctuation">,</span><span class="token number">0x08000200l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000200l</span><span class="token punctuation">,</span><span class="token number">0x00020008l</span><span class="token punctuation">,</span><span class="token number">0x08020208l</span><span class="token punctuation">,</span><span class="token number">0x08000200l</span><span class="token punctuation">,</span>
       <span class="token number">0x08000008l</span><span class="token punctuation">,</span><span class="token number">0x00000200l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x08020008l</span><span class="token punctuation">,</span>
       <span class="token number">0x08000208l</span><span class="token punctuation">,</span><span class="token number">0x00020000l</span><span class="token punctuation">,</span><span class="token number">0x08000000l</span><span class="token punctuation">,</span><span class="token number">0x08020208l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000008l</span><span class="token punctuation">,</span><span class="token number">0x00020208l</span><span class="token punctuation">,</span><span class="token number">0x00020200l</span><span class="token punctuation">,</span><span class="token number">0x08000008l</span><span class="token punctuation">,</span>
       <span class="token number">0x08020000l</span><span class="token punctuation">,</span><span class="token number">0x08000208l</span><span class="token punctuation">,</span><span class="token number">0x00000208l</span><span class="token punctuation">,</span><span class="token number">0x08020000l</span><span class="token punctuation">,</span>
       <span class="token number">0x00020208l</span><span class="token punctuation">,</span><span class="token number">0x00000008l</span><span class="token punctuation">,</span><span class="token number">0x08020008l</span><span class="token punctuation">,</span><span class="token number">0x00020200l</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
       
       
<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> SP4<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>             
       <span class="token number">0x00802001l</span><span class="token punctuation">,</span><span class="token number">0x00002081l</span><span class="token punctuation">,</span><span class="token number">0x00002081l</span><span class="token punctuation">,</span><span class="token number">0x00000080l</span><span class="token punctuation">,</span>
       <span class="token number">0x00802080l</span><span class="token punctuation">,</span><span class="token number">0x00800081l</span><span class="token punctuation">,</span><span class="token number">0x00800001l</span><span class="token punctuation">,</span><span class="token number">0x00002001l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x00802000l</span><span class="token punctuation">,</span><span class="token number">0x00802000l</span><span class="token punctuation">,</span><span class="token number">0x00802081l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000081l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x00800080l</span><span class="token punctuation">,</span><span class="token number">0x00800001l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000001l</span><span class="token punctuation">,</span><span class="token number">0x00002000l</span><span class="token punctuation">,</span><span class="token number">0x00800000l</span><span class="token punctuation">,</span><span class="token number">0x00802001l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000080l</span><span class="token punctuation">,</span><span class="token number">0x00800000l</span><span class="token punctuation">,</span><span class="token number">0x00002001l</span><span class="token punctuation">,</span><span class="token number">0x00002080l</span><span class="token punctuation">,</span>
       <span class="token number">0x00800081l</span><span class="token punctuation">,</span><span class="token number">0x00000001l</span><span class="token punctuation">,</span><span class="token number">0x00002080l</span><span class="token punctuation">,</span><span class="token number">0x00800080l</span><span class="token punctuation">,</span>
       <span class="token number">0x00002000l</span><span class="token punctuation">,</span><span class="token number">0x00802080l</span><span class="token punctuation">,</span><span class="token number">0x00802081l</span><span class="token punctuation">,</span><span class="token number">0x00000081l</span><span class="token punctuation">,</span>
       <span class="token number">0x00800080l</span><span class="token punctuation">,</span><span class="token number">0x00800001l</span><span class="token punctuation">,</span><span class="token number">0x00802000l</span><span class="token punctuation">,</span><span class="token number">0x00802081l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000081l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x00802000l</span><span class="token punctuation">,</span>
       <span class="token number">0x00002080l</span><span class="token punctuation">,</span><span class="token number">0x00800080l</span><span class="token punctuation">,</span><span class="token number">0x00800081l</span><span class="token punctuation">,</span><span class="token number">0x00000001l</span><span class="token punctuation">,</span>
       <span class="token number">0x00802001l</span><span class="token punctuation">,</span><span class="token number">0x00002081l</span><span class="token punctuation">,</span><span class="token number">0x00002081l</span><span class="token punctuation">,</span><span class="token number">0x00000080l</span><span class="token punctuation">,</span>
       <span class="token number">0x00802081l</span><span class="token punctuation">,</span><span class="token number">0x00000081l</span><span class="token punctuation">,</span><span class="token number">0x00000001l</span><span class="token punctuation">,</span><span class="token number">0x00002000l</span><span class="token punctuation">,</span>
       <span class="token number">0x00800001l</span><span class="token punctuation">,</span><span class="token number">0x00002001l</span><span class="token punctuation">,</span><span class="token number">0x00802080l</span><span class="token punctuation">,</span><span class="token number">0x00800081l</span><span class="token punctuation">,</span>
       <span class="token number">0x00002001l</span><span class="token punctuation">,</span><span class="token number">0x00002080l</span><span class="token punctuation">,</span><span class="token number">0x00800000l</span><span class="token punctuation">,</span><span class="token number">0x00802001l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000080l</span><span class="token punctuation">,</span><span class="token number">0x00800000l</span><span class="token punctuation">,</span><span class="token number">0x00002000l</span><span class="token punctuation">,</span><span class="token number">0x00802080l</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
       
       
<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> SP5<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>   
       <span class="token number">0x00000100l</span><span class="token punctuation">,</span><span class="token number">0x02080100l</span><span class="token punctuation">,</span><span class="token number">0x02080000l</span><span class="token punctuation">,</span><span class="token number">0x42000100l</span><span class="token punctuation">,</span>
       <span class="token number">0x00080000l</span><span class="token punctuation">,</span><span class="token number">0x00000100l</span><span class="token punctuation">,</span><span class="token number">0x40000000l</span><span class="token punctuation">,</span><span class="token number">0x02080000l</span><span class="token punctuation">,</span>
       <span class="token number">0x40080100l</span><span class="token punctuation">,</span><span class="token number">0x00080000l</span><span class="token punctuation">,</span><span class="token number">0x02000100l</span><span class="token punctuation">,</span><span class="token number">0x40080100l</span><span class="token punctuation">,</span>
       <span class="token number">0x42000100l</span><span class="token punctuation">,</span><span class="token number">0x42080000l</span><span class="token punctuation">,</span><span class="token number">0x00080100l</span><span class="token punctuation">,</span><span class="token number">0x40000000l</span><span class="token punctuation">,</span>
       <span class="token number">0x02000000l</span><span class="token punctuation">,</span><span class="token number">0x40080000l</span><span class="token punctuation">,</span><span class="token number">0x40080000l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span>
       <span class="token number">0x40000100l</span><span class="token punctuation">,</span><span class="token number">0x42080100l</span><span class="token punctuation">,</span><span class="token number">0x42080100l</span><span class="token punctuation">,</span><span class="token number">0x02000100l</span><span class="token punctuation">,</span>
       <span class="token number">0x42080000l</span><span class="token punctuation">,</span><span class="token number">0x40000100l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x42000000l</span><span class="token punctuation">,</span>
       <span class="token number">0x02080100l</span><span class="token punctuation">,</span><span class="token number">0x02000000l</span><span class="token punctuation">,</span><span class="token number">0x42000000l</span><span class="token punctuation">,</span><span class="token number">0x00080100l</span><span class="token punctuation">,</span>
       <span class="token number">0x00080000l</span><span class="token punctuation">,</span><span class="token number">0x42000100l</span><span class="token punctuation">,</span><span class="token number">0x00000100l</span><span class="token punctuation">,</span><span class="token number">0x02000000l</span><span class="token punctuation">,</span>
       <span class="token number">0x40000000l</span><span class="token punctuation">,</span><span class="token number">0x02080000l</span><span class="token punctuation">,</span><span class="token number">0x42000100l</span><span class="token punctuation">,</span><span class="token number">0x40080100l</span><span class="token punctuation">,</span>
       <span class="token number">0x02000100l</span><span class="token punctuation">,</span><span class="token number">0x40000000l</span><span class="token punctuation">,</span><span class="token number">0x42080000l</span><span class="token punctuation">,</span><span class="token number">0x02080100l</span><span class="token punctuation">,</span>
       <span class="token number">0x40080100l</span><span class="token punctuation">,</span><span class="token number">0x00000100l</span><span class="token punctuation">,</span><span class="token number">0x20000000l</span><span class="token punctuation">,</span><span class="token number">0x42080000l</span><span class="token punctuation">,</span>
       <span class="token number">0x42080100l</span><span class="token punctuation">,</span><span class="token number">0x00080100l</span><span class="token punctuation">,</span><span class="token number">0x42000000l</span><span class="token punctuation">,</span><span class="token number">0x42080100l</span><span class="token punctuation">,</span>
       <span class="token number">0x02080000l</span><span class="token punctuation">,</span><span class="token number">0x02000100l</span><span class="token punctuation">,</span><span class="token number">0x40000100l</span><span class="token punctuation">,</span><span class="token number">0x00080000l</span><span class="token punctuation">,</span>
       <span class="token number">0x00080100l</span><span class="token punctuation">,</span><span class="token number">0x02000100l</span><span class="token punctuation">,</span><span class="token number">0x40000100l</span><span class="token punctuation">,</span><span class="token number">0x00080000l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x40080000l</span><span class="token punctuation">,</span><span class="token number">0x02080100l</span><span class="token punctuation">,</span><span class="token number">0x40000100l</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
       
       
<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> SP6<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">&#123;</span> 
       <span class="token number">0x20000010l</span><span class="token punctuation">,</span><span class="token number">0x20400000l</span><span class="token punctuation">,</span><span class="token number">0x00004000l</span><span class="token punctuation">,</span><span class="token number">0x20404010l</span><span class="token punctuation">,</span>
       <span class="token number">0x20400000l</span><span class="token punctuation">,</span><span class="token number">0x00000010l</span><span class="token punctuation">,</span><span class="token number">0x20404010l</span><span class="token punctuation">,</span><span class="token number">0x00400000l</span><span class="token punctuation">,</span>
       <span class="token number">0x20004000l</span><span class="token punctuation">,</span><span class="token number">0x00404010l</span><span class="token punctuation">,</span><span class="token number">0x00400000l</span><span class="token punctuation">,</span><span class="token number">0x20000010l</span><span class="token punctuation">,</span>
       <span class="token number">0x00400010l</span><span class="token punctuation">,</span><span class="token number">0x20004000l</span><span class="token punctuation">,</span><span class="token number">0x20000000l</span><span class="token punctuation">,</span><span class="token number">0x00004010l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x00400010l</span><span class="token punctuation">,</span><span class="token number">0x20004010l</span><span class="token punctuation">,</span><span class="token number">0x00004000l</span><span class="token punctuation">,</span>
       <span class="token number">0x00404000l</span><span class="token punctuation">,</span><span class="token number">0x20004010l</span><span class="token punctuation">,</span><span class="token number">0x00000010l</span><span class="token punctuation">,</span><span class="token number">0x20400010l</span><span class="token punctuation">,</span>
       <span class="token number">0x20400010l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x00404010l</span><span class="token punctuation">,</span><span class="token number">0x20404000l</span><span class="token punctuation">,</span>
       <span class="token number">0x00004010l</span><span class="token punctuation">,</span><span class="token number">0x00404000l</span><span class="token punctuation">,</span><span class="token number">0x20404000l</span><span class="token punctuation">,</span><span class="token number">0x20000000l</span><span class="token punctuation">,</span>
       <span class="token number">0x20004000l</span><span class="token punctuation">,</span><span class="token number">0x00000010l</span><span class="token punctuation">,</span><span class="token number">0x20400010l</span><span class="token punctuation">,</span><span class="token number">0x00404000l</span><span class="token punctuation">,</span>
       <span class="token number">0x20404010l</span><span class="token punctuation">,</span><span class="token number">0x00400000l</span><span class="token punctuation">,</span><span class="token number">0x00004010l</span><span class="token punctuation">,</span><span class="token number">0x20000010l</span><span class="token punctuation">,</span>
       <span class="token number">0x00400000l</span><span class="token punctuation">,</span><span class="token number">0x20004000l</span><span class="token punctuation">,</span><span class="token number">0x20000000l</span><span class="token punctuation">,</span><span class="token number">0x00004010l</span><span class="token punctuation">,</span>
       <span class="token number">0x20000010l</span><span class="token punctuation">,</span><span class="token number">0x20404010l</span><span class="token punctuation">,</span><span class="token number">0x00404000l</span><span class="token punctuation">,</span><span class="token number">0x20400000l</span><span class="token punctuation">,</span>
       <span class="token number">0x00404010l</span><span class="token punctuation">,</span><span class="token number">0x20404000l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span><span class="token number">0x20400010l</span><span class="token punctuation">,</span>
       <span class="token number">0x00000010l</span><span class="token punctuation">,</span><span class="token number">0x00004000l</span><span class="token punctuation">,</span><span class="token number">0x20400000l</span><span class="token punctuation">,</span><span class="token number">0x00404010l</span><span class="token punctuation">,</span>
       <span class="token number">0x00004000l</span><span class="token punctuation">,</span><span class="token number">0x00400010l</span><span class="token punctuation">,</span><span class="token number">0x20004010l</span><span class="token punctuation">,</span><span class="token number">0x00000000l</span><span class="token punctuation">,</span>
       <span class="token number">0x20404000l</span><span class="token punctuation">,</span><span class="token number">0x20000000l</span><span class="token punctuation">,</span><span class="token number">0x00400010l</span><span class="token punctuation">,</span><span class="token number">0x20004010l</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  
            
<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> SP7<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
	<span class="token number">0x00200000L</span><span class="token punctuation">,</span> <span class="token number">0x04200002L</span><span class="token punctuation">,</span> <span class="token number">0x04000802L</span><span class="token punctuation">,</span> <span class="token number">0x00000000L</span><span class="token punctuation">,</span>
	<span class="token number">0x00000800L</span><span class="token punctuation">,</span> <span class="token number">0x04000802L</span><span class="token punctuation">,</span> <span class="token number">0x00200802L</span><span class="token punctuation">,</span> <span class="token number">0x04200800L</span><span class="token punctuation">,</span>
	<span class="token number">0x04200802L</span><span class="token punctuation">,</span> <span class="token number">0x00200000L</span><span class="token punctuation">,</span> <span class="token number">0x00000000L</span><span class="token punctuation">,</span> <span class="token number">0x04000002L</span><span class="token punctuation">,</span>
	<span class="token number">0x00000002L</span><span class="token punctuation">,</span> <span class="token number">0x04000000L</span><span class="token punctuation">,</span> <span class="token number">0x04200002L</span><span class="token punctuation">,</span> <span class="token number">0x00000802L</span><span class="token punctuation">,</span>
	<span class="token number">0x04000800L</span><span class="token punctuation">,</span> <span class="token number">0x00200802L</span><span class="token punctuation">,</span> <span class="token number">0x00200002L</span><span class="token punctuation">,</span> <span class="token number">0x04000800L</span><span class="token punctuation">,</span>
	<span class="token number">0x04000002L</span><span class="token punctuation">,</span> <span class="token number">0x04200000L</span><span class="token punctuation">,</span> <span class="token number">0x04200800L</span><span class="token punctuation">,</span> <span class="token number">0x00200002L</span><span class="token punctuation">,</span>
	<span class="token number">0x04200000L</span><span class="token punctuation">,</span> <span class="token number">0x00000800L</span><span class="token punctuation">,</span> <span class="token number">0x00000802L</span><span class="token punctuation">,</span> <span class="token number">0x04200802L</span><span class="token punctuation">,</span>
	<span class="token number">0x00200800L</span><span class="token punctuation">,</span> <span class="token number">0x00000002L</span><span class="token punctuation">,</span> <span class="token number">0x04000000L</span><span class="token punctuation">,</span> <span class="token number">0x00200800L</span><span class="token punctuation">,</span>
	<span class="token number">0x04000000L</span><span class="token punctuation">,</span> <span class="token number">0x00200800L</span><span class="token punctuation">,</span> <span class="token number">0x00200000L</span><span class="token punctuation">,</span> <span class="token number">0x04000802L</span><span class="token punctuation">,</span>
	<span class="token number">0x04000802L</span><span class="token punctuation">,</span> <span class="token number">0x04200002L</span><span class="token punctuation">,</span> <span class="token number">0x04200002L</span><span class="token punctuation">,</span> <span class="token number">0x00000002L</span><span class="token punctuation">,</span>
	<span class="token number">0x00200002L</span><span class="token punctuation">,</span> <span class="token number">0x04000000L</span><span class="token punctuation">,</span> <span class="token number">0x04000800L</span><span class="token punctuation">,</span> <span class="token number">0x00200000L</span><span class="token punctuation">,</span>
	<span class="token number">0x04200800L</span><span class="token punctuation">,</span> <span class="token number">0x00000802L</span><span class="token punctuation">,</span> <span class="token number">0x00200802L</span><span class="token punctuation">,</span> <span class="token number">0x04200800L</span><span class="token punctuation">,</span>
	<span class="token number">0x00000802L</span><span class="token punctuation">,</span> <span class="token number">0x04000002L</span><span class="token punctuation">,</span> <span class="token number">0x04200802L</span><span class="token punctuation">,</span> <span class="token number">0x04200000L</span><span class="token punctuation">,</span>
	<span class="token number">0x00200800L</span><span class="token punctuation">,</span> <span class="token number">0x00000000L</span><span class="token punctuation">,</span> <span class="token number">0x00000002L</span><span class="token punctuation">,</span> <span class="token number">0x04200802L</span><span class="token punctuation">,</span>
	<span class="token number">0x00000000L</span><span class="token punctuation">,</span> <span class="token number">0x00200802L</span><span class="token punctuation">,</span> <span class="token number">0x04200000L</span><span class="token punctuation">,</span> <span class="token number">0x00000800L</span><span class="token punctuation">,</span>
	<span class="token number">0x04000002L</span><span class="token punctuation">,</span> <span class="token number">0x04000800L</span><span class="token punctuation">,</span> <span class="token number">0x00000800L</span><span class="token punctuation">,</span> <span class="token number">0x00200002L</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	
<span class="token keyword">static</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> SP8<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
	<span class="token number">0x10001040L</span><span class="token punctuation">,</span> <span class="token number">0x00001000L</span><span class="token punctuation">,</span> <span class="token number">0x00040000L</span><span class="token punctuation">,</span> <span class="token number">0x10041040L</span><span class="token punctuation">,</span>
	<span class="token number">0x10000000L</span><span class="token punctuation">,</span> <span class="token number">0x10001040L</span><span class="token punctuation">,</span> <span class="token number">0x00000040L</span><span class="token punctuation">,</span> <span class="token number">0x10000000L</span><span class="token punctuation">,</span>
	<span class="token number">0x00040040L</span><span class="token punctuation">,</span> <span class="token number">0x10040000L</span><span class="token punctuation">,</span> <span class="token number">0x10041040L</span><span class="token punctuation">,</span> <span class="token number">0x00041000L</span><span class="token punctuation">,</span>
	<span class="token number">0x10041000L</span><span class="token punctuation">,</span> <span class="token number">0x00041040L</span><span class="token punctuation">,</span> <span class="token number">0x00001000L</span><span class="token punctuation">,</span> <span class="token number">0x00000040L</span><span class="token punctuation">,</span>
	<span class="token number">0x10040000L</span><span class="token punctuation">,</span> <span class="token number">0x10000040L</span><span class="token punctuation">,</span> <span class="token number">0x10001000L</span><span class="token punctuation">,</span> <span class="token number">0x00001040L</span><span class="token punctuation">,</span>
	<span class="token number">0x00041000L</span><span class="token punctuation">,</span> <span class="token number">0x00040040L</span><span class="token punctuation">,</span> <span class="token number">0x10040040L</span><span class="token punctuation">,</span> <span class="token number">0x10041000L</span><span class="token punctuation">,</span>
	<span class="token number">0x00001040L</span><span class="token punctuation">,</span> <span class="token number">0x00000000L</span><span class="token punctuation">,</span> <span class="token number">0x00000000L</span><span class="token punctuation">,</span> <span class="token number">0x10040040L</span><span class="token punctuation">,</span>
	<span class="token number">0x10000040L</span><span class="token punctuation">,</span> <span class="token number">0x10001000L</span><span class="token punctuation">,</span> <span class="token number">0x00041040L</span><span class="token punctuation">,</span> <span class="token number">0x00040000L</span><span class="token punctuation">,</span>
	<span class="token number">0x00041040L</span><span class="token punctuation">,</span> <span class="token number">0x00040000L</span><span class="token punctuation">,</span> <span class="token number">0x10041000L</span><span class="token punctuation">,</span> <span class="token number">0x00001000L</span><span class="token punctuation">,</span>
	<span class="token number">0x00000040L</span><span class="token punctuation">,</span> <span class="token number">0x10040040L</span><span class="token punctuation">,</span> <span class="token number">0x00001000L</span><span class="token punctuation">,</span> <span class="token number">0x00041040L</span><span class="token punctuation">,</span>
	<span class="token number">0x10001000L</span><span class="token punctuation">,</span> <span class="token number">0x00000040L</span><span class="token punctuation">,</span> <span class="token number">0x10000040L</span><span class="token punctuation">,</span> <span class="token number">0x10040000L</span><span class="token punctuation">,</span>
	<span class="token number">0x10040040L</span><span class="token punctuation">,</span> <span class="token number">0x10000000L</span><span class="token punctuation">,</span> <span class="token number">0x00040000L</span><span class="token punctuation">,</span> <span class="token number">0x10001040L</span><span class="token punctuation">,</span>
	<span class="token number">0x00000000L</span><span class="token punctuation">,</span> <span class="token number">0x10041040L</span><span class="token punctuation">,</span> <span class="token number">0x00040040L</span><span class="token punctuation">,</span> <span class="token number">0x10000040L</span><span class="token punctuation">,</span>
	<span class="token number">0x10040000L</span><span class="token punctuation">,</span> <span class="token number">0x10001000L</span><span class="token punctuation">,</span> <span class="token number">0x10001040L</span><span class="token punctuation">,</span> <span class="token number">0x00000000L</span><span class="token punctuation">,</span>
	<span class="token number">0x10041040L</span><span class="token punctuation">,</span> <span class="token number">0x00041000L</span><span class="token punctuation">,</span> <span class="token number">0x00041000L</span><span class="token punctuation">,</span> <span class="token number">0x00001040L</span><span class="token punctuation">,</span>
	<span class="token number">0x00001040L</span><span class="token punctuation">,</span> <span class="token number">0x00040040L</span><span class="token punctuation">,</span> <span class="token number">0x10000000L</span><span class="token punctuation">,</span> <span class="token number">0x10041000L</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">deskey</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>key<span class="token punctuation">,</span><span class="token keyword">short</span> edf<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>kn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">cookey</span><span class="token punctuation">(</span><span class="token keyword">register</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>raw1<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>dough<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//void cpkey(register unsigned long *into);</span>
<span class="token comment">//void usekey(register unsigned long *from);</span>
<span class="token comment">//void des(unsigned char *inblock,unsigned char *outblock);</span>
<span class="token keyword">void</span> <span class="token function">scrunch</span><span class="token punctuation">(</span><span class="token keyword">register</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>outof<span class="token punctuation">,</span> <span class="token keyword">register</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>into<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">unscrun</span><span class="token punctuation">(</span><span class="token keyword">register</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>outof<span class="token punctuation">,</span> <span class="token keyword">register</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>into<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">desfunc</span><span class="token punctuation">(</span><span class="token keyword">register</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>block<span class="token punctuation">,</span><span class="token keyword">register</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>keys<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*****************  DES Function  *****************/</span>
<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">OPENCOMM_DesExpandEncKey</span><span class="token punctuation">(</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbDesKey<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span>  ulDesKeyLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbDesEncKey<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>ulDesEncKeyLen<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">OPENCOMM_DesExpandDecKey</span><span class="token punctuation">(</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbDesKey<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span>  ulDesKeyLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbDesDecKey<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>ulDesDecKeyLen<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">OPENCOMM_DesEncRaw</span><span class="token punctuation">(</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbDesEncKey<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span>  ulDesEncKeyLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbInData<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span>  ulInDataLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbOutData<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>ulOutDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">OPENCOMM_DesDecRaw</span><span class="token punctuation">(</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbDesDecKey<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span>  ulDesDecKeyLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbInData<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span>  ulInDataLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbOutData<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>ulOutDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">int</span> <span class="token function">myic_DESDecrypt</span><span class="token punctuation">(</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pDesKey<span class="token punctuation">,</span>
		<span class="token keyword">int</span>            nDesKeyLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pInData<span class="token punctuation">,</span>
		<span class="token keyword">int</span>            nInDataLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pOutData<span class="token punctuation">,</span>
		<span class="token keyword">int</span>           <span class="token operator">*</span>pOutDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">myic_DESEncrypt</span><span class="token punctuation">(</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pDesKey<span class="token punctuation">,</span>
		<span class="token keyword">int</span>            nDesKeyLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pInData<span class="token punctuation">,</span>
		<span class="token keyword">int</span>            nInDataLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pOutData<span class="token punctuation">,</span>
		<span class="token keyword">int</span>           <span class="token operator">*</span>pOutDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">void</span> <span class="token function">deskey</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>key<span class="token punctuation">,</span><span class="token keyword">short</span> edf<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>kn<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">register</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> l<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> pc1m<span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">,</span>pcr<span class="token punctuation">[</span><span class="token number">56</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	
	
	<span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">56</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">)</span> 
	<span class="token punctuation">&#123;</span>
		l <span class="token operator">=</span> pc1<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
		m <span class="token operator">=</span> l <span class="token operator">&amp;</span> <span class="token number">07</span><span class="token punctuation">;</span>
		pc1m<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span><span class="token punctuation">)</span> key<span class="token punctuation">[</span>l <span class="token operator">>></span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span><span class="token punctuation">)</span>bytebit<span class="token punctuation">[</span>m<span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span> edf <span class="token operator">==</span> DE1 <span class="token punctuation">)</span>	m <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">15</span> <span class="token operator">-</span> i<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">else</span>	m <span class="token operator">=</span> i <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
		n <span class="token operator">=</span> m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
		kn<span class="token punctuation">[</span>m<span class="token punctuation">]</span> <span class="token operator">=</span> kn<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0L</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">28</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			l <span class="token operator">=</span> j <span class="token operator">+</span> totrot<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span> l <span class="token operator">&lt;</span> <span class="token number">28</span> <span class="token punctuation">)</span>	pcr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> pc1m<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span>	pcr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> pc1m<span class="token punctuation">[</span>l<span class="token operator">-</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">28</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">56</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">)</span> 
		<span class="token punctuation">&#123;</span>
			l <span class="token operator">=</span> j <span class="token operator">+</span> totrot<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span> l <span class="token operator">&lt;</span> <span class="token number">56</span> <span class="token punctuation">)</span>	pcr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> pc1m<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">else</span>	pcr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> pc1m<span class="token punctuation">[</span>l<span class="token operator">-</span><span class="token number">28</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span> 
		<span class="token keyword">for</span> <span class="token punctuation">(</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span> j<span class="token operator">++</span> <span class="token punctuation">)</span> 
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span> pcr<span class="token punctuation">[</span>pc2<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>	kn<span class="token punctuation">[</span>m<span class="token punctuation">]</span> <span class="token operator">|=</span> bigbyte<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span> pcr<span class="token punctuation">[</span>pc2<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>	kn<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">|=</span> bigbyte<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">cookey</span><span class="token punctuation">(</span><span class="token keyword">register</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>raw1<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>dough<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">register</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>cook<span class="token punctuation">,</span><span class="token operator">*</span>raw0<span class="token punctuation">;</span>
	<span class="token keyword">register</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span>
	
	cook <span class="token operator">=</span> dough<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">,</span> raw1<span class="token operator">++</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		raw0 <span class="token operator">=</span> raw1<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token operator">*</span>cook	 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span>raw0 <span class="token operator">&amp;</span> <span class="token number">0x00fc0000L</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span>
		<span class="token operator">*</span>cook	<span class="token operator">|=</span> <span class="token punctuation">(</span><span class="token operator">*</span>raw0 <span class="token operator">&amp;</span> <span class="token number">0x00000fc0L</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span>
		<span class="token operator">*</span>cook	<span class="token operator">|=</span> <span class="token punctuation">(</span><span class="token operator">*</span>raw1 <span class="token operator">&amp;</span> <span class="token number">0x00fc0000L</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">10</span><span class="token punctuation">;</span>
		<span class="token operator">*</span>cook<span class="token operator">++</span>	<span class="token operator">|=</span> <span class="token punctuation">(</span><span class="token operator">*</span>raw1 <span class="token operator">&amp;</span> <span class="token number">0x00000fc0L</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">6</span><span class="token punctuation">;</span>
		<span class="token operator">*</span>cook	 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span>raw0 <span class="token operator">&amp;</span> <span class="token number">0x0003f000L</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">12</span><span class="token punctuation">;</span>
		<span class="token operator">*</span>cook	<span class="token operator">|=</span> <span class="token punctuation">(</span><span class="token operator">*</span>raw0 <span class="token operator">&amp;</span> <span class="token number">0x0000003fL</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span>
		<span class="token operator">*</span>cook	<span class="token operator">|=</span> <span class="token punctuation">(</span><span class="token operator">*</span>raw1 <span class="token operator">&amp;</span> <span class="token number">0x0003f000L</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">;</span>
		<span class="token operator">*</span>cook<span class="token operator">++</span>	<span class="token operator">|=</span> <span class="token punctuation">(</span><span class="token operator">*</span>raw1 <span class="token operator">&amp;</span> <span class="token number">0x0000003fL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">scrunch</span><span class="token punctuation">(</span><span class="token keyword">register</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>outof<span class="token punctuation">,</span> <span class="token keyword">register</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>into<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token operator">*</span>into	 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span>outof<span class="token operator">++</span> <span class="token operator">&amp;</span> <span class="token number">0xffL</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>into	<span class="token operator">|=</span> <span class="token punctuation">(</span><span class="token operator">*</span>outof<span class="token operator">++</span> <span class="token operator">&amp;</span> <span class="token number">0xffL</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>into	<span class="token operator">|=</span> <span class="token punctuation">(</span><span class="token operator">*</span>outof<span class="token operator">++</span> <span class="token operator">&amp;</span> <span class="token number">0xffL</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>into<span class="token operator">++</span>	<span class="token operator">|=</span> <span class="token punctuation">(</span><span class="token operator">*</span>outof<span class="token operator">++</span> <span class="token operator">&amp;</span> <span class="token number">0xffL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>into	 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span>outof<span class="token operator">++</span> <span class="token operator">&amp;</span> <span class="token number">0xffL</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>into	<span class="token operator">|=</span> <span class="token punctuation">(</span><span class="token operator">*</span>outof<span class="token operator">++</span> <span class="token operator">&amp;</span> <span class="token number">0xffL</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>into	<span class="token operator">|=</span> <span class="token punctuation">(</span><span class="token operator">*</span>outof<span class="token operator">++</span> <span class="token operator">&amp;</span> <span class="token number">0xffL</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>into<span class="token operator">++</span>	<span class="token operator">|=</span> <span class="token punctuation">(</span><span class="token operator">*</span>outof   <span class="token operator">&amp;</span> <span class="token number">0xffL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">unscrun</span><span class="token punctuation">(</span><span class="token keyword">register</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>outof<span class="token punctuation">,</span> <span class="token keyword">register</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>into<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token operator">*</span>into<span class="token operator">++</span>	 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>outof <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>into<span class="token operator">++</span>	 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>outof <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>into<span class="token operator">++</span>	 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>outof <span class="token operator">>></span>  <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>into<span class="token operator">++</span>	 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span> <span class="token operator">*</span>outof<span class="token operator">++</span>	  <span class="token operator">&amp;</span> <span class="token number">0xffL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>into<span class="token operator">++</span>	 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>outof <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>into<span class="token operator">++</span>	 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>outof <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>into<span class="token operator">++</span>	 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">*</span>outof <span class="token operator">>></span>  <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>into	 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span> <span class="token operator">*</span>outof		  <span class="token operator">&amp;</span> <span class="token number">0xffL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">desfunc</span><span class="token punctuation">(</span><span class="token keyword">register</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>block<span class="token punctuation">,</span><span class="token keyword">register</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>keys<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">register</span> <span class="token keyword">unsigned</span> <span class="token keyword">long</span> fval<span class="token punctuation">,</span> work<span class="token punctuation">,</span> right<span class="token punctuation">,</span> leftt<span class="token punctuation">;</span>
	<span class="token keyword">register</span> <span class="token keyword">int</span> round<span class="token punctuation">;</span>
	
	leftt <span class="token operator">=</span> block<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	right <span class="token operator">=</span> block<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	work <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>leftt <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0f0f0f0fL</span><span class="token punctuation">;</span>
	
	right <span class="token operator">^=</span> work<span class="token punctuation">;</span>
	leftt <span class="token operator">^=</span> <span class="token punctuation">(</span>work <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	work <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>leftt <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0000ffffL</span><span class="token punctuation">;</span>
	
	right <span class="token operator">^=</span> work<span class="token punctuation">;</span>
	leftt <span class="token operator">^=</span> <span class="token punctuation">(</span>work <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	work <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">^</span> leftt<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x33333333L</span><span class="token punctuation">;</span>
	
	leftt <span class="token operator">^=</span> work<span class="token punctuation">;</span>
	right <span class="token operator">^=</span> <span class="token punctuation">(</span>work <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	work <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">^</span> leftt<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ffL</span><span class="token punctuation">;</span>
	
	leftt <span class="token operator">^=</span> work<span class="token punctuation">;</span>
	right <span class="token operator">^=</span> <span class="token punctuation">(</span>work <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	right <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">>></span><span class="token number">31</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffffL</span><span class="token punctuation">;</span>
	work <span class="token operator">=</span> <span class="token punctuation">(</span>leftt <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xaaaaaaaaL</span><span class="token punctuation">;</span>
	
	leftt <span class="token operator">^=</span> work<span class="token punctuation">;</span>
	right <span class="token operator">^=</span> work<span class="token punctuation">;</span>
	leftt <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>leftt <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>leftt <span class="token operator">>></span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffffL</span><span class="token punctuation">;</span>
	
	<span class="token keyword">for</span> <span class="token punctuation">(</span>round <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> round <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> round<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		work  <span class="token operator">=</span> <span class="token punctuation">(</span>right <span class="token operator">&lt;&lt;</span> <span class="token number">28</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>right <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		work <span class="token operator">^=</span> <span class="token operator">*</span>keys<span class="token operator">++</span><span class="token punctuation">;</span>
		fval  <span class="token operator">=</span> SP7<span class="token punctuation">[</span> work	<span class="token operator">&amp;</span> <span class="token number">0x3fL</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		fval <span class="token operator">|=</span> SP5<span class="token punctuation">[</span><span class="token punctuation">(</span>work <span class="token operator">>></span>  <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3fL</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		fval <span class="token operator">|=</span> SP3<span class="token punctuation">[</span><span class="token punctuation">(</span>work <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3fL</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		fval <span class="token operator">|=</span> SP1<span class="token punctuation">[</span><span class="token punctuation">(</span>work <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3fL</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		work  <span class="token operator">=</span> right <span class="token operator">^</span> <span class="token operator">*</span>keys<span class="token operator">++</span><span class="token punctuation">;</span>
		fval <span class="token operator">|=</span> SP8<span class="token punctuation">[</span> work 	<span class="token operator">&amp;</span> <span class="token number">0x3fL</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		fval <span class="token operator">|=</span> SP6<span class="token punctuation">[</span><span class="token punctuation">(</span>work <span class="token operator">>></span>  <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3fL</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		fval <span class="token operator">|=</span> SP4<span class="token punctuation">[</span><span class="token punctuation">(</span>work <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3fL</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		fval <span class="token operator">|=</span> SP2<span class="token punctuation">[</span><span class="token punctuation">(</span>work <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3fL</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		leftt <span class="token operator">^=</span> fval<span class="token punctuation">;</span>
		work  <span class="token operator">=</span> <span class="token punctuation">(</span>leftt <span class="token operator">&lt;&lt;</span> <span class="token number">28</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>leftt <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		work <span class="token operator">^=</span> <span class="token operator">*</span>keys<span class="token operator">++</span><span class="token punctuation">;</span>
		fval  <span class="token operator">=</span> SP7<span class="token punctuation">[</span> work 	<span class="token operator">&amp;</span> <span class="token number">0x3fL</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		fval <span class="token operator">|=</span> SP5<span class="token punctuation">[</span><span class="token punctuation">(</span>work <span class="token operator">>></span>  <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3fL</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		fval <span class="token operator">|=</span> SP3<span class="token punctuation">[</span><span class="token punctuation">(</span>work <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3fL</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		fval <span class="token operator">|=</span> SP1<span class="token punctuation">[</span><span class="token punctuation">(</span>work <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3fL</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		work  <span class="token operator">=</span> leftt <span class="token operator">^</span> <span class="token operator">*</span>keys<span class="token operator">++</span><span class="token punctuation">;</span>
		fval <span class="token operator">|=</span> SP8<span class="token punctuation">[</span> work 	<span class="token operator">&amp;</span> <span class="token number">0x3fL</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		fval <span class="token operator">|=</span> SP6<span class="token punctuation">[</span><span class="token punctuation">(</span>work <span class="token operator">>></span>  <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3fL</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		fval <span class="token operator">|=</span> SP4<span class="token punctuation">[</span><span class="token punctuation">(</span>work <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3fL</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		fval <span class="token operator">|=</span> SP2<span class="token punctuation">[</span><span class="token punctuation">(</span>work <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3fL</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		right <span class="token operator">^=</span> fval<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	
	right <span class="token operator">=</span> <span class="token punctuation">(</span>right <span class="token operator">&lt;&lt;</span> <span class="token number">31</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>right <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	work <span class="token operator">=</span> <span class="token punctuation">(</span>leftt <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xaaaaaaaaL</span><span class="token punctuation">;</span>
	leftt <span class="token operator">^=</span> work<span class="token punctuation">;</span>
	right <span class="token operator">^=</span> work<span class="token punctuation">;</span>
	leftt <span class="token operator">=</span> <span class="token punctuation">(</span>leftt <span class="token operator">&lt;&lt;</span> <span class="token number">31</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>leftt <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	work <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>leftt <span class="token operator">>></span>  <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x00ff00ffL</span><span class="token punctuation">;</span>
	right <span class="token operator">^=</span> work<span class="token punctuation">;</span>
	leftt <span class="token operator">^=</span> <span class="token punctuation">(</span>work <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	work <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>leftt <span class="token operator">>></span>  <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">^</span> right<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x33333333L</span><span class="token punctuation">;</span>
	right <span class="token operator">^=</span> work<span class="token punctuation">;</span>
	leftt <span class="token operator">^=</span> <span class="token punctuation">(</span>work <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	work <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">>></span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> leftt<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0000ffffL</span><span class="token punctuation">;</span>
	leftt <span class="token operator">^=</span> work<span class="token punctuation">;</span>
	right <span class="token operator">^=</span> <span class="token punctuation">(</span>work <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	work <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>right <span class="token operator">>></span>  <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> leftt<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0f0f0f0fL</span><span class="token punctuation">;</span>
	leftt <span class="token operator">^=</span> work<span class="token punctuation">;</span>
	right <span class="token operator">^=</span> <span class="token punctuation">(</span>work <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>block<span class="token operator">++</span> <span class="token operator">=</span> right<span class="token punctuation">;</span>
	<span class="token operator">*</span>block <span class="token operator">=</span> leftt<span class="token punctuation">;</span>
	<span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*****************************************************************
	OPENCOMM_DesExpandEncKey	: Expand Des Enc Key 扩展des加密密钥
	Return value:
		0         : Success
		other     : failed
	Parameters:
		pbDesKey        : 扩展前的DES密钥(8字节)       input
		ulDesKeyLen     : 扩展前的DES密钥长度          input
		pbDesEncKey     : 扩展后的DES加密密钥(128字节)  output
		*ulDesEncKeyLen : 扩展后的DES加密密钥长度       output
*****************************************************************/</span>
<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">OPENCOMM_DesExpandEncKey</span><span class="token punctuation">(</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbDesKey<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span>  ulDesKeyLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbDesEncKey<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>ulDesEncKeyLen<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> kn<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dough<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ulDesKeyLen <span class="token operator">!=</span> <span class="token number">8</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">0xEE20</span><span class="token punctuation">;</span>

	<span class="token function">deskey</span><span class="token punctuation">(</span>pbDesKey<span class="token punctuation">,</span> EN0<span class="token punctuation">,</span> kn<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">cookey</span><span class="token punctuation">(</span>kn<span class="token punctuation">,</span> dough<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>ulDesEncKeyLen <span class="token operator">=</span> DES_KEYBYTES<span class="token punctuation">;</span>  <span class="token comment">//32 long = 128 bytes</span>
	<span class="token function">memcpy</span><span class="token punctuation">(</span>pbDesEncKey<span class="token punctuation">,</span> dough<span class="token punctuation">,</span> <span class="token operator">*</span>ulDesEncKeyLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*****************************************************************
	OPENCOMM_DesExpandDecKey	: Expand Des Dec Key 扩展des解密密钥
	Return value:
		0       : Success
		other   : failed
	Parameters:
		pbDesKey        : 扩展前的DES密钥(8字节)      input
		ulDesKeyLen     : 扩展前的DES密钥长度         input
		pbDesDecKey     : 扩展后的DES解密密钥(128字节) output
		*ulDesDecKeyLen : 扩展后的DES解密密钥长度      output
*****************************************************************/</span>
<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">OPENCOMM_DesExpandDecKey</span><span class="token punctuation">(</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbDesKey<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span>  ulDesKeyLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbDesDecKey<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>ulDesDecKeyLen<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> kn<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dough<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ulDesKeyLen <span class="token operator">!=</span> <span class="token number">8</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">0xEE20</span><span class="token punctuation">;</span>

	<span class="token function">deskey</span><span class="token punctuation">(</span>pbDesKey<span class="token punctuation">,</span> DE1<span class="token punctuation">,</span> kn<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">cookey</span><span class="token punctuation">(</span>kn<span class="token punctuation">,</span> dough<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>ulDesDecKeyLen <span class="token operator">=</span> DES_KEYBYTES<span class="token punctuation">;</span>  <span class="token comment">//32 long = 128 bytes</span>
	<span class="token function">memcpy</span><span class="token punctuation">(</span>pbDesDecKey<span class="token punctuation">,</span> dough<span class="token punctuation">,</span> <span class="token operator">*</span>ulDesDecKeyLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/****************************************************************
	OPENCOMM_DesEncRaw		: Des算法加密小整块明文8字节 
	Return value:
		0       : Success
		other   : failed
	Parameters:
		pbDesEncKey    : DES加密密钥    input
		ulDesEncKeyLen : DES加密密钥长度 input
		pbInData       : 待加密的明文    input
		ulInDataLen    : 待加密的明文长度 input
		pbOutData      : 加密后的密文    output
		*ulOutDataLen  : 加密后的密文长度 output
*****************************************************************/</span>
<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">OPENCOMM_DesEncRaw</span><span class="token punctuation">(</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbDesEncKey<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span>  ulDesEncKeyLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbInData<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span>  ulInDataLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbOutData<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>ulOutDataLen<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> work<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ek<span class="token punctuation">[</span>DES_KEYLONGS<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> cp<span class="token punctuation">[</span>DES_BLOCKLEN<span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>ulInDataLen <span class="token operator">!=</span> DES_BLOCKLEN<span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">0xEE20</span><span class="token punctuation">;</span>
	
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ulDesEncKeyLen <span class="token operator">!=</span> DES_KEYBYTES<span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">0xEE20</span><span class="token punctuation">;</span>

	<span class="token function">memcpy</span><span class="token punctuation">(</span>cp<span class="token punctuation">,</span> pbInData<span class="token punctuation">,</span> DES_BLOCKLEN<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scrunch</span><span class="token punctuation">(</span>cp<span class="token punctuation">,</span>work<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 8 bytes -> 2 long</span>
	<span class="token function">memcpy</span><span class="token punctuation">(</span>ek<span class="token punctuation">,</span> pbDesEncKey<span class="token punctuation">,</span> ulDesEncKeyLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">desfunc</span><span class="token punctuation">(</span>work<span class="token punctuation">,</span>ek<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">unscrun</span><span class="token punctuation">(</span>work<span class="token punctuation">,</span>cp<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2 long -> 8 bytes</span>
	<span class="token function">memcpy</span><span class="token punctuation">(</span>pbOutData<span class="token punctuation">,</span> cp<span class="token punctuation">,</span> DES_BLOCKLEN<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token operator">*</span>ulOutDataLen <span class="token operator">=</span> DES_BLOCKLEN<span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*****************************************************************
	OPENCOMM_DesDecRaw : Des算法解密小整块密文8字节 
	Return value:
		0     : Success
		other : failed
	Parameters:
		pbDesDecKey    : DES解密密钥     input
		ulDesDecKeyLen : DES解密密钥长度  input
		pbInData       : 待解密的密文     input
		ulInDataLen    : 待解密的密文长度  input
		pbOutData      : 解密后的明文     output
		*ulOutDataLen  : 解密后的明文长度  output
*****************************************************************/</span>
<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token function">OPENCOMM_DesDecRaw</span><span class="token punctuation">(</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbDesDecKey<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span>  ulDesDecKeyLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbInData<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span>  ulInDataLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pbOutData<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span>ulOutDataLen<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">long</span> work<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dk<span class="token punctuation">[</span>DES_KEYLONGS<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> cp<span class="token punctuation">[</span>DES_BLOCKLEN<span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>ulInDataLen <span class="token operator">!=</span> DES_BLOCKLEN<span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">0xEE20</span><span class="token punctuation">;</span>
	
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ulDesDecKeyLen <span class="token operator">!=</span> DES_KEYBYTES<span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">0xEE20</span><span class="token punctuation">;</span>

	<span class="token function">memcpy</span><span class="token punctuation">(</span>cp<span class="token punctuation">,</span> pbInData<span class="token punctuation">,</span> DES_BLOCKLEN<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scrunch</span><span class="token punctuation">(</span>cp<span class="token punctuation">,</span>work<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 8 bytes -> 2 long</span>
	<span class="token function">memcpy</span><span class="token punctuation">(</span>dk<span class="token punctuation">,</span> pbDesDecKey<span class="token punctuation">,</span> ulDesDecKeyLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">desfunc</span><span class="token punctuation">(</span>work<span class="token punctuation">,</span>dk<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">unscrun</span><span class="token punctuation">(</span>work<span class="token punctuation">,</span>cp<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2 long -> 8 bytes</span>
	<span class="token function">memcpy</span><span class="token punctuation">(</span>pbOutData<span class="token punctuation">,</span> cp<span class="token punctuation">,</span> DES_BLOCKLEN<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//	des_enc(pbDesEncKey, pbInData, pbOutData);</span>
	<span class="token operator">*</span>ulOutDataLen <span class="token operator">=</span> DES_BLOCKLEN<span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*********************   DES    *********************/</span>

<span class="token keyword">int</span> <span class="token function">myic_DESEncrypt</span><span class="token punctuation">(</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pDesKey<span class="token punctuation">,</span>
		<span class="token keyword">int</span>            nDesKeyLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pInData<span class="token punctuation">,</span>
		<span class="token keyword">int</span>            nInDataLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pOutData<span class="token punctuation">,</span>
		<span class="token keyword">int</span>           <span class="token operator">*</span>pOutDataLen<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> DesKeyBuf<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> DesEncKeyBuf<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> EncKeyLen<span class="token punctuation">,</span> KeyLen <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> retval <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> loops<span class="token punctuation">,</span> i<span class="token punctuation">;</span>
	
	<span class="token keyword">if</span><span class="token punctuation">(</span>nInDataLen<span class="token operator">%</span><span class="token number">8</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">0xEE20</span><span class="token punctuation">;</span>
	
	<span class="token keyword">if</span><span class="token punctuation">(</span>nDesKeyLen <span class="token operator">!=</span> <span class="token number">8</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">0xEE20</span><span class="token punctuation">;</span>
	KeyLen <span class="token operator">=</span> nDesKeyLen<span class="token punctuation">;</span>
	<span class="token function">memcpy</span><span class="token punctuation">(</span>DesKeyBuf<span class="token punctuation">,</span> pDesKey<span class="token punctuation">,</span> nDesKeyLen<span class="token punctuation">)</span><span class="token punctuation">;</span>

	
	retval <span class="token operator">=</span> <span class="token function">OPENCOMM_DesExpandEncKey</span><span class="token punctuation">(</span>DesKeyBuf<span class="token punctuation">,</span> KeyLen<span class="token punctuation">,</span>
		DesEncKeyBuf<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>EncKeyLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>retval <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> retval<span class="token punctuation">;</span>

	loops <span class="token operator">=</span> nInDataLen<span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> loops<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		retval <span class="token operator">=</span> <span class="token function">OPENCOMM_DesEncRaw</span><span class="token punctuation">(</span>DesEncKeyBuf<span class="token punctuation">,</span> EncKeyLen<span class="token punctuation">,</span> pInData <span class="token operator">+</span> i<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">,</span>
			<span class="token number">8</span><span class="token punctuation">,</span> pOutData <span class="token operator">+</span> i<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span><span class="token punctuation">)</span>pOutDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>retval <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span> retval<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token operator">*</span>pOutDataLen <span class="token operator">=</span> nInDataLen<span class="token punctuation">;</span>
	<span class="token keyword">return</span> retval<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token keyword">int</span> <span class="token function">myic_DESDecrypt</span><span class="token punctuation">(</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pDesKey<span class="token punctuation">,</span>
		<span class="token keyword">int</span>            nDesKeyLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pInData<span class="token punctuation">,</span>
		<span class="token keyword">int</span>            nInDataLen<span class="token punctuation">,</span>
		<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pOutData<span class="token punctuation">,</span>
		<span class="token keyword">int</span>           <span class="token operator">*</span>pOutDataLen<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> DesKeyBuf<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> DesDecKeyBuf<span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> DecKeyLen<span class="token punctuation">,</span> KeyLen <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> retval <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> loops<span class="token punctuation">,</span> i<span class="token punctuation">;</span>
	
	<span class="token keyword">if</span><span class="token punctuation">(</span>nInDataLen<span class="token operator">%</span><span class="token number">8</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">0xEE20</span><span class="token punctuation">;</span>
	
	<span class="token keyword">if</span><span class="token punctuation">(</span>nDesKeyLen <span class="token operator">!=</span> <span class="token number">8</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token number">0xEE20</span><span class="token punctuation">;</span>
	KeyLen <span class="token operator">=</span> nDesKeyLen<span class="token punctuation">;</span>
	<span class="token function">memcpy</span><span class="token punctuation">(</span>DesKeyBuf<span class="token punctuation">,</span> pDesKey<span class="token punctuation">,</span> nDesKeyLen<span class="token punctuation">)</span><span class="token punctuation">;</span>

	retval <span class="token operator">=</span> <span class="token function">OPENCOMM_DesExpandDecKey</span><span class="token punctuation">(</span>DesKeyBuf<span class="token punctuation">,</span> KeyLen<span class="token punctuation">,</span>
		DesDecKeyBuf<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>DecKeyLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>retval <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> retval<span class="token punctuation">;</span>
	
	loops <span class="token operator">=</span> nInDataLen<span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> loops<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		retval <span class="token operator">=</span> <span class="token function">OPENCOMM_DesDecRaw</span><span class="token punctuation">(</span>DesDecKeyBuf<span class="token punctuation">,</span> DecKeyLen<span class="token punctuation">,</span> pInData <span class="token operator">+</span> i<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">,</span>
			<span class="token number">8</span><span class="token punctuation">,</span> pOutData <span class="token operator">+</span> i<span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token operator">*</span><span class="token punctuation">)</span>pOutDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>retval <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
			<span class="token keyword">return</span> retval<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token operator">*</span>pOutDataLen <span class="token operator">=</span> nInDataLen<span class="token punctuation">;</span>
	<span class="token keyword">return</span> retval<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//对称明文数据打pading</span>
<span class="token keyword">void</span>  <span class="token function">CW_dataPadAdd</span><span class="token punctuation">(</span><span class="token keyword">int</span> tag<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>date<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> dateLen<span class="token punctuation">,</span> 
					<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>padDate<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token operator">*</span>padDateLen<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span>           i<span class="token punctuation">,</span> padLen<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pTmp   <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	
	pTmp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>dateLen<span class="token operator">+</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pTmp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token operator">*</span>padDate <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token function">memset</span><span class="token punctuation">(</span>pTmp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> dateLen<span class="token operator">+</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">memcpy</span><span class="token punctuation">(</span>pTmp<span class="token punctuation">,</span> date<span class="token punctuation">,</span> dateLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token keyword">if</span> <span class="token punctuation">(</span>tag <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		padLen <span class="token operator">=</span> <span class="token number">8</span> <span class="token operator">-</span> dateLen <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>padLen<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			pTmp<span class="token punctuation">[</span>dateLen<span class="token operator">+</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>padLen<span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token operator">*</span>padDateLen <span class="token operator">=</span> dateLen <span class="token operator">+</span> padLen<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">&#123;</span>
		padLen <span class="token operator">=</span> <span class="token number">16</span> <span class="token operator">-</span> dateLen <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>padLen<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			pTmp<span class="token punctuation">[</span>dateLen<span class="token operator">+</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span>padLen<span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>		
	<span class="token punctuation">&#125;</span>
	
	<span class="token operator">*</span>padDateLen <span class="token operator">=</span> dateLen <span class="token operator">+</span> padLen<span class="token punctuation">;</span>	
	<span class="token operator">*</span>padDate <span class="token operator">=</span> pTmp<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">USER_PASSWORD_KEY</span> <span class="token string">"abcd1234"</span></span>


<span class="token comment">//数据加密</span>
<span class="token keyword">int</span> <span class="token function">DesEnc</span><span class="token punctuation">(</span>
		 <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pInData<span class="token punctuation">,</span>
		 <span class="token keyword">int</span>            nInDataLen<span class="token punctuation">,</span>
		 <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pOutData<span class="token punctuation">,</span>
		 <span class="token keyword">int</span>           <span class="token operator">*</span>pOutDataLen<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span>				rv<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span>	<span class="token operator">*</span>padDate <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">int</span>	padDateLen <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token function">CW_dataPadAdd</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> pInData<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token punctuation">)</span>nInDataLen<span class="token punctuation">,</span> <span class="token operator">&amp;</span>padDate<span class="token punctuation">,</span> <span class="token operator">&amp;</span>padDateLen<span class="token punctuation">)</span><span class="token punctuation">;</span>

	rv <span class="token operator">=</span> <span class="token function">myic_DESEncrypt</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>USER_PASSWORD_KEY<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>USER_PASSWORD_KEY<span class="token punctuation">)</span><span class="token punctuation">,</span>
		padDate<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>padDateLen<span class="token punctuation">,</span> pOutData<span class="token punctuation">,</span> pOutDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>rv <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>padDate <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token function">free</span><span class="token punctuation">(</span>padDate<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		<span class="token keyword">return</span> rv<span class="token punctuation">;</span>	
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>padDate <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">free</span><span class="token punctuation">(</span>padDate<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//数据加密</span>
<span class="token keyword">int</span> <span class="token function">DesEnc_raw</span><span class="token punctuation">(</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pInData<span class="token punctuation">,</span>
	<span class="token keyword">int</span>            nInDataLen<span class="token punctuation">,</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pOutData<span class="token punctuation">,</span>
	<span class="token keyword">int</span>           <span class="token operator">*</span>pOutDataLen<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span>				rv<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span>	<span class="token operator">*</span>padDate <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">int</span>	padDateLen <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	rv <span class="token operator">=</span> <span class="token function">myic_DESEncrypt</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>USER_PASSWORD_KEY<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>USER_PASSWORD_KEY<span class="token punctuation">)</span><span class="token punctuation">,</span>
		pInData<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>nInDataLen<span class="token punctuation">,</span> pOutData<span class="token punctuation">,</span> pOutDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>rv <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> rv<span class="token punctuation">;</span>	
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//解密分配内存错误</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">ERR_MALLOC</span> <span class="token expression"><span class="token number">20</span></span></span>
<span class="token comment">//密码长度不是8的整数倍, 不合法</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">ERR_FILECONT</span> <span class="token expression"><span class="token number">20</span></span></span>


<span class="token comment">//用户使用函数des解密</span>
<span class="token keyword">int</span> <span class="token function">DesDec</span><span class="token punctuation">(</span>
		   <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pInData<span class="token punctuation">,</span>
		   <span class="token keyword">int</span>            nInDataLen<span class="token punctuation">,</span>
		   <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pOutData<span class="token punctuation">,</span>
		   <span class="token keyword">int</span>           <span class="token operator">*</span>pOutDataLen<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span>				rv<span class="token punctuation">;</span>
	<span class="token keyword">char</span>			padChar<span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> 	<span class="token operator">*</span>tmpPlain <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	
	tmpPlain <span class="token operator">=</span>		<span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>nInDataLen<span class="token operator">+</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>tmpPlain <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> ERR_MALLOC<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token function">memset</span><span class="token punctuation">(</span>tmpPlain<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> nInDataLen<span class="token operator">+</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//解密</span>
	rv <span class="token operator">=</span> <span class="token function">myic_DESDecrypt</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>USER_PASSWORD_KEY<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>USER_PASSWORD_KEY<span class="token punctuation">)</span><span class="token punctuation">,</span>
		pInData<span class="token punctuation">,</span> nInDataLen<span class="token punctuation">,</span> tmpPlain<span class="token punctuation">,</span> pOutDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>rv <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>tmpPlain <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token function">free</span><span class="token punctuation">(</span>tmpPlain<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> rv<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//去pading</span>
	padChar <span class="token operator">=</span> tmpPlain<span class="token punctuation">[</span><span class="token operator">*</span>pOutDataLen <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>padChar<span class="token operator">&lt;=</span><span class="token number">0</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>padChar<span class="token operator">></span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token comment">//异常处理</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>tmpPlain<span class="token punctuation">)</span> <span class="token function">free</span><span class="token punctuation">(</span>tmpPlain<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> ERR_FILECONT<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token operator">*</span>pOutDataLen <span class="token operator">=</span> <span class="token operator">*</span>pOutDataLen <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>padChar<span class="token punctuation">;</span>	
	<span class="token comment">//memset(tmpPlain + *pOutDataLen, 0, (int)padChar);	</span>
	<span class="token function">memcpy</span><span class="token punctuation">(</span>pOutData<span class="token punctuation">,</span> tmpPlain<span class="token punctuation">,</span> <span class="token operator">*</span>pOutDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>tmpPlain<span class="token punctuation">)</span> <span class="token function">free</span><span class="token punctuation">(</span>tmpPlain<span class="token punctuation">)</span><span class="token punctuation">;</span>	
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//用户使用函数des解密</span>
<span class="token keyword">int</span> <span class="token function">DesDec_raw</span><span class="token punctuation">(</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pInData<span class="token punctuation">,</span>
	<span class="token keyword">int</span>            nInDataLen<span class="token punctuation">,</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>pOutData<span class="token punctuation">,</span>
	<span class="token keyword">int</span>           <span class="token operator">*</span>pOutDataLen<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span>				rv<span class="token punctuation">;</span>
	<span class="token comment">//char			padChar;</span>
	<span class="token comment">//unsigned char 	*tmpPlain = NULL;</span>

	<span class="token comment">/*
	tmpPlain =		(unsigned char *)malloc(nInDataLen+24);
	if (tmpPlain == NULL)
	&#123;
		return ERR_MALLOC;
	&#125;
	memset(tmpPlain, 0, nInDataLen+24);
	*/</span>

	<span class="token comment">//解密</span>
	rv <span class="token operator">=</span> <span class="token function">myic_DESDecrypt</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span>USER_PASSWORD_KEY<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>USER_PASSWORD_KEY<span class="token punctuation">)</span><span class="token punctuation">,</span>
		pInData<span class="token punctuation">,</span> nInDataLen<span class="token punctuation">,</span> pOutData<span class="token punctuation">,</span> pOutDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>rv <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token comment">//if (tmpPlain != NULL) free(tmpPlain);</span>
		<span class="token keyword">return</span> rv<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token comment">/*
	//去pading
	padChar = tmpPlain[*pOutDataLen - 1];
	if ( (int)padChar&lt;=0 || (int)padChar>8) //异常处理
	&#123;
		if (tmpPlain) free(tmpPlain);
		return ERR_FILECONT;
	&#125;

	*pOutDataLen = *pOutDataLen - (int)padChar;	
	//memset(tmpPlain + *pOutDataLen, 0, (int)padChar);	
	memcpy(pOutData, tmpPlain, *pOutDataLen);
	if (tmpPlain) free(tmpPlain);	
	*/</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>main.c</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"des.h"</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SIZE</span> <span class="token expression"><span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">4</span> </span><span class="token comment">//4K</span></span>

<span class="token keyword">void</span> <span class="token function">MyMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"================================\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"1 加密文件\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"2 解密文件\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"3 清屏\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"4 退出\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"================================\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//加密文件</span>
<span class="token keyword">void</span> <span class="token function">FileEnc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">char</span> srcFile<span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> dstFile<span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n请输入需要加密的文件: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> srcFile<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n请输入加密后的文件: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> dstFile<span class="token punctuation">)</span><span class="token punctuation">;</span>

	FILE <span class="token operator">*</span>rFp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	FILE <span class="token operator">*</span>wFp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> srcBuf<span class="token punctuation">[</span>SIZE<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">//明文</span>
	<span class="token keyword">int</span> srcLen <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//明文长度</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> dstBuf<span class="token punctuation">[</span>SIZE<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">//密文</span>
	<span class="token keyword">int</span> dstLen <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>	<span class="token comment">//密文长度</span>
	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> wLen <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token comment">//读、二进制方式打开需要加密的文件</span>
	rFp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>srcFile<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>rFp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"FileEnc fopen srcFile"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> End<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//写、二进制方式打开加密后的文件</span>
	wFp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>dstFile<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>wFp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"FileEnc fopen dstFile"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> End<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//从源文件中读取数据</span>
	<span class="token comment">//4k: DesEnc_raw()</span>
	<span class="token comment">//&lt;4k: DesEnc()</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span>rFp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//文件没有结束</span>
	<span class="token punctuation">&#123;</span>
		<span class="token comment">//从文件中读取内容</span>
		<span class="token comment">//srcBuf: 存放文件内容的buf</span>
		<span class="token comment">//1：每次读1个字节</span>
		<span class="token comment">//SIZE: 一次读4k块内存， 读取内容的大小： SIZE * 1</span>
		<span class="token comment">//返回值：成功读取内容的块数</span>
		srcLen <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span>srcBuf<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> SIZE<span class="token punctuation">,</span> rFp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>srcLen <span class="token operator">&lt;</span> SIZE<span class="token punctuation">)</span> <span class="token comment">//如果读取内容&lt;4k，跳出循环</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">//=4k数据的加密处理</span>
		<span class="token comment">//把明文srcBuf(长度为srcLen)加密为密文dstBuf(长度为dstLen)</span>
		ret <span class="token operator">=</span> <span class="token function">DesEnc_raw</span><span class="token punctuation">(</span>srcBuf<span class="token punctuation">,</span> srcLen<span class="token punctuation">,</span> dstBuf<span class="token punctuation">,</span> <span class="token operator">&amp;</span>dstLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"FileEnc DesEnc_raw err: %d\n"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">goto</span> End<span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">//把密文dstBuf(长度为dstLen)写到文件wFp中</span>
		wLen <span class="token operator">=</span> <span class="token function">fwrite</span><span class="token punctuation">(</span>dstBuf<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> dstLen<span class="token punctuation">,</span> wFp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>wLen <span class="token operator">!=</span> dstLen<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"（等于4k）写文件失败\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">goto</span> End<span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//小于4k的处理</span>
	<span class="token comment">//把明文srcBuf(长度为srcLen)加密为密文dstBuf(长度为dstLen)</span>
	ret <span class="token operator">=</span> <span class="token function">DesEnc</span><span class="token punctuation">(</span>srcBuf<span class="token punctuation">,</span> srcLen<span class="token punctuation">,</span> dstBuf<span class="token punctuation">,</span> <span class="token operator">&amp;</span>dstLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"FileEnc DesEnc err: %d\n"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> End<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//把密文dstBuf(长度为dstLen)写到文件wFp中</span>
	wLen <span class="token operator">=</span> <span class="token function">fwrite</span><span class="token punctuation">(</span>dstBuf<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> dstLen<span class="token punctuation">,</span> wFp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>wLen <span class="token operator">!=</span> dstLen<span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"（小于4k）写文件失败\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> End<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

End<span class="token operator">:</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>rFp <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">fclose</span><span class="token punctuation">(</span>rFp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>wFp <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">fclose</span><span class="token punctuation">(</span>wFp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>


<span class="token punctuation">&#125;</span>

<span class="token comment">//解密文件</span>
<span class="token keyword">void</span> <span class="token function">FileDec</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">char</span> srcFile<span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> dstFile<span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n请输入需要解密的文件: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> srcFile<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n请输入解密后的文件: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> dstFile<span class="token punctuation">)</span><span class="token punctuation">;</span>

	FILE <span class="token operator">*</span>rFp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	FILE <span class="token operator">*</span>wFp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> srcBuf<span class="token punctuation">[</span>SIZE<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">//密文</span>
	<span class="token keyword">int</span> srcLen <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//密文长度</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">char</span> dstBuf<span class="token punctuation">[</span>SIZE<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token comment">//明文</span>
	<span class="token keyword">int</span> dstLen <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>	<span class="token comment">//明文长度</span>
	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> wLen <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

	<span class="token comment">//读、二进制方式打开需要解密的文件</span>
	rFp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>srcFile<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>rFp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"FileDec fopen srcFile"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> End<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//写、二进制方式打开解密后的文件</span>
	wFp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>dstFile<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>wFp <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">"FileDec fopen dstFile"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> End<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//从源文件中读取数据</span>
	<span class="token comment">//4k: DesDec_raw()</span>
	<span class="token comment">//&lt;4k: DesDec()</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span>rFp<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//文件没有结束</span>
	<span class="token punctuation">&#123;</span>
		<span class="token comment">//从文件中读取内容</span>
		<span class="token comment">//srcBuf: 存放文件内容的buf</span>
		<span class="token comment">//1：每次读1个字节</span>
		<span class="token comment">//SIZE: 一次读4k内存， 读取内容的大小： SIZE * 1</span>
		<span class="token comment">//返回值：成功读取内容的块数</span>
		srcLen <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span>srcBuf<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> SIZE<span class="token punctuation">,</span> rFp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>srcLen <span class="token operator">&lt;</span> SIZE<span class="token punctuation">)</span> <span class="token comment">//如果读取内容&lt;4k，跳出循环</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">//=4k数据的解密处理</span>
		<span class="token comment">//把明文srcBuf(长度为srcLen)解密为明文dstBuf(长度为dstLen)</span>
		ret <span class="token operator">=</span> <span class="token function">DesDec_raw</span><span class="token punctuation">(</span>srcBuf<span class="token punctuation">,</span> srcLen<span class="token punctuation">,</span> dstBuf<span class="token punctuation">,</span> <span class="token operator">&amp;</span>dstLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"FileDec DesDec_raw err: %d\n"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">goto</span> End<span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">//把明文dstBuf(长度为dstLen)写到文件wFp中</span>
		wLen <span class="token operator">=</span> <span class="token function">fwrite</span><span class="token punctuation">(</span>dstBuf<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> dstLen<span class="token punctuation">,</span> wFp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>wLen <span class="token operator">!=</span> dstLen<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"（等于4k）写文件失败\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">goto</span> End<span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

	<span class="token punctuation">&#125;</span>

	<span class="token comment">//小于4k的处理</span>
	<span class="token comment">//把明文srcBuf(长度为srcLen)解密为明文dstBuf(长度为dstLen)</span>
	ret <span class="token operator">=</span> <span class="token function">DesDec</span><span class="token punctuation">(</span>srcBuf<span class="token punctuation">,</span> srcLen<span class="token punctuation">,</span> dstBuf<span class="token punctuation">,</span> <span class="token operator">&amp;</span>dstLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"FileDec DesDec err: %d\n"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> End<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//把密文dstBuf(长度为dstLen)写到文件wFp中</span>
	wLen <span class="token operator">=</span> <span class="token function">fwrite</span><span class="token punctuation">(</span>dstBuf<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> dstLen<span class="token punctuation">,</span> wFp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>wLen <span class="token operator">!=</span> dstLen<span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"（小于4k）写文件失败\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">goto</span> End<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

End<span class="token operator">:</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>rFp <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">fclose</span><span class="token punctuation">(</span>rFp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span>wFp <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">fclose</span><span class="token punctuation">(</span>wFp<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> cmd<span class="token punctuation">;</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">MyMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"cmd:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">switch</span> <span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
		<span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
			<span class="token function">FileEnc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
			<span class="token function">FileDec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
			<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token keyword">default</span><span class="token operator">:</span>
			<span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

	<span class="token punctuation">&#125;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="链表和函数指针"><a href="#链表和函数指针" class="headerlink" title="链表和函数指针"></a>链表和函数指针</h3><ul>
<li>链表是一种常用的数据结构，它通过指针将一些列数据结点，连接成一个数据链。相对于数组，链表具有更好的动态性（非顺序存储）。</li>
<li>数据域用来存储数据，指针域用于建立与下一个结点的联系。</li>
<li>建立链表时无需预先知道数据总量的，可以随机的分配空间，可以高效的在链表中的任意位置实时插入或删除数据。</li>
<li>链表的开销，主要是访问顺序性和组织链的空间损失。</li>
</ul>
<h4 id="链表的相关概念"><a href="#链表的相关概念" class="headerlink" title="链表的相关概念"></a>链表的相关概念</h4><ol>
<li>有关结构体的自身引用</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token comment">//结构体嵌套结构体指针(√)</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Teacher</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">Teacher</span> <span class="token operator">*</span>teacher<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token class-name">teacher_t</span><span class="token punctuation">;</span>


<span class="token comment">//数据类型本质：固定大小内存块的别名 </span>

<span class="token comment">//结构体中套一个结构体(X)</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Student</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> name<span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">struct</span> <span class="token class-name">Student</span> student<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token class-name">student_t</span><span class="token punctuation">;</span>
<span class="token comment">//在自己类型大小 还没有确定的情况下 引用自己类型的元素 是不正确的</span>
<span class="token comment">//结构体不能嵌套定义 （确定不了数据类型的内存大小，分配不了内存）</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token class-name">teacher_t</span> t1<span class="token punctuation">;</span>
    <span class="token class-name">student_t</span> s1<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li>data域和指针域</li>
</ol>
<p><img src="http://qiniu.orangew.cn/img/wps23AF.tmp.jpg" alt="img"></p>
<p><img src="http://qiniu.orangew.cn/img/wps55EB.tmp.jpg" alt="img"></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">node</span> <span class="token operator">*</span>link<span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">node</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> item<span class="token punctuation">;</span>     <span class="token comment">//data域</span>
    link next<span class="token punctuation">;</span>              <span class="token comment">//链表域</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h4><ol>
<li><p>动态链表和静态链表</p>
<ul>
<li><p>静态链表和动态链表是线性表链式存储结构的两种不同的表示方式。</p>
</li>
<li><p>所有结点都是在程序中定义的，不是临时开辟的，也不能用完后释放，这种链表称为“静态链表”。</p>
</li>
<li><p>所谓动态链表，是指在程序执行过程中从无到有地建立起一个链表，即一个一个地开辟结点和输入各结点数据，并建立起前后相链的关系。</p>
</li>
</ul>
</li>
<li><p>带头链表和不带头链表</p>
</li>
<li><p>单向链表、双向链表、循环链表等</p>
</li>
</ol>
<h4 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h4><ol>
<li>建立带有头结点的单向链表<ul>
<li>编写函数SList_Creat，建立带有头结点的单向链表。循环创建结点，结点数据域中的数值从键盘输入，以-1作为输入结束标志。链表的头结点地址由函数值返回。</li>
</ul>
</li>
<li>顺序访问链表中各结点的数据域<ul>
<li>编写函数SList_Print，顺序输出单向链表各项结点数据域中的内容。</li>
</ul>
</li>
<li>在单向链表中插入节点<ul>
<li>编写函数SList_NodeInsert，功能：在值为x的结点前，插入值为y的结点；若值为x的结点不存在，则插在表尾。</li>
</ul>
</li>
<li>删除单向链表中的结点、<ul>
<li>编写函数SList_NodeDel，删除值为x的结点。\</li>
</ul>
</li>
<li>单向链表的基本操作</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>  <span class="token macro-name">_CRT_SECURE_NO_WARNINGS</span> </span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">Node</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> id<span class="token punctuation">;</span>		<span class="token comment">//数据域</span>
	<span class="token keyword">struct</span> <span class="token class-name">Node</span> <span class="token operator">*</span>next<span class="token punctuation">;</span>	<span class="token comment">//指针域</span>
<span class="token punctuation">&#125;</span>SLIST<span class="token punctuation">;</span>

<span class="token comment">//创建头节点</span>
SLIST <span class="token operator">*</span><span class="token function">SListCreat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
	SLIST <span class="token operator">*</span>pCur <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>		<span class="token comment">//当前节点</span>
	SLIST <span class="token operator">*</span>pHead <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>	<span class="token comment">//头结点</span>
	SLIST <span class="token operator">*</span>pNew <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>		<span class="token comment">//新节点</span>

	<span class="token comment">//头结点，只是作为标志使用，不保存有效数据</span>
	pHead <span class="token operator">=</span> <span class="token punctuation">(</span>SLIST <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>SLIST<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pHead <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//pHead成员变量赋值，数据域任意即可，后面用不上</span>
	pHead<span class="token operator">-></span>id <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	pHead<span class="token operator">-></span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	<span class="token comment">//保存当前节点</span>
	<span class="token comment">//指针指向谁，就把谁的地址赋值给指针</span>
	pCur <span class="token operator">=</span> pHead<span class="token punctuation">;</span>

	<span class="token keyword">int</span> data<span class="token punctuation">;</span>

	<span class="token comment">//循环创建结点，结点数据域中的数值从键盘输入，以-1作为输入结束标志</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"请输入数据："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> 

		<span class="token keyword">if</span> <span class="token punctuation">(</span>data <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span><span class="token comment">//输入-1，退出循环</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">//新节点分配空间</span>
		pNew <span class="token operator">=</span> <span class="token punctuation">(</span>SLIST <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>SLIST<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pNew <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span><span class="token comment">//如果没有分配成功，跳出本次循环</span>
			<span class="token keyword">continue</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">//pNew成员变量赋值</span>
		pNew<span class="token operator">-></span>id <span class="token operator">=</span> data<span class="token punctuation">;</span>
		pNew<span class="token operator">-></span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

		<span class="token comment">//当前节点next指向新节点</span>
		pCur<span class="token operator">-></span>next <span class="token operator">=</span> pNew<span class="token punctuation">;</span>

		<span class="token comment">//新节点的next指向NULL</span>
		pNew<span class="token operator">-></span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

		<span class="token comment">//当前节点的位置移动到新节点的位置（pCur指向pNew）</span>
		pCur <span class="token operator">=</span> pNew<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	
	<span class="token comment">//链表的头结点地址由函数值返回。</span>
	<span class="token keyword">return</span> pHead<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//遍历节点</span>
<span class="token comment">//顺序输出单向链表各项结点数据域中的内容</span>
<span class="token keyword">int</span> <span class="token function">SListPrint</span><span class="token punctuation">(</span>SLIST <span class="token operator">*</span>pHead<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pHead <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//保存头结点的下一个节点</span>
	<span class="token comment">//因为头结点不是有效数据节点，下一个节点才是有效数据的结点</span>
	SLIST <span class="token operator">*</span>pCur <span class="token operator">=</span> pHead<span class="token operator">-></span>next<span class="token punctuation">;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"head -> "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>pCur <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d -> "</span><span class="token punctuation">,</span> pCur<span class="token operator">-></span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">//节点往后移动，当前节点指向下一个节点</span>
		pCur <span class="token operator">=</span> pCur<span class="token operator">-></span>next<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"NULL\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//在值为x的结点前，插入值为y的结点；</span>
<span class="token comment">//若值为x的结点不存在，则插在表尾</span>
<span class="token keyword">int</span> <span class="token function">SListNodeInsert</span><span class="token punctuation">(</span>SLIST <span class="token operator">*</span>pHead<span class="token punctuation">,</span> <span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pHead <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	SLIST <span class="token operator">*</span>pPre <span class="token operator">=</span> pHead<span class="token punctuation">;</span>		<span class="token comment">//上一个节点</span>
	SLIST <span class="token operator">*</span>pCur <span class="token operator">=</span> pHead<span class="token operator">-></span>next<span class="token punctuation">;</span>	<span class="token comment">//当前节点</span>
	SLIST <span class="token operator">*</span>pNew <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>         <span class="token comment">//新节点</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span>pCur <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token comment">//如果当前节点数据域等于x，跳出循环</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pCur<span class="token operator">-></span>id <span class="token operator">==</span> x<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">//保存当前节点</span>
		pPre <span class="token operator">=</span> pCur<span class="token punctuation">;</span>

		<span class="token comment">//当前节点往后移动，当前节点指向下一个节点</span>
		<span class="token comment">//pPre和pCur相差一个节点，pPre为上一个节点，pCur为当前节点</span>
		pCur <span class="token operator">=</span> pCur<span class="token operator">-></span>next<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//程序执行到这，有两种情况</span>
	<span class="token comment">//1. 找到值为x的结点，pCur为当前匹配节点，pPre为上一个节点</span>
	<span class="token comment">//2. 没有找到x的结点，节点移动到结尾，pPre为最后一个节点，pCur为NULL</span>

	<span class="token comment">//在值为x的结点前，插入值为y的结点；</span>
	<span class="token comment">//若值为x的结点不存在，则插在表尾</span>
	
	<span class="token comment">//新节点分配空间</span>
	pNew <span class="token operator">=</span> <span class="token punctuation">(</span>SLIST <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>SLIST<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pNew <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//pNew成员变量赋值</span>
	pNew<span class="token operator">-></span>id <span class="token operator">=</span> y<span class="token punctuation">;</span>
	pNew<span class="token operator">-></span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	<span class="token comment">//pPre的next指向pNew</span>
	pPre<span class="token operator">-></span>next <span class="token operator">=</span> pNew<span class="token punctuation">;</span>

	<span class="token comment">//pNew的next指向pCur</span>
	pNew<span class="token operator">-></span>next <span class="token operator">=</span> pCur<span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//删除第一个值为x的结点</span>
<span class="token keyword">int</span> <span class="token function">SListNodeDel</span><span class="token punctuation">(</span>SLIST <span class="token operator">*</span>pHead<span class="token punctuation">,</span> <span class="token keyword">int</span> x<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pHead <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	SLIST <span class="token operator">*</span>pPre <span class="token operator">=</span> pHead<span class="token punctuation">;</span>		<span class="token comment">//上一个节点</span>
	SLIST <span class="token operator">*</span>pCur <span class="token operator">=</span> pHead<span class="token operator">-></span>next<span class="token punctuation">;</span>	<span class="token comment">//当前节点</span>
	<span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//标志位，0代表没有值为x的结点，1代表有</span>


	<span class="token keyword">while</span> <span class="token punctuation">(</span>pCur <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pCur<span class="token operator">-></span>id <span class="token operator">==</span> x<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token comment">//上一个节点指向当前节点的下一个节点</span>
			pPre<span class="token operator">-></span>next <span class="token operator">=</span> pCur<span class="token operator">-></span>next<span class="token punctuation">;</span>

			<span class="token comment">//临时释放节点</span>
			<span class="token function">free</span><span class="token punctuation">(</span>pCur<span class="token punctuation">)</span><span class="token punctuation">;</span>
			pCur <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

			<span class="token comment">//标志位，0代表没有值为x的结点，1代表有</span>
			flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

			<span class="token comment">//跳出循环</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">//保存当前节点</span>
		pPre <span class="token operator">=</span> pCur<span class="token punctuation">;</span>

		<span class="token comment">//当前节点往后移动，当前节点指向下一个节点</span>
		<span class="token comment">//pPre和pCur相差一个节点，pPre为上一个节点，pCur为当前节点</span>
		pCur <span class="token operator">=</span> pCur<span class="token operator">-></span>next<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>


	<span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span> <span class="token comment">//标志位，0代表没有值为x的结点，1代表有</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"没有值为%d的结点\n"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//删除值为x的所有结点</span>
<span class="token keyword">int</span> <span class="token function">SListNodeDelPro</span><span class="token punctuation">(</span>SLIST <span class="token operator">*</span>pHead<span class="token punctuation">,</span> <span class="token keyword">int</span> x<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pHead <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	SLIST <span class="token operator">*</span>pPre <span class="token operator">=</span> pHead<span class="token punctuation">;</span>		<span class="token comment">//上一个节点</span>
	SLIST <span class="token operator">*</span>pCur <span class="token operator">=</span> pHead<span class="token operator">-></span>next<span class="token punctuation">;</span>	<span class="token comment">//当前节点</span>
	SLIST <span class="token operator">*</span>pTmp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>			<span class="token comment">//临时释放节点</span>
	<span class="token keyword">int</span> flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//标志位，0代表没有值为x的结点，1代表有</span>


	<span class="token keyword">while</span> <span class="token punctuation">(</span>pCur <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pCur<span class="token operator">-></span>id <span class="token operator">==</span> x<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token comment">//上一个节点指向当前节点的下一个节点</span>
			pPre<span class="token operator">-></span>next <span class="token operator">=</span> pCur<span class="token operator">-></span>next<span class="token punctuation">;</span>
			pTmp <span class="token operator">=</span> pCur<span class="token punctuation">;</span>		<span class="token comment">//临时释放节点</span>


			<span class="token comment">//当前节点往后移动，当前节点指向下一个节点</span>
			<span class="token comment">//pPre和pCur相差一个节点，pPre为上一个节点，pCur为当前节点</span>
			pCur <span class="token operator">=</span> pCur<span class="token operator">-></span>next<span class="token punctuation">;</span>

			<span class="token comment">//临时释放节点</span>
			<span class="token function">free</span><span class="token punctuation">(</span>pTmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
			pTmp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

			<span class="token comment">//标志位，0代表没有值为x的结点，1代表有</span>
			flag <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

			<span class="token comment">//结束本次循环，没有跳出循环，看是否有重复值为x的结点</span>
			<span class="token keyword">continue</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">//保存当前节点</span>
		pPre <span class="token operator">=</span> pCur<span class="token punctuation">;</span>

		<span class="token comment">//当前节点往后移动，当前节点指向下一个节点</span>
		<span class="token comment">//pPre和pCur相差一个节点，pPre为上一个节点，pCur为当前节点</span>
		pCur <span class="token operator">=</span> pCur<span class="token operator">-></span>next<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	
	<span class="token keyword">if</span> <span class="token punctuation">(</span>flag <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span> <span class="token comment">//标志位，0代表没有值为x的结点，1代表有</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"没有值为%d的结点\n"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//链表节点排序</span>
<span class="token keyword">int</span> <span class="token function">SListNodeSort</span><span class="token punctuation">(</span>SLIST <span class="token operator">*</span>pHead<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pHead <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	SLIST <span class="token operator">*</span>pPre <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	SLIST <span class="token operator">*</span>pCur <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> 
	SLIST tmp<span class="token punctuation">;</span> <span class="token comment">//临时交换变量</span>
	
	<span class="token comment">//选择法排序</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>pPre <span class="token operator">=</span> pHead<span class="token operator">-></span>next<span class="token punctuation">;</span> pPre <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> pPre <span class="token operator">=</span> pPre<span class="token operator">-></span>next<span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>pCur <span class="token operator">=</span> pPre<span class="token operator">-></span>next<span class="token punctuation">;</span> pCur <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> pCur <span class="token operator">=</span> pCur<span class="token operator">-></span>next<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>pPre<span class="token operator">-></span>id <span class="token operator">></span> pCur<span class="token operator">-></span>id<span class="token punctuation">)</span> <span class="token comment">//升序</span>
			<span class="token punctuation">&#123;</span>
				<span class="token comment">//交换数据域</span>
				tmp <span class="token operator">=</span> <span class="token operator">*</span>pCur<span class="token punctuation">;</span>
				<span class="token operator">*</span>pCur <span class="token operator">=</span> <span class="token operator">*</span>pPre<span class="token punctuation">;</span>
				<span class="token operator">*</span>pPre <span class="token operator">=</span> tmp<span class="token punctuation">;</span>

				<span class="token comment">//交换指针域（重要）</span>
				tmp<span class="token punctuation">.</span>next <span class="token operator">=</span> pCur<span class="token operator">-></span>next<span class="token punctuation">;</span>
				pCur<span class="token operator">-></span>next <span class="token operator">=</span> pPre<span class="token operator">-></span>next<span class="token punctuation">;</span>
				pPre<span class="token operator">-></span>next <span class="token operator">=</span> tmp<span class="token punctuation">.</span>next<span class="token punctuation">;</span>

			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//假如原来链表是升序的,升序插入新节点</span>
<span class="token comment">//不能插入节点后再排序，是升序插入新节点x</span>
<span class="token keyword">int</span> <span class="token function">SListNodeInsertPro</span><span class="token punctuation">(</span>SLIST <span class="token operator">*</span>pHead<span class="token punctuation">,</span> <span class="token keyword">int</span> x<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token comment">//先排序，保证原来链表是升序的</span>
	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token function">SListNodeSort</span><span class="token punctuation">(</span>pHead<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	SLIST <span class="token operator">*</span>pPre <span class="token operator">=</span> pHead<span class="token punctuation">;</span>		<span class="token comment">//上一个节点</span>
	SLIST <span class="token operator">*</span>pCur <span class="token operator">=</span> pHead<span class="token operator">-></span>next<span class="token punctuation">;</span>	<span class="token comment">//当前节点</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span>pCur <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token comment">//找到合适节点，假如x = 3</span>
		<span class="token comment">//链表为：1 2 4 5</span>
		<span class="token comment">//那么 4 节点为合适节点</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>pCur<span class="token operator">-></span>id <span class="token operator">>=</span> x<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			<span class="token keyword">break</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>

		<span class="token comment">//保存当前节点</span>
		pPre <span class="token operator">=</span> pCur<span class="token punctuation">;</span>

		<span class="token comment">//当前节点往后移动，当前节点指向下一个节点</span>
		<span class="token comment">//pPre和pCur相差一个节点，pPre为上一个节点，pCur为当前节点</span>
		pCur <span class="token operator">=</span> pCur<span class="token operator">-></span>next<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//程序执行到这，有2种情况</span>
	<span class="token comment">//1. 找到匹配节点，pCur为当前匹配节点，pPre为上一个节点</span>
	<span class="token comment">//2. 没有找到匹配节点，节点移动到结尾，pPre为最后一个节点，pCur为NULL</span>
	

	<span class="token comment">//新节点分配空间</span>
	SLIST <span class="token operator">*</span>pNew <span class="token operator">=</span> <span class="token punctuation">(</span>SLIST <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token keyword">sizeof</span><span class="token punctuation">(</span>SLIST<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pNew <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//pNew成员变量赋值</span>
	pNew<span class="token operator">-></span>id <span class="token operator">=</span> x<span class="token punctuation">;</span>
	pNew<span class="token operator">-></span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	<span class="token comment">//pPre的next指向pNew</span>
	pPre<span class="token operator">-></span>next <span class="token operator">=</span> pNew<span class="token punctuation">;</span>

	<span class="token comment">//pNew的next指向pCur</span>
	pNew<span class="token operator">-></span>next <span class="token operator">=</span> pCur<span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//翻转链表的节点（不是排序，是翻转）</span>
<span class="token keyword">int</span> <span class="token function">SListNodeReverse</span><span class="token punctuation">(</span>SLIST <span class="token operator">*</span>pHead<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pHead <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> pHead<span class="token operator">-></span>next <span class="token operator">==</span> <span class="token constant">NULL</span> <span class="token operator">||</span> pHead<span class="token operator">-></span>next<span class="token operator">-></span>next <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//上一个节点</span>
	SLIST <span class="token operator">*</span>pPre <span class="token operator">=</span> pHead<span class="token operator">-></span>next<span class="token punctuation">;</span>

	<span class="token comment">//当前节点，pCur和pPre相差一个节点</span>
	SLIST <span class="token operator">*</span>pCur <span class="token operator">=</span> pPre<span class="token operator">-></span>next<span class="token punctuation">;</span> <span class="token comment">//pHead->next->next</span>

	SLIST <span class="token operator">*</span>pTmp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span> <span class="token comment">//临时节点</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span>pCur <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token comment">//先保存pCur的下一个节点</span>
		pTmp <span class="token operator">=</span> pCur<span class="token operator">-></span>next<span class="token punctuation">;</span>

		<span class="token comment">//原来： pPre->next = pCur</span>
		<span class="token comment">//翻转： pCur->next = pPre</span>
		<span class="token comment">//pCur的next指向pPre</span>
		pCur<span class="token operator">-></span>next <span class="token operator">=</span> pPre<span class="token punctuation">;</span>

		<span class="token comment">//pPre往后移动一个节点，pPre指向pCur</span>
		pPre <span class="token operator">=</span> pCur<span class="token punctuation">;</span>

		<span class="token comment">//pCur往后移动一个节点，pCur指向pTmp</span>
		pCur <span class="token operator">=</span> pTmp<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token comment">//确定头结点和尾结点</span>
	<span class="token comment">//程序执行到这，说明pCur为NULL，pPre为最后一个有效节点</span>
	<span class="token comment">//而翻转后，pPre为头结点指向的第一个有效节点</span>

	<span class="token comment">//先确定翻转后的尾结点</span>
	pHead<span class="token operator">-></span>next<span class="token operator">-></span>next <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	<span class="token comment">//在确定头结点</span>
	pHead<span class="token operator">-></span>next <span class="token operator">=</span> pPre<span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//释放所有节点</span>
<span class="token keyword">int</span> <span class="token function">SListDestroy</span><span class="token punctuation">(</span>SLIST <span class="token operator">*</span>pHead<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>pHead <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	SLIST <span class="token operator">*</span>pTmp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>	<span class="token comment">//临时释放节点</span>

	<span class="token keyword">while</span> <span class="token punctuation">(</span>pHead <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#123;</span>
		<span class="token comment">//临时释放节点</span>
		pTmp <span class="token operator">=</span> pHead<span class="token punctuation">;</span>

		<span class="token comment">//头结点指向头结点next节点</span>
		pHead <span class="token operator">=</span> pHead<span class="token operator">-></span>next<span class="token punctuation">;</span>
		
		<span class="token function">free</span><span class="token punctuation">(</span>pTmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
		pTmp <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	<span class="token punctuation">&#125;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	SLIST <span class="token operator">*</span>pHead <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>

	pHead <span class="token operator">=</span> <span class="token function">SListCreat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//创建头结点</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n创建头结点后\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SListPrint</span><span class="token punctuation">(</span>pHead<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//遍历所有节点</span>

	
	<span class="token function">SListNodeInsert</span><span class="token punctuation">(</span>pHead<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//在4前面插入3</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n在4前面插入3\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SListPrint</span><span class="token punctuation">(</span>pHead<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//遍历所有节点</span>

	
	<span class="token function">SListNodeDel</span><span class="token punctuation">(</span>pHead<span class="token punctuation">,</span>  <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//删除第一个值为4的结点</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n删除第一个值为4的结点\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SListPrint</span><span class="token punctuation">(</span>pHead<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//遍历所有节点</span>

	<span class="token function">SListNodeSort</span><span class="token punctuation">(</span>pHead<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//链表节点排序</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n链表节点排序\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SListPrint</span><span class="token punctuation">(</span>pHead<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//遍历所有节点</span>

	<span class="token function">SListNodeInsertPro</span><span class="token punctuation">(</span>pHead<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//升序插入5</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n升序插入5后\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SListPrint</span><span class="token punctuation">(</span>pHead<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//遍历所有节点</span>

	<span class="token comment">//翻转链表的节点（不是排序，是翻转）</span>
	<span class="token function">SListNodeReverse</span><span class="token punctuation">(</span>pHead<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n翻转链表的节点\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">SListPrint</span><span class="token punctuation">(</span>pHead<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//遍历所有节点</span>

	<span class="token function">SListDestroy</span><span class="token punctuation">(</span>pHead<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//释放所有节点</span>
	pHead <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
	<span class="token function">SListPrint</span><span class="token punctuation">(</span>pHead<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//遍历所有节点</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h4 id="指针函数和函数指针"><a href="#指针函数和函数指针" class="headerlink" title="指针函数和函数指针"></a>指针函数和函数指针</h4><ol>
<li><p>指针函数（返回指针值的函数）</p>
<ul>
<li>一个函数可以带回一个整型值、字符值、实型值等，也可以带回指针型的数据，即地址。</li>
<li>这种带回指针值的函数，一般定义形式为：类型名 *函数名（参数表列）;</li>
</ul>
</li>
<li><p>函数指针（指向函数的指针）</p>
<ul>
<li>一个函数在编译时被分配一个入口地址，这个地址就称为函数的指针，函数名代表函数的入口地址。</li>
</ul>
</li>
</ol>
<ul>
<li>这一点和数组一样，因此我们可以用一个指针变量来存放这个入口地址，然后通过该指针变量调用函数。</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> <span class="token function">max</span> <span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> c<span class="token punctuation">;</span> 
	c <span class="token operator">=</span> <span class="token function">max</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token comment">//这是通常用的方法，我们也可以定义一个函数指针，通过指针来调用这个函数。</span>
	
	<span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//指向函数指针变量的定义形式</span>
	p <span class="token operator">=</span> max<span class="token punctuation">;</span>	        <span class="token comment">//将函数的入口地址赋给函数指针变量p</span>
	c <span class="token operator">=</span> <span class="token function">p</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//调用max函数</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<ol start="3">
<li>回调函数     <ul>
<li>函数指针变量常见的用途之一是把指针作为参数传递到其他函数，指向函数的指针也可以作为参数，以实现函数地址的传递。<ol>
<li>写一个函数A,A里面有一个参数是个函数指针:<ul>
<li><code>int funcA(int a, int (*Pcall)(int b));</code></li>
<li>注意回调函数做形式参数函数名和*号要用括号搞在一起，否则 就会被返回值类型占有.</li>
</ul>
</li>
<li>有个实体函数，那他要指向一个函数B,这个函数的类型应该和A的函数参数类型一样:<ul>
<li><code>int funcB(int c); </code></li>
</ul>
</li>
<li>使用A函数把参数赋值后,A中的形参Pcall函数指针指向了一个函数funB的地址: <ul>
<li><code>funcA(36,funcB);</code></li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">int</span> <span class="token function">funcB</span><span class="token punctuation">(</span><span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"in funcB:%d\n"</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> 
    
<span class="token keyword">int</span> <span class="token function">funcA</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>Pcall<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> PA <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> PS <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token function">Pcall</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//调用回调函数,传参数a</span>
    <span class="token function">Pcall</span><span class="token punctuation">(</span>PS<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//调用回调函数,传参数PS</span>
    <span class="token function">Pcall</span><span class="token punctuation">(</span>PA<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//调用回调函数,传参数PA</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">funcA</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> funcB<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//将funcB当做参数传递给funcA</span>
    <span class="token function">funcB</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> funcB<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>           <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="4">
<li>函数类型的别名</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token keyword">typedef</span> <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>pCall<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//将 int (*)(int b)类型的指针 起别名 pCall</span>

pCall pCallA<span class="token punctuation">;</span>           <span class="token comment">//定义一个函数指针</span>
pCall pCallB<span class="token punctuation">;</span>           <span class="token comment">//定义一个函数指针</span>
     
<span class="token keyword">int</span> <span class="token function">funcB</span><span class="token punctuation">(</span><span class="token keyword">int</span> b<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"in funcB:%d\n"</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> 
    
<span class="token keyword">int</span> <span class="token function">funcA</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> pCallA<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>               
    <span class="token keyword">int</span> PA <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> 
    <span class="token keyword">int</span> PS <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> 
    <span class="token function">PcallA</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//调用回调函数,传参数a</span>
    <span class="token function">PcallA</span><span class="token punctuation">(</span>PS<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//调用回调函数,传参数PS</span>
    <span class="token function">PcallA</span><span class="token punctuation">(</span>PA<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//调用回调函数,传参数PA</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token function">funcA</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> funcB<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//将funcB当做参数传递给funcA</span>
    <span class="token function">funcB</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> funcB<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>           <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>奇葩的变量笔试题</li>
</ul>
<blockquote>
<p>给定以下类型的变量a的定义式：</p>
<p>a) 一个整型（An integer）</p>
<p>b) 一个指向整型的指针（A pointer to an integer）</p>
<p>c) 一个指向指向整型的指针（A pointer to a pointer to an integer）</p>
<p>d) 一个10个存放整型的数组（An array of 10 integers）</p>
<p>e) 一个10个存放指向整型指针的数组</p>
<p>（An array of 10 pointers to integers）</p>
<p>f) 一个指向存放10个整型数组的指针</p>
<p>（A pointer to an array of 10 integers）</p>
<p>g) 一个指向 需要一个整型参数并且返回值是一个整型函数的指针</p>
<p>（A pointer to a function that takes an integer as an argument and returns an integer）</p>
<p>h) 一个存放10个 指向 需要一个整型参数并且返回值是一个整型函数的指针的数组</p>
<p>（An array of ten pointers to functions that take an integer argument and return an integer）</p>
</blockquote>
<h3 id="预处理"><a href="#预处理" class="headerlink" title="预处理"></a>预处理</h3><h4 id="预处理-1"><a href="#预处理-1" class="headerlink" title="预处理"></a>预处理</h4><ol>
<li>预处理的基本概念<ul>
<li>C语言对源程序处理的四个步骤：预处理、编译、汇编、链接。</li>
<li>预处理是在程序源代码被编译之前，由预处理器（Preprocessor）对程序源代码进行的处理。这个过程并不对程序的源代码语法进行解析，但它会把源代码分割或处理成为特定的符号为下一步的编译做准备工作。</li>
</ul>
</li>
<li>预编译命令<ul>
<li>Ｃ编译器提供的预处理功能主要有以下四种：<ol>
<li>文件包含 #include</li>
<li>宏定义  #define</li>
<li>条件编译 #if #endif ..</li>
<li>一些特殊作用的预定义宏</li>
</ol>
</li>
</ul>
</li>
</ol>
<h4 id="文件包含处理"><a href="#文件包含处理" class="headerlink" title="文件包含处理"></a>文件包含处理</h4><ol>
<li>文件包含处理<ul>
<li>文件包含处理”是指一个源文件可以将另外一个文件的全部内容包含进来。Ｃ语言提供了#include命令用来实现“文件包含”的操作。</li>
<li><img src="http://qiniu.orangew.cn/img/wps3099.tmp.jpg" alt="img"></li>
</ul>
</li>
<li>#include&lt; &gt; 与 #include “”的区别<ul>
<li>“”表示系统先在file1.c所在的当前目录找file1.h，如果找不到，再按系统指定的目录检索。</li>
<li>&lt; &gt;表示系统直接按系统指定的目录检索。</li>
<li>注意<ul>
<li>#include &lt;&gt;常用于包含库函数的头文件</li>
<li>#include “”常用于包含自定义的头文件</li>
<li>理论上#include可以包含任意格式的文件(.c .h等) ，但我们一般用于头文件的包含。</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="宏定义"><a href="#宏定义" class="headerlink" title="宏定义"></a>宏定义</h4><ol>
<li>基本概念<ul>
<li>在源程序中，允许一个标识符（宏名）来表示一个语言符号字符串用指定的符号代替指定的信息。</li>
<li>在C语言中，“宏”分为：无参数的宏和有参数的宏。</li>
</ul>
</li>
<li>无参数的宏定义<ul>
<li>#define　宏名　字符串</li>
<li>例: #define    PI    3.141926</li>
<li>在编译预处理时，将程序中在该语句以后出现的所有的PI都用3.1415926代替。</li>
<li>这种方法使用户能以一个简单的名字代替一个长的字符串，在预编译时将宏名替换成字符串的过程称为“宏展开”。宏定义，只在宏定义的文件中起作用。</li>
</ul>
</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">PI</span> <span class="token expression"><span class="token number">3.1415f</span></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">float</span> L<span class="token punctuation">,</span>S<span class="token punctuation">,</span>R<span class="token punctuation">,</span>V<span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Input Radius:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%f"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>R<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	L<span class="token operator">=</span><span class="token number">2.0f</span><span class="token operator">*</span>PI<span class="token operator">*</span>R<span class="token punctuation">;</span>
	S<span class="token operator">=</span>PI<span class="token operator">*</span>R<span class="token operator">*</span>R<span class="token punctuation">;</span>
	V<span class="token operator">=</span><span class="token number">4.0f</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">*</span>PI<span class="token operator">*</span>R<span class="token operator">*</span>R<span class="token operator">*</span>R<span class="token punctuation">;</span>
	
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"L=%.4f,S=%.4f,V=%.4f\n"</span><span class="token punctuation">,</span>L<span class="token punctuation">,</span>S<span class="token punctuation">,</span>V<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
   	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>说明<ol>
<li>宏名一般用大写，以便于与变量区别</li>
<li>字符串可以是常数、表达式等</li>
<li>宏定义不作语法检查，只有在编译被宏展开后的源程序才会报错</li>
<li>宏定义不是C语言，不在行末加分号</li>
<li>宏名有效范围为从定义到本源文件结束</li>
<li>可以用#undef命令终止宏定义的作用域</li>
<li>在宏定义中，可以引用已定义的宏名</li>
</ol>
</li>
</ul>
<ol start="3">
<li>带参数的宏定义<ol>
<li>格式：#define 宏名(形参表) 字符串</li>
<li>调用：宏名(形参表)</li>
<li>宏展开：进行宏替换</li>
</ol>
</li>
</ol>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">include <span class="token operator">&lt;</span>stdio<span class="token punctuation">.</span>h<span class="token operator">></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">SQ_1</span><span class="token expression"><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">SQ_2</span><span class="token expression"><span class="token punctuation">(</span>y<span class="token punctuation">)</span>  y<span class="token operator">*</span>y</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>num_1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>num_2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
	num_1 <span class="token operator">=</span> <span class="token function">SQ_1</span><span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//num_1 = (a+1)*(a+1); </span>
	num_2 <span class="token operator">=</span> <span class="token function">SQ_2</span><span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//num_2 = a+1*a+1; </span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"num_1 = %d\n"</span><span class="token punctuation">,</span>num_1<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"num_2 = %d\n"</span><span class="token punctuation">,</span>num_2<span class="token punctuation">)</span><span class="token punctuation">;</span>
	
   	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>	<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="条件编译"><a href="#条件编译" class="headerlink" title="条件编译"></a>条件编译</h4><ol>
<li><p>基本概念</p>
<ul>
<li>一般情况下，源程序中所有的行都参加编译。但有时希望对部分源程序行只在满足一定条件时才编译，即对这部分源程序行指定编译条件。</li>
<li><img src="http://qiniu.orangew.cn/img/wpsB7C8.tmp.jpg" alt="img"></li>
</ul>
</li>
<li><p>条件编译的作用</p>
<ol>
<li><p>防止头文件被重复包含引用</p>
<blockquote>
<p>#ifndef _SOMEFILE_H</p>
<p>#define _SOMEFILE_H</p>
<p> //需要声明的变量、函数</p>
<p>​    //宏定义</p>
<p>​    //结构体</p>
<p>#endif</p>
</blockquote>
</li>
<li><p> 软件裁剪（同样的C源代码，条件选项不同可以编译出不同的可执行程序。）</p>
</li>
</ol>
<blockquote>
<p>#include &lt;stdio.h&gt;</p>
<p>#include &lt;stdlib.h&gt;</p>
<p>#define BIG 1</p>
<p>int main(void)</p>
<p>{</p>
<p>​    char str[20] = “C Language”;</p>
<p>​    char C;</p>
<p>​    int i = 0;</p>
<p>​    while ((C = str[i++]) != ‘\0’)</p>
<p>​    {</p>
<p>#if BIG</p>
<p>​        if (C &gt;= ‘a’ &amp;&amp; C &lt;= ‘z’)</p>
<p>​            C = C - 32;</p>
<p>#else</p>
<p>​        if (C &gt;= ‘A’&amp;&amp; C &lt;= ‘Z’)</p>
<p>​            C = C + 32;</p>
<p>#endif</p>
<p>​        printf(“%c”, C);</p>
<p>​    }</p>
<p>​    system(“pause”);</p>
<p>​    return 0;</p>
<p>}</p>
</blockquote>
</li>
</ol>
<h4 id="一些特殊的预定宏"><a href="#一些特殊的预定宏" class="headerlink" title="一些特殊的预定宏"></a>一些特殊的预定宏</h4><ul>
<li>C编译器，提供了几个特殊形式的预定义宏，在实际编程中可以直接使用，很方便。</li>
</ul>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">//	__FILE__			宏所在文件的源文件名 </span>
<span class="token comment">//	__LINE__			宏所在行的行号</span>
<span class="token comment">//	__DATE__			代码编译的日期</span>
<span class="token comment">//	__TIME__			代码编译的时间</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>

	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> <span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%d\n"</span><span class="token punctuation">,</span> <span class="token constant">__LINE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> <span class="token constant">__DATE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s\n"</span><span class="token punctuation">,</span> <span class="token constant">__TIME__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="动态库"><a href="#动态库" class="headerlink" title="动态库"></a>动态库</h3><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token comment">/*
   下面定义了一套socket客户端发送报文接受报文的api接口
   请写出这套接口api的调用方法
 */</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">_INC_Demo01_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">_INC_Demo01_H</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span>  <span class="token expression">__cplusplus</span></span>
<span class="token keyword">extern</span> <span class="token string">"C"</span> <span class="token punctuation">&#123;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

    <span class="token comment">//------------------第一套api接口---Begin--------------------------------//</span>
    <span class="token comment">//客户端初始化 获取handle上下</span>
    <span class="token keyword">int</span> <span class="token function">cltSocketInit</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span><span class="token operator">*</span>handle <span class="token comment">/*out*/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//客户端发报文</span>
    <span class="token keyword">int</span> <span class="token function">cltSocketSend</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>handle <span class="token comment">/*in*/</span><span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>buf <span class="token comment">/*in*/</span><span class="token punctuation">,</span>  <span class="token keyword">int</span> buflen <span class="token comment">/*in*/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//客户端收报文</span>
    <span class="token keyword">int</span> <span class="token function">cltSocketRev</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>handle <span class="token comment">/*in*/</span><span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>buf <span class="token comment">/*in*/</span><span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>buflen <span class="token comment">/*in out*/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//客户端释放资源</span>
    <span class="token keyword">int</span> <span class="token function">cltSocketDestory</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>handle<span class="token comment">/*in*/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//------------------第一套api接口---End-----------------------------------//</span>


<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span>  <span class="token expression">__cplusplus</span></span>
<span class="token punctuation">&#125;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>windows动态库生成的文件有</li>
</ul>
<blockquote>
<p><code>socketClient.lib</code></p>
<p><code>socketClient.dll</code></p>
</blockquote>
<ul>
<li>windows 动态库是dll文件和lib文件组合。</li>
<li><code>xxx.lib</code>：编译代码时，需要链接此文件</li>
<li><code>xxx.dll</code>：运行程序时，需要链接此文件</li>
<li>当发现windows动态库没有lib文件生成时候，需要在动态库中每个函数头部添加头衔。</li>
<li><code>__declspec(dllexport)</code></li>
</ul>
<h3 id="附录A：Win32环境下动态链接库-DLL-编程原理"><a href="#附录A：Win32环境下动态链接库-DLL-编程原理" class="headerlink" title="附录A：Win32环境下动态链接库(DLL)编程原理"></a>附录A：Win32环境下动态链接库(DLL)编程原理</h3><p>​        比较大的应用程序都由很多模块组成，这些模块分别完成相对独立的功能，它们彼此协作来完成整个软件系统的工作。其中可能存在一些模块的功能较为通用，在构造其它软件系统时仍会被使用。在构造软件系统时，如果将所有模块的源代码都静态编译到整个应用程序EXE文件中，会产生一些问题：一个缺点是增加了应用程序的大小，它会占用更多的磁盘空间，程序运行时也会消耗较大的内存空间，造成系统资源的浪费；另一个缺点是，在编写大的EXE程序时，在每次修改重建时都必须调整编译所有源代码，增加了编译过程的复杂性，也不利于阶段性的单元测试。 </p>
<p>　　Windows系统平台上提供了一种完全不同的较有效的编程和运行环境，你可以将独立的程序模块创建为较小的DLL(Dynamic Linkable Library)文件，并可对它们单独编译和测试。在运行时，只有当EXE程序确实要调用这些DLL模块的情况下，系统才会将它们装载到内存空间中。这种 方式不仅减少了EXE文件的大小和对内存空间的需求，而且使这些DLL模块可以同时被多个应用程序使用。Microsoft Windows自己就将一些主要的系统功能以DLL模块的形式实现。例如IE中的一些基本功能就是由DLL文件实现的，它可以被其它应用程序调用和集成。</p>
<p>　 　一般来说，DLL是一种磁盘文件（通常带有DLL扩展名），它由全局数据、服务函数和资源组成，在运行时被系统加载到进程的虚拟空间中，成为调用进程的 一部分。如果与其它DLL之间没有冲突，该文件通常映射到进程虚拟空间的同一地址上。DLL模块中包含各种导出函数，用于向外界提供服务。Windows 在加载DLL模块时将进程函数调用与DLL文件的导出函数相匹配。</p>
<p>　　在Win32环境中，每个进程都复制了自己的读/写全局变量。如果想要与其它进程共享内存，必须使用内存映射文件或者声明一个共享数据段。DLL模块需要的堆栈内存都是从运行进程的堆栈中分配出来的。</p>
<p>　　DLL现在越来越容易编写。Win32已经大大简化了其编程模式，并有许多来自AppWizard和MFC类库的支持。</p>
<p>　　一、导出和导入函数的匹配</p>
<p>　 　DLL文件中包含一个导出函数表。这些导出函数由它们的符号名和称为标识号的整数与外界联系起来。函数表中还包含了DLL中函数的地址。当应用程序加载 DLL模块时时，它并不知道调用函数的实际地址，但它知道函数的符号名和标识号。动态链接过程在加载的DLL模块时动态建立一个函数调用与函数地址的对应 表。如果重新编译和重建DLL文件，并不需要修改应用程序，除非你改变了导出函数的符号名和参数序列。</p>
<p>　　简单的DLL文件只为应用程序提供导出函数，比较复杂的DLL文件除了提供导出函数以外，还调用其它DLL文件中的函数。这样，一个特殊的DLL可以既有导入函数，又有导入函数。这并不是一个问题，因为动态链接过程可以处理交叉相关的情况。</p>
<p>　　在DLL代码中，必须像下面这样明确声明导出函数：</p>
<p><code>__declspec(dllexport) int MyFunction(int n);</code></p>
<p>　　但也可以在模块定义(DEF)文件中列出导出函数，不过这样做常常引起更多的麻烦。在应用程序方面，要求像下面这样明确声明相应的输入函数：</p>
<p><code>__declspec(dllimport) int MyFuncition(int n);</code></p>
<p>　　仅有导入和导出声明并不能使应用程序内部的函数调用链接到相应的DLL文件上。应用程序的项目必须为链接程序指定所需的输入库（LIB文件）。而且应用程序事实上必须至少包含一个对DLL函数的调用。</p>
<p>　　二、与DLL模块建立链接</p>
<p>　　应用程序导入函数与DLL文件中的导出函数进行链接有两种方式：隐式链接和显式链接。所谓的隐式链接是指在应用程序中不需指明DLL文件的实际存储路径，程序员不需关心DLL文件的实际装载。而显式链接与此相反。</p>
<p>　 　采用隐式链接方式，程序员在建立一个DLL文件时，链接程序会自动生成一个与之对应的LIB导入文件。该文件包含了每一个DLL导出函数的符号名和可选 的标识号，但是并不含有实际的代码。LIB文件作为DLL的替代文件被编译到应用程序项目中。当程序员通过静态链接方式编译生成应用程序时，应用程序中的 调用函数与LIB文件中导出符号相匹配，这些符号或标识号进入到生成的EXE文件中。LIB文件中也包含了对应的DLL文件名（但不是完全的路径名），链接程序将其存储在EXE文件内部。当应用程序运行过程中需要加载DLL文件时，Windows根据这些信息发现并加载DLL，然后通过符号名或标识号实现 对DLL函数的动态链接。</p>
<p>　　显式链接方式对于集成化的开发语言（例如VB）比较适合。有了显式链接，程序员就不必再使用导入文件，而是直接调用Win32 的LoadLibary函数，并指定DLL的路径作为参数。LoadLibary返回HINSTANCE参数，应用程序在调用 GetProcAddress函数时使用这一参数。GetProcAddress函数将符号名或标识号转换为DLL内部的地址。假设有一个导出如下函数的 DLL文件：</p>
<p><code>extern &quot;C&quot; __declspec(dllexport) double SquareRoot(double d);</code></p>
<p>下面是应用程序对该导出函数的显式链接的例子：</p>
<p>下面是应用程序对该导出函数的显式链接的例子：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">double</span><span class="token punctuation">(</span>SQRTPROC<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
HINSTANCE hInstance<span class="token punctuation">;</span>
SQRTPROC<span class="token operator">*</span> pFunction<span class="token punctuation">;</span>

<span class="token function">VERIFY</span><span class="token punctuation">(</span>hInstance<span class="token operator">=</span><span class="token operator">::</span><span class="token function">LoadLibrary</span><span class="token punctuation">(</span><span class="token string">"c:\\winnt\\system32\\mydll.dll"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">VERIFY</span><span class="token punctuation">(</span>pFunction<span class="token operator">=</span><span class="token punctuation">(</span>SQRTPROC<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">::</span><span class="token function">GetProcAddress</span><span class="token punctuation">(</span>hInstance<span class="token punctuation">,</span><span class="token string">"SquareRoot"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">double</span> d<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">*</span>pFunction<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">81.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用该DLL函数</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>　 　在隐式链接方式中，所有被应用程序调用的DLL文件都会在应用程序EXE文件加载时被加载在到内存中；但如果采用显式链接方式，程序员可以决定DLL文 件何时加载或不加载。显式链接在运行时决定加载哪个DLL文件。例如，可以将一个带有字符串资源的DLL模块以英语加载，而另一个以西班牙语加载。应用程 序在用户选择了合适的语种后再加载与之对应的DLL文件。</p>
<p>　　三、使用符号名链接与标识号链接</p>
<p>　 　在Win16环境中，符号名链接效率较低，所有那时标识号链接是主要的链接方式。在Win32环境中，符号名链接的效率得到了改善。Microsoft 现在推荐使用符号名链接。但在MFC库中的DLL版本仍然采用的是标识号链接。一个典型的MFC程序可能会链接到数百个MFC DLL函数上。采用标识号链接的应用程序的EXE文件体相对较小，因为它不必包含导入函数的长字符串符号名。</p>
<p>​         四、编写DllMain函数</p>
<p>　　DllMain函数是DLL模块的默认入口点。当Windows加载 DLL模块时调用这一函数。系统首先调用全局对象的构造函数，然后调用全局函数DLLMain。DLLMain函数不仅在将DLL链接加载到进程时被调 用，在DLL模块与进程分离时（以及其它时候）也被调用。下面是一个框架DLLMain函数的例子。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">HINSTANCE g_hInstance<span class="token punctuation">;</span>

<span class="token keyword">extern</span> <span class="token string">"C"</span> 
<span class="token keyword">int</span> APIENTRY <span class="token function">DllMain</span><span class="token punctuation">(</span>HINSTANCE hInstance<span class="token punctuation">,</span>DWORD dwReason<span class="token punctuation">,</span>LPVOID lpReserved<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>dwReason<span class="token operator">==</span>DLL_PROCESS_ATTACH<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">TRACE0</span><span class="token punctuation">(</span><span class="token string">"EX22A.DLL Initializing!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//在这里进行初始化</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>dwReason<span class="token operator">=</span>DLL_PROCESS_DETACH<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">TRACE0</span><span class="token punctuation">(</span><span class="token string">"EX22A.DLL Terminating!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//在这里进行清除工作</span>
    <span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">//成功</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<p>　　如果程序员没有为DLL模块编写一个DLLMain函数，系统会从其它运行库中引入一个不做任何操作的缺省DLLMain函数版本。在单个线程启动和终止时，DLLMain函数也被调用。正如由dwReason参数所表明的那样。</p>
<p>　　五、模块句柄</p>
<p>　 　进程中的每个DLL模块被全局唯一的32字节的HINSTANCE句柄标识。进程自己还有一个HINSTANCE句柄。所有这些模块句柄都只有在特定的 进程内部有效，它们代表了DLL或EXE模块在进程虚拟空间中的起始地址。在Win32中，HINSTANCE和HMODULE的值是相同的，这个两种类 型可以替换使用。进程模块句柄几乎总是等于0x400000，而DLL模块的加载地址的缺省句柄是0x10000000。如果程序同时使用了几个DLL模 块，每一个都会有不同的HINSTANCE值。这是因为在创建DLL文件时指定了不同的基地址，或者是因为加载程序对DLL代码进行了重定位。<br>模块句柄对于加载资源特别重要。Win32 的FindResource函数中带有一个HINSTANCE参数。EXE和DLL都有其自己的资源。如果应用程序需要来自于DLL的资源，就将此参数指定为DLL的模块句柄。如果需要EXE文件中包含的资源，就指定EXE的模块句柄。</p>
<p>　　但是在使用这些句柄之前存在一个问题，你怎样得到它们呢？如果需要得到EXE模块句柄，调用带有Null参数的Win32函数GetModuleHandle；如果需要DLL模块句柄，就调用以DLL文件名为参数的Win32函数GetModuleHandle。</p>
<p>　　六、应用程序怎样找到DLL文件</p>
<p>　　如果应用程序使用LoadLibrary显式链接，那么在这个函数的参数中可以指定DLL文件的完整路径。如果不指定路径，或是进行隐式链接，Windows将遵循下面的搜索顺序来定位DLL：</p>
<p>　　1． 包含EXE文件的目录，<br>　　2． 进程的当前工作目录，<br>　　3． Windows系统目录，<br>　　4． Windows目录，<br>　　5． 列在Path环境变量中的一系列目录。</p>
<p>　 　这里有一个很容易发生错误的陷阱。如果你使用VC＋＋进行项目开发，并且为DLL模块专门创建了一个项目，然后将生成的DLL文件拷贝到系统目录下，从 应用程序中调用DLL模块。到目前为止，一切正常。接下来对DLL模块做了一些修改后重新生成了新的DLL文件，但你忘记将新的DLL文件拷贝到系统目录 下。下一次当你运行应用程序时，它仍加载了老版本的DLL文件，这可要当心！</p>
<p>　　七、调试DLL程序</p>
<p>　　Microsoft 的VC＋＋是开发和测试DLL 的有效工具，只需从DLL项目中运行调试程序即可。当你第一次这样操作时，调试程序会向你询问EXE文件的路径。此后每次在调试程序中运行DLL时，调试 程序会自动加载该EXE文件。然后该EXE文件用上面的搜索序列发现DLL文件，这意味着你必须设置Path环境变量让其包含DLL文件的磁盘路径，或者 也可以将DLL文件拷贝到搜索序列中的目录路径下。</p>
<p>​         八、DLL分配的内存需要用dll提供的API释放</p>

    </div>

    
    
    

      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/c/" rel="tag"><i class="fa fa-tag"></i> c++</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/07/01/C%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="prev" title="Build Your Own Text Editor">
      <i class="fa fa-chevron-left"></i> Build Your Own Text Editor
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/07/03/C-%E5%9F%BA%E7%A1%80/" rel="next" title="C++基础">
      C++基础 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#C%E8%AF%AD%E8%A8%80%E6%8F%90%E9%AB%98"><span class="nav-number">1.</span> <span class="nav-text">C语言提高</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E5%9B%9B%E5%8C%BA"><span class="nav-number">1.2.</span> <span class="nav-text">内存四区</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E6%9C%AC%E8%B4%A8%E5%88%86%E6%9E%90"><span class="nav-number">1.2.1.</span> <span class="nav-text">数据类型本质分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E6%A6%82%E5%BF%B5"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">数据类型概念</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%9C%AC%E8%B4%A8"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">数据类型的本质</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%A4%A7%E5%B0%8F"><span class="nav-number">1.2.1.3.</span> <span class="nav-text">数据类型的大小</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%88%AB%E5%90%8D"><span class="nav-number">1.2.1.4.</span> <span class="nav-text">数据类型的别名</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%B0%81%E8%A3%85"><span class="nav-number">1.2.1.5.</span> <span class="nav-text">数据类型的封装</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%80%BB%E7%BB%93%E4%B8%8E%E6%8B%93%E5%B1%95"><span class="nav-number">1.2.1.6.</span> <span class="nav-text">数类型的总结与拓展</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E6%9C%AC%E8%B4%A8%E5%88%86%E6%9E%90"><span class="nav-number">1.2.2.</span> <span class="nav-text">变量的本质分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">变量的概念</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E6%9C%AC%E8%B4%A8"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">变量的本质</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%86%85%E5%AD%98%E5%9B%9B%E5%8C%BA%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.2.3.</span> <span class="nav-text">程序的内存四区模型</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A0%88%E5%8C%BA%E5%92%8C%E5%A0%86%E5%8C%BA"><span class="nav-number">1.2.3.1.</span> <span class="nav-text">栈区和堆区</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E5%8C%BA"><span class="nav-number">1.2.3.2.</span> <span class="nav-text">全局区</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E7%9A%84%E8%B0%83%E7%94%A8%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.2.3.3.</span> <span class="nav-text">函数的调用模型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E5%8F%98%E9%87%8F%E4%BC%A0%E9%80%92%E5%88%86%E6%9E%90"><span class="nav-number">1.2.3.4.</span> <span class="nav-text">函数调用变量传递分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A0%88%E7%9A%84%E7%94%9F%E9%95%BF%E6%96%B9%E5%90%91%E5%92%8C%E5%86%85%E5%AD%98%E5%AD%98%E6%94%BE%E6%96%B9%E5%90%91"><span class="nav-number">1.2.3.5.</span> <span class="nav-text">栈的生长方向和内存存放方向</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%87%E9%92%88"><span class="nav-number">1.3.</span> <span class="nav-text">指针</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%87%E9%92%88%E5%BC%BA%E5%8C%96"><span class="nav-number">1.3.1.</span> <span class="nav-text">指针强化</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8C%87%E9%92%88%E6%98%AF%E4%B8%80%E7%A7%8D%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">指针是一种数据类型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%AE%80%E6%8E%A5%E8%B5%8B%E5%80%BC-p-%E6%98%AF%E6%8C%87%E9%92%88%E5%AD%98%E5%9C%A8%E7%9A%84%E6%9C%80%E5%A4%A7%E6%84%8F%E4%B9%89"><span class="nav-number">1.3.1.2.</span> <span class="nav-text">简接赋值(* p)是指针存在的最大意义</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%90%86%E8%A7%A3%E6%8C%87%E9%92%88%E5%BF%85%E9%A1%BB%E5%92%8C%E5%86%85%E5%AD%98%E5%9B%9B%E5%8C%BA%E6%A6%82%E5%BF%B5%E7%BB%93%E5%90%88"><span class="nav-number">1.3.1.3.</span> <span class="nav-text">理解指针必须和内存四区概念结合</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E6%8C%87%E9%92%88%E5%BF%85%E9%A1%BB%E5%92%8C%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E7%9B%B8%E7%BB%93%E5%90%88%EF%BC%88%E6%8C%87%E9%92%88%E5%81%9A%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%EF%BC%89"><span class="nav-number">1.3.1.4.</span> <span class="nav-text">应用指针必须和函数调用相结合（指针做函数参数）</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%8F%E5%85%B8%E8%AF%AD%E5%BD%95"><span class="nav-number">1.3.2.</span> <span class="nav-text">经典语录</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">1.4.</span> <span class="nav-text">字符串</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="nav-number">1.4.1.</span> <span class="nav-text">字符串的基本操作</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%95%B0%E7%BB%84%E5%88%9D%E5%A7%8B%E5%8C%96%E6%96%B9%E6%B3%95"><span class="nav-number">1.4.1.1.</span> <span class="nav-text">字符串数组初始化方法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E6%B3%95%E5%92%8C%E6%8C%87%E9%92%88%E6%B3%95%E6%93%8D%E4%BD%9C%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">1.4.1.2.</span> <span class="nav-text">数组法和指针法操作字符串</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%81%9A%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0"><span class="nav-number">1.4.2.</span> <span class="nav-text">字符串做函数参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E5%B8%B8%E7%94%A8%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%BA%94%E7%94%A8%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.4.3.</span> <span class="nav-text">项目开发常用字符串应用模型</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#strstr%E4%B8%AD%E7%9A%84while%E5%92%8Cdo-while%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.4.3.1.</span> <span class="nav-text">strstr中的while和do-while模型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%A4%E5%A4%B4%E5%A0%B5%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.4.3.2.</span> <span class="nav-text">两头堵模型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8F%8D%E8%BD%AC%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.4.3.3.</span> <span class="nav-text">字符串反转模型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%80%92%E5%BD%92%E6%80%9D%E6%83%B3"><span class="nav-number">1.4.3.4.</span> <span class="nav-text">递归思想</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E7%BA%A7%E6%8C%87%E9%92%88-char-%E6%98%93%E9%94%99%E5%9C%B0%E6%96%B9"><span class="nav-number">1.4.4.</span> <span class="nav-text">一级指针(char*)易错地方</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AF%B9%E7%A9%BA%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%92%8C%E9%9D%9E%E6%B3%95%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%88%A4%E6%96%AD"><span class="nav-number">1.4.4.1.</span> <span class="nav-text">对空字符串和非法字符串的判断</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%B6%8A%E7%95%8C"><span class="nav-number">1.4.4.2.</span> <span class="nav-text">越界</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8C%87%E9%92%88%E7%9A%84%E5%8F%A0%E5%8A%A0%E4%BC%9A%E4%B8%8D%E6%96%AD%E6%94%B9%E5%8F%98%E6%8C%87%E9%92%88%E7%9A%84%E6%96%B9%E5%90%91"><span class="nav-number">1.4.4.3.</span> <span class="nav-text">指针的叠加会不断改变指针的方向</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E4%B8%8D%E8%A6%81%E5%A4%96%E4%BC%A0"><span class="nav-number">1.4.4.4.</span> <span class="nav-text">局部变量不要外传</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E5%86%85%E4%BD%BF%E7%94%A8%E8%BE%85%E5%8A%A9%E5%8F%98%E9%87%8F%E7%9A%84%E9%87%8D%E8%A6%81%E6%80%A7"><span class="nav-number">1.4.4.5.</span> <span class="nav-text">函数内使用辅助变量的重要性</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#const"><span class="nav-number">1.4.5.</span> <span class="nav-text">const</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#const%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="nav-number">1.4.5.1.</span> <span class="nav-text">const知识点</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%BA%E5%8C%96%E7%BB%83%E4%B9%A0"><span class="nav-number">1.4.6.</span> <span class="nav-text">强化练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E7%BA%A7%E6%8C%87%E9%92%88"><span class="nav-number">1.5.</span> <span class="nav-text">二级指针</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E7%BA%A7%E6%8C%87%E9%92%88%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-number">1.5.1.</span> <span class="nav-text">二级指针基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BA%8C%E7%BA%A7%E6%8C%87%E9%92%88%E8%BE%93%E5%87%BA%E7%89%B9%E6%80%A7"><span class="nav-number">1.5.1.1.</span> <span class="nav-text">二级指针输出特性</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BA%8C%E7%BA%A7%E6%8C%87%E9%92%88%E8%BE%93%E5%85%A5%E7%89%B9%E6%80%A7"><span class="nav-number">1.5.1.2.</span> <span class="nav-text">二级指针输入特性</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E7%BA%A7%E6%8C%87%E9%92%88"><span class="nav-number">1.5.2.</span> <span class="nav-text">多级指针</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%9C%E4%B8%9A"><span class="nav-number">1.5.2.1.</span> <span class="nav-text">作业</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E7%BB%B4%E6%95%B0%E7%BB%84"><span class="nav-number">1.6.</span> <span class="nav-text">多维数组</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-number">1.6.1.</span> <span class="nav-text">数组的基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A6%82%E5%BF%B5"><span class="nav-number">1.6.1.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84"><span class="nav-number">1.6.1.2.</span> <span class="nav-text">二维数组</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E5%90%8D"><span class="nav-number">1.6.1.3.</span> <span class="nav-text">数组名</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.6.2.</span> <span class="nav-text">数组类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E6%8C%87%E9%92%88%E5%92%8C%E6%8C%87%E9%92%88%E6%95%B0%E7%BB%84"><span class="nav-number">1.6.3.</span> <span class="nav-text">数组指针和指针数组</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8C%87%E9%92%88%E6%95%B0%E7%BB%84"><span class="nav-number">1.6.3.1.</span> <span class="nav-text">指针数组</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E6%8C%87%E9%92%88"><span class="nav-number">1.6.3.2.</span> <span class="nav-text">数组指针</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E6%95%B0%E7%BB%84%E6%8C%87%E9%92%88"><span class="nav-number">1.6.3.3.</span> <span class="nav-text">定义数组指针</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E7%BB%B4%E6%95%B0%E7%BB%84%E5%90%8D%E7%9A%84%E6%9C%AC%E8%B4%A8"><span class="nav-number">1.6.4.</span> <span class="nav-text">多维数组名的本质</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E7%BB%B4%E6%95%B0%E7%BB%84%E7%9A%84%E5%8F%82%E6%95%B0%E9%80%80%E5%8C%96"><span class="nav-number">1.7.</span> <span class="nav-text">多维数组的参数退化</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E7%BB%B4%E6%95%B0%E7%BB%84%E7%9A%84%E7%BA%BF%E6%80%A7%E5%AD%98%E5%82%A8%E7%89%B9%E6%80%A7"><span class="nav-number">1.7.1.</span> <span class="nav-text">多维数组的线性存储特性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E7%BB%B4%E6%95%B0%E7%BB%84%E7%9A%843%E7%A7%8D%E5%BD%A2%E5%BC%8F%E5%8F%82%E6%95%B0"><span class="nav-number">1.7.2.</span> <span class="nav-text">多维数组的3种形式参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BD%A2%E5%8F%82%E9%80%80%E5%8C%96%E6%88%90%E6%8C%87%E9%92%88%E7%9A%84%E5%8E%9F%E5%9B%A0"><span class="nav-number">1.7.3.</span> <span class="nav-text">形参退化成指针的原因</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-number">1.8.</span> <span class="nav-text">结构体</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%AE%9A%E4%B9%89"><span class="nav-number">1.8.1.</span> <span class="nav-text">结构体的类型和定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E7%9A%84%E8%B5%8B%E5%80%BC"><span class="nav-number">1.8.2.</span> <span class="nav-text">结构体的赋值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E6%95%B0%E7%BB%84"><span class="nav-number">1.8.3.</span> <span class="nav-text">结构体数组</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E4%BD%9C%E4%B8%BA%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0"><span class="nav-number">1.8.4.</span> <span class="nav-text">结构体作为函数参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E5%B5%8C%E5%A5%97%E6%8C%87%E9%92%88"><span class="nav-number">1.8.5.</span> <span class="nav-text">结构体嵌套指针</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%89%E5%85%B3%E6%B5%85%E6%8B%B7%E8%B4%9D%E6%B7%B1%E6%8B%B7%E8%B4%9D%E9%97%AE%E9%A2%98"><span class="nav-number">1.8.6.</span> <span class="nav-text">有关浅拷贝深拷贝问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E6%88%90%E5%91%98%E5%81%8F%E7%A7%BB%E9%87%8F"><span class="nav-number">1.8.7.</span> <span class="nav-text">结构体成员偏移量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%E5%AD%97%E8%8A%82%E5%AF%B9%E9%BD%90"><span class="nav-number">1.8.8.</span> <span class="nav-text">结构体字节对齐</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90%E7%9A%84%E5%8E%9F%E5%9B%A0"><span class="nav-number">1.8.8.1.</span> <span class="nav-text">内存对齐的原因</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90%E7%9A%84%E5%8E%9F%E5%88%99"><span class="nav-number">1.8.8.2.</span> <span class="nav-text">内存对齐的原则</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%9C%E4%B8%9A-1"><span class="nav-number">1.8.9.</span> <span class="nav-text">作业</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="nav-number">1.9.</span> <span class="nav-text">文件操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E7%9A%84%E6%AD%A5%E9%AA%A4"><span class="nav-number">1.9.1.</span> <span class="nav-text">文件操作的步骤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%89%E5%85%B3%E6%96%87%E4%BB%B6%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="nav-number">1.9.2.</span> <span class="nav-text">有关文件的概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#C%E8%AF%AD%E8%A8%80%E6%96%87%E4%BB%B6%E6%8C%87%E9%92%88"><span class="nav-number">1.9.3.</span> <span class="nav-text">C语言文件指针</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9CAPI"><span class="nav-number">1.9.4.</span> <span class="nav-text">文件操作API</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%87%E5%87%86%E7%9A%84%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99"><span class="nav-number">1.9.5.</span> <span class="nav-text">标准的文件读写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E6%A1%88%E4%BE%8B"><span class="nav-number">1.9.6.</span> <span class="nav-text">文件操作案例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%93%BE%E8%A1%A8%E5%92%8C%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88"><span class="nav-number">1.10.</span> <span class="nav-text">链表和函数指针</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%93%BE%E8%A1%A8%E7%9A%84%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5"><span class="nav-number">1.10.1.</span> <span class="nav-text">链表的相关概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E7%B1%BB"><span class="nav-number">1.10.2.</span> <span class="nav-text">分类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="nav-number">1.10.3.</span> <span class="nav-text">基本操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%87%E9%92%88%E5%87%BD%E6%95%B0%E5%92%8C%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88"><span class="nav-number">1.10.4.</span> <span class="nav-text">指针函数和函数指针</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%84%E5%A4%84%E7%90%86"><span class="nav-number">1.11.</span> <span class="nav-text">预处理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%84%E5%A4%84%E7%90%86-1"><span class="nav-number">1.11.1.</span> <span class="nav-text">预处理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E5%A4%84%E7%90%86"><span class="nav-number">1.11.2.</span> <span class="nav-text">文件包含处理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%8F%E5%AE%9A%E4%B9%89"><span class="nav-number">1.11.3.</span> <span class="nav-text">宏定义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E7%BC%96%E8%AF%91"><span class="nav-number">1.11.4.</span> <span class="nav-text">条件编译</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E7%89%B9%E6%AE%8A%E7%9A%84%E9%A2%84%E5%AE%9A%E5%AE%8F"><span class="nav-number">1.11.5.</span> <span class="nav-text">一些特殊的预定宏</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E5%BA%93"><span class="nav-number">1.12.</span> <span class="nav-text">动态库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%99%84%E5%BD%95A%EF%BC%9AWin32%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93-DLL-%E7%BC%96%E7%A8%8B%E5%8E%9F%E7%90%86"><span class="nav-number">1.13.</span> <span class="nav-text">附录A：Win32环境下动态链接库(DLL)编程原理</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="OrangeW"
      src="/images/orange.png">
  <p class="site-author-name" itemprop="name">OrangeW</p>
  <div class="site-description" itemprop="description">demo_study record</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">10</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>


<!-- CloudCalendar -->
<div class="widget-wrap" style="width: 90%;margin-left: auto;margin-right: auto; opacity: 0.97;">
	<div class="widget" id="CloudCalendar"></div>
</div>
      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">OrangeW</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">537k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">16:17</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script size="300" alpha="0.6" zIndex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  




  
<script src="/js/local-search.js"></script>











<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  
<!-- calendar widget -->

    <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-calendar/calendar.min.js"></script>
    <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-calendar/languages.min.js"></script>
    <script>
    $(function() {
        $('#CloudCalendar').aCalendar('zh-CN',
            $.extend(
                '', {
                    single:true,
                    root:'/calendar/'
                }
            )
        );
    });
    </script>


</body>
</html>
